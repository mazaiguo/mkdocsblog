---
title: 江河批量转换测试江河批量转换测试
date: 2023-12-08
categories:
  - windows程序
tags:
  - Python
  - DWG文件

description: Python脚本实现DWG文件的批量转换处理，包含时间统计和进度显示
author: JerryMa
---
# 江河批量装换测试江河批量装换测试

## 具体代码

```python
import time
import os
from datetime import datetime

# 获取同一目录下的所有PDF文件的绝对路径
def getFileName(filedir):
    file_list = [os.path.join(root, filespath) \
                 for root, dirs, files in os.walk(filedir) \
                 for filespath in files \
                 if str(filespath).endswith('dwg')
                 ]
    return file_list if file_list else []

if __name__ == '__main__':
    path = input("\n请输入文件夹：")
    if path == "":
        path = "."
    if path[-1] != "/":
        path += "/"
    print("文件夹路径为：%s" % (path))
    startime = time.time()
    start_date = datetime.now()
    print("程序开始运行")
    print("程序开始时间：%s" % (start_date))
    dwg_fileName = getFileName(path)
    for dwg_file in dwg_fileName:
        print(dwg_file)
        os.system("E:\\Gitee\\project\\ZwWhForJhPdf\\Setup-x64\\ZwmStartUp.exe " + dwg_file)
    print("程序结束运行")
    endtime = time.time()
    end_date = datetime.now()
    print("程序结束时间：%s" % (end_date))
    print("文件总数为:", len(dwg_fileName))
    print("总耗时：", endtime - startime, "秒")
```

![](https://gitlab.com/zw2d/blogimg/-/raw/main/pictures/2023/12/8_14_17_42_20231208-20231208141741.png)