<!DOCTYPE html><html lang="zh" class="no-js"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="log日志功能，与cad无缝衔接，支持多线程"><meta name="author" content="JerryMa"><link rel="canonical" href="http://127.0.0.1:8000/blog/2025/10/29/cminesymbollogger-%E6%97%A5%E5%BF%97%E7%B3%BB%E7%BB%9F%E5%AE%8C%E6%95%B4%E6%96%87%E6%A1%A3.html"><link rel="prev" href="../28/typora%E4%BB%A3%E7%A0%81%E5%9D%97mac%E9%A3%8E%E6%A0%BC%E5%8C%96.html"><link rel="icon" href="../../../../assets/images/favicon.png"><meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22"><title>CMineSymbolLogger 日志系统完整文档 - 我的个人博客</title><link rel="stylesheet" href="../../../../assets/stylesheets/main.84d31ad4.min.css"><link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css"><script src="https://unpkg.com/iframe-worker/shim"></script><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel="stylesheet" href="../../../../stylesheets/extra.min.css"><link rel="stylesheet" href="https://unpkg.com/katex@0/dist/katex.min.css"><script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><link href="../../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"><script src="../../../../assets/javascripts/glightbox.min.js"></script><style id="glightbox-style">
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head> <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="Blue-Grey" data-md-color-accent="Pink"> <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off"> <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off"> <label class="md-overlay" for="__drawer"></label> <div data-md-component="skip"> <a href="#cminesymbollogger" class="md-skip"> 跳转至 </a> </div> <div data-md-component="announce"> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component="header"> <nav class="md-header__inner md-grid" aria-label="页眉"> <a href="../../../../index.html" title="我的个人博客" class="md-header__button md-logo" aria-label="我的个人博客" data-md-component="logo"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg> </a> <label class="md-header__button md-icon" for="__drawer"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg> </label> <div class="md-header__title" data-md-component="header-title"> <div class="md-header__ellipsis"> <div class="md-header__topic"> <span class="md-ellipsis"> 我的个人博客 </span> </div> <div class="md-header__topic" data-md-component="header-topic"> <span class="md-ellipsis"> CMineSymbolLogger 日志系统完整文档 </span> </div> </div> </div> <form class="md-header__option" data-md-component="palette"> <input class="md-option" data-md-color-media data-md-color-scheme="default" data-md-color-primary="Blue-Grey" data-md-color-accent="Pink" aria-label="切换到明亮模式" type="radio" name="__palette" id="__palette_0"> <label class="md-header__button md-icon" title="切换到明亮模式" for="__palette_1" hidden> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"></path></svg> </label> <input class="md-option" data-md-color-media data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="amber" aria-label="切换到暗黑模式" type="radio" name="__palette" id="__palette_1"> <label class="md-header__button md-icon" title="切换到暗黑模式" for="__palette_0" hidden> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"></path></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for="__search"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> </label> <div class="md-search" data-md-component="search" role="dialog"> <label class="md-search__overlay" for="__search"></label> <div class="md-search__inner" role="search"> <form class="md-search__form" name="search"> <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required> <label class="md-search__icon md-icon" for="__search"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> </label> <nav class="md-search__options" aria-label="查找"> <a href="javascript:void(0)" class="md-search__icon md-icon" title="分享" aria-label="分享" data-clipboard data-clipboard-text data-md-component="search-share" tabindex="-1"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"></path></svg> </a> <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg> </button> </nav> <div class="md-search__suggest" data-md-component="search-suggest"></div> </form> <div class="md-search__output"> <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix> <div class="md-search-result" data-md-component="search-result"> <div class="md-search-result__meta"> 正在初始化搜索引擎 </div> <ol class="md-search-result__list" role="presentation"></ol> </div> </div> </div> </div> </div> <div class="md-header__source"> <a href="https://github.com/mazaiguo/mkdocsblog" title="前往仓库" class="md-source" data-md-component="source"> <div class="md-source__icon md-icon"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class="md-source__repository"> mkdocsblog </div> </a> </div> </nav> <nav class="md-tabs" aria-label="标签" data-md-component="tabs"> <div class="md-grid"> <ul class="md-tabs__list"> <li class="md-tabs__item"> <a href="../../../../index.html" class="md-tabs__link"> 首页 </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href="../../../index.html" class="md-tabs__link"> 博客 </a> </li> <li class="md-tabs__item"> <a href="../../../../archive/index.html" class="md-tabs__link"> 归档 </a> </li> <li class="md-tabs__item"> <a href="../../../category.html" class="md-tabs__link"> 分类 </a> </li> <li class="md-tabs__item"> <a href="../../../../tags.html" class="md-tabs__link"> 标签 </a> </li> <li class="md-tabs__item"> <a href="../../../../about.html" class="md-tabs__link"> 关于 </a> </li> </ul> </div> </nav> </header> <div class="md-container" data-md-component="container"> <main class="md-main" data-md-component="main"> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" hidden> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="导航栏" data-md-level="0"> <label class="md-nav__title" for="__drawer"> <a href="../../../../index.html" title="我的个人博客" class="md-nav__button md-logo" aria-label="我的个人博客" data-md-component="logo"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg> </a> 我的个人博客 </label> <div class="md-nav__source"> <a href="https://github.com/mazaiguo/mkdocsblog" title="前往仓库" class="md-source" data-md-component="source"> <div class="md-source__icon md-icon"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class="md-source__repository"> mkdocsblog </div> </a> </div> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../../../index.html" class="md-nav__link"> <span class="md-ellipsis"> 首页 </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked> <div class="md-nav__link md-nav__container"> <a href="../../../index.html" class="md-nav__link "> <span class="md-ellipsis"> 博客 </span> </a> <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true"> <label class="md-nav__title" for="__nav_2"> <span class="md-nav__icon md-icon"></span> 博客 </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2"> <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex> <span class="md-ellipsis"> 归档 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_2_2"> <span class="md-nav__icon md-icon"></span> 归档 </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../../archive/2025.html" class="md-nav__link"> <span class="md-ellipsis"> 2025年10月 </span> </a> </li> <li class="md-nav__item"> <a href="../../../archive/2024.html" class="md-nav__link"> <span class="md-ellipsis"> 2024年11月 </span> </a> </li> <li class="md-nav__item"> <a href="../../../archive/2023.html" class="md-nav__link"> <span class="md-ellipsis"> 2023年12月 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3"> <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex> <span class="md-ellipsis"> 分类 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_2_3"> <span class="md-nav__icon md-icon"></span> 分类 </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../../category/logger.html" class="md-nav__link"> <span class="md-ellipsis"> Logger </span> </a> </li> <li class="md-nav__item"> <a href="../../../category/markdown.html" class="md-nav__link"> <span class="md-ellipsis"> MarkDown </span> </a> </li> <li class="md-nav__item"> <a href="../../../category/ppt.html" class="md-nav__link"> <span class="md-ellipsis"> PPT </span> </a> </li> <li class="md-nav__item"> <a href="../../../category/tools.html" class="md-nav__link"> <span class="md-ellipsis"> Tools </span> </a> </li> <li class="md-nav__item"> <a href="../../../category/unity.html" class="md-nav__link"> <span class="md-ellipsis"> Unity </span> </a> </li> <li class="md-nav__item"> <a href="../../../category/web%E9%83%A8%E7%BD%B2.html" class="md-nav__link"> <span class="md-ellipsis"> Web部署 </span> </a> </li> <li class="md-nav__item"> <a href="../../../category/web%E7%AB%AF%E7%A8%8B%E5%BA%8F.html" class="md-nav__link"> <span class="md-ellipsis"> web端程序 </span> </a> </li> <li class="md-nav__item"> <a href="../../../category/windows%E7%A8%8B%E5%BA%8F.html" class="md-nav__link"> <span class="md-ellipsis"> windows程序 </span> </a> </li> <li class="md-nav__item"> <a href="../../../category/%E4%B8%89%E6%96%B9%E5%BA%93.html" class="md-nav__link"> <span class="md-ellipsis"> 三方库 </span> </a> </li> <li class="md-nav__item"> <a href="../../../category/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91.html" class="md-nav__link"> <span class="md-ellipsis"> 前端开发 </span> </a> </li> <li class="md-nav__item"> <a href="../../../category/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7.html" class="md-nav__link"> <span class="md-ellipsis"> 开发工具 </span> </a> </li> <li class="md-nav__item"> <a href="../../../category/%E7%AE%97%E6%B3%95.html" class="md-nav__link"> <span class="md-ellipsis"> 算法 </span> </a> </li> <li class="md-nav__item"> <a href="../../../category/%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85.html" class="md-nav__link"> <span class="md-ellipsis"> 软件安装 </span> </a> </li> <li class="md-nav__item"> <a href="../../../category/%E9%A1%B9%E7%9B%AE%E6%96%B9%E6%A1%88.html" class="md-nav__link"> <span class="md-ellipsis"> 项目方案 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../../../archive/index.html" class="md-nav__link"> <span class="md-ellipsis"> 归档 </span> </a> </li> <li class="md-nav__item"> <a href="../../../category.html" class="md-nav__link"> <span class="md-ellipsis"> 分类 </span> </a> </li> <li class="md-nav__item"> <a href="../../../../tags.html" class="md-nav__link"> <span class="md-ellipsis"> 标签 </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href="../../../../about.html" class="md-nav__link"> <span class="md-ellipsis"> 关于 </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-content md-content--post" data-md-component="content"> <div class="md-sidebar md-sidebar--post" data-md-component="sidebar" data-md-type="navigation"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner md-post"> <nav class="md-nav md-nav--primary"> <div class="md-post__back"> <div class="md-nav__title md-nav__container"> <a href="../../../index.html" class="md-nav__link"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> <span class="md-ellipsis"> 回到主页 </span> </a> </div> </div> <ul class="md-post__meta md-nav__list"> <li class="md-nav__item md-nav__item--section"> <div class="md-post__title"> <span class="md-ellipsis"> 元数据 </span> </div> <nav class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <div class="md-nav__link"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5z"></path></svg> <time datetime="2025-10-29 00:00:00+00:00" class="md-ellipsis">2025年10月29日星期三</time> </div> </li> <li class="md-nav__item"> <div class="md-nav__link"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 3v15h3V3zm3 2 4 13 3-1-4-13zM5 5v13h3V5zM3 19v2h18v-2z"></path></svg> <span class="md-ellipsis"> 分类于 <a href="../../../category/logger.html">Logger</a>, <a href="../../../category/windows%E7%A8%8B%E5%BA%8F.html">windows程序</a></span> </div> </li> <li class="md-nav__item"> <div class="md-nav__link"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8m0-18a10 10 0 0 1 10 10 10 10 0 0 1-10 10C6.47 22 2 17.5 2 12A10 10 0 0 1 12 2m.5 5v5.25l4.5 2.67-.75 1.23L11 13V7z"></path></svg> <span class="md-ellipsis"> 需要 15 分钟阅读时间 </span> </div> </li> </ul> </nav> </li> </ul> </nav> <nav class="md-nav md-nav--secondary" aria-label="目录"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> 目录 </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix> <li class="md-nav__item"> <a href="#_1" class="md-nav__link"> <span class="md-ellipsis"> 目录 </span> </a> </li> <li class="md-nav__item"> <a href="#_2" class="md-nav__link"> <span class="md-ellipsis"> 快速开始 </span> </a> <nav class="md-nav" aria-label="快速开始"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#30" class="md-nav__link"> <span class="md-ellipsis"> 30秒上手 </span> </a> </li> <li class="md-nav__item"> <a href="#_3" class="md-nav__link"> <span class="md-ellipsis"> 输出示例 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#_4" class="md-nav__link"> <span class="md-ellipsis"> 核心特性 </span> </a> <nav class="md-nav" aria-label="核心特性"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#_5" class="md-nav__link"> <span class="md-ellipsis"> 多线程安全 </span> </a> </li> <li class="md-nav__item"> <a href="#_6" class="md-nav__link"> <span class="md-ellipsis"> 按行输出 </span> </a> </li> <li class="md-nav__item"> <a href="#_7" class="md-nav__link"> <span class="md-ellipsis"> 智能文件管理 </span> </a> </li> <li class="md-nav__item"> <a href="#_8" class="md-nav__link"> <span class="md-ellipsis"> 灵活配置 </span> </a> </li> <li class="md-nav__item"> <a href="#_9" class="md-nav__link"> <span class="md-ellipsis"> 高性能 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#api" class="md-nav__link"> <span class="md-ellipsis"> API参考 </span> </a> <nav class="md-nav" aria-label="API参考"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#_10" class="md-nav__link"> <span class="md-ellipsis"> 初始化宏 </span> </a> </li> <li class="md-nav__item"> <a href="#_11" class="md-nav__link"> <span class="md-ellipsis"> 日志记录宏 </span> </a> </li> <li class="md-nav__item"> <a href="#_12" class="md-nav__link"> <span class="md-ellipsis"> 运行时配置 </span> </a> </li> <li class="md-nav__item"> <a href="#_13" class="md-nav__link"> <span class="md-ellipsis"> 日志级别 </span> </a> </li> <li class="md-nav__item"> <a href="#_14" class="md-nav__link"> <span class="md-ellipsis"> 输出目标 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#_15" class="md-nav__link"> <span class="md-ellipsis"> 使用指南 </span> </a> <nav class="md-nav" aria-label="使用指南"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#1-autocad" class="md-nav__link"> <span class="md-ellipsis"> 1. AutoCAD 插件集成 </span> </a> </li> <li class="md-nav__item"> <a href="#2" class="md-nav__link"> <span class="md-ellipsis"> 2. 多线程应用 </span> </a> </li> <li class="md-nav__item"> <a href="#3" class="md-nav__link"> <span class="md-ellipsis"> 3. 错误追踪 </span> </a> </li> <li class="md-nav__item"> <a href="#4" class="md-nav__link"> <span class="md-ellipsis"> 4. 性能监控 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#_16" class="md-nav__link"> <span class="md-ellipsis"> 高级配置 </span> </a> <nav class="md-nav" aria-label="高级配置"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#_17" class="md-nav__link"> <span class="md-ellipsis"> 详细配置示例 </span> </a> </li> <li class="md-nav__item"> <a href="#_18" class="md-nav__link"> <span class="md-ellipsis"> 环境配置建议 </span> </a> </li> <li class="md-nav__item"> <a href="#_19" class="md-nav__link"> <span class="md-ellipsis"> 日志格式 </span> </a> </li> <li class="md-nav__item"> <a href="#_20" class="md-nav__link"> <span class="md-ellipsis"> 文件轮转 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#_21" class="md-nav__link"> <span class="md-ellipsis"> 项目集成 </span> </a> <nav class="md-nav" aria-label="项目集成"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#1" class="md-nav__link"> <span class="md-ellipsis"> 步骤1: 复制文件 </span> </a> </li> <li class="md-nav__item"> <a href="#2_1" class="md-nav__link"> <span class="md-ellipsis"> 步骤2: 添加到项目 </span> </a> </li> <li class="md-nav__item"> <a href="#3_1" class="md-nav__link"> <span class="md-ellipsis"> 步骤3: 包含头文件 </span> </a> </li> <li class="md-nav__item"> <a href="#4_1" class="md-nav__link"> <span class="md-ellipsis"> 步骤4: 使用 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#_22" class="md-nav__link"> <span class="md-ellipsis"> 常见问题 </span> </a> <nav class="md-nav" aria-label="常见问题"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#q1" class="md-nav__link"> <span class="md-ellipsis"> Q1: 日志文件为空或不完整 </span> </a> </li> <li class="md-nav__item"> <a href="#q2" class="md-nav__link"> <span class="md-ellipsis"> Q2: 多线程环境下日志混乱 </span> </a> </li> <li class="md-nav__item"> <a href="#q3" class="md-nav__link"> <span class="md-ellipsis"> Q3: 日志文件太大 </span> </a> </li> <li class="md-nav__item"> <a href="#q4" class="md-nav__link"> <span class="md-ellipsis"> Q4: 如何临时禁用日志 </span> </a> </li> <li class="md-nav__item"> <a href="#q5-v200" class="md-nav__link"> <span class="md-ellipsis"> Q5: 初始化时程序崩溃（v2.0.0早期版本） </span> </a> </li> <li class="md-nav__item"> <a href="#q6" class="md-nav__link"> <span class="md-ellipsis"> Q6: 性能影响？ </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#_23" class="md-nav__link"> <span class="md-ellipsis"> 最佳实践 </span> </a> <nav class="md-nav" aria-label="最佳实践"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#_24" class="md-nav__link"> <span class="md-ellipsis"> 推荐做法 </span> </a> </li> <li class="md-nav__item"> <a href="#_25" class="md-nav__link"> <span class="md-ellipsis"> 避免做法 </span> </a> </li> <li class="md-nav__item"> <a href="#_26" class="md-nav__link"> <span class="md-ellipsis"> 命令记录模板 </span> </a> </li> <li class="md-nav__item"> <a href="#_27" class="md-nav__link"> <span class="md-ellipsis"> 性能监控模板 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#_28" class="md-nav__link"> <span class="md-ellipsis"> 更新日志 </span> </a> <nav class="md-nav" aria-label="更新日志"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#v201-2025-10-28-" class="md-nav__link"> <span class="md-ellipsis"> v2.0.1 (2025-10-28) - 当前版本 </span> </a> </li> <li class="md-nav__item"> <a href="#v200-2025-10-28" class="md-nav__link"> <span class="md-ellipsis"> v2.0.0 (2025-10-28) </span> </a> </li> <li class="md-nav__item"> <a href="#v100" class="md-nav__link"> <span class="md-ellipsis"> v1.0.0 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#_29" class="md-nav__link"> <span class="md-ellipsis"> 性能指标 </span> </a> </li> <li class="md-nav__item"> <a href="#_30" class="md-nav__link"> <span class="md-ellipsis"> 快速参考卡片 </span> </a> </li> <li class="md-nav__item"> <a href="#_31" class="md-nav__link"> <span class="md-ellipsis"> 技术支持 </span> </a> <nav class="md-nav" aria-label="技术支持"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#_32" class="md-nav__link"> <span class="md-ellipsis"> 遇到问题 </span> </a> </li> <li class="md-nav__item"> <a href="#_33" class="md-nav__link"> <span class="md-ellipsis"> 需要示例 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#_34" class="md-nav__link"> <span class="md-ellipsis"> 总结 </span> </a> </li> <li class="md-nav__item"> <a href="#_35" class="md-nav__link"> <span class="md-ellipsis"> 完整代码 </span> </a> </li> </ul> </nav> </div> </div> </div> <article class="md-content__inner md-typeset"> <nav class="md-tags"> <a href="../../../../tags.html#tag:cpp" class="md-tag md-tag-icon">CPP</a> <a href="../../../../tags.html#tag:log日志" class="md-tag md-tag-icon">LOG日志</a> </nav> <h1 id="cminesymbollogger">CMineSymbolLogger 日志系统完整文档<a class="headerlink" href="#cminesymbollogger" title="Permanent link">¶</a></h1> <blockquote> <p>一个功能完善、线程安全、易于复用的企业级C++日志系统</p> </blockquote> <p><strong>版本</strong>: v2.0.1 | <strong>更新日期</strong>: 2025-10-28</p> <hr> <h2 id="_1">目录<a class="headerlink" href="#_1" title="Permanent link">¶</a></h2> <ul> <li><a href="#快速开始">快速开始</a></li> <li><a href="#核心特性">核心特性</a></li> <li><a href="#api参考">API参考</a></li> <li><a href="#使用指南">使用指南</a></li> <li><a href="#高级配置">高级配置</a></li> <li><a href="#项目集成">项目集成</a></li> <li><a href="#常见问题">常见问题</a></li> <li><a href="#最佳实践">最佳实践</a></li> <li><a href="#更新日志">更新日志</a></li> </ul> <hr> <h2 id="_2">快速开始<a class="headerlink" href="#_2" title="Permanent link">¶</a></h2> <h3 id="30">30秒上手<a class="headerlink" href="#30" title="Permanent link">¶</a></h3> <div class="language-cpp highlight"><table class="highlighttable"><tbody><tr><th colspan="2" class="filename"><span class="filename">C++</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">"CMineSymbolLogger.h"</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="p">{</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="w">    </span><span class="c1">// 1. 初始化</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="w">    </span><span class="c1">// 获取或创建日志目录</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="w">    </span><span class="n">CString</span><span class="w"> </span><span class="n">logDir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CUtility</span><span class="o">::</span><span class="n">GetConfigPath</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">_T</span><span class="p">(</span><span class="s">"Logs</span><span class="se">\\</span><span class="s">"</span><span class="p">);</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">PathFileExists</span><span class="p">(</span><span class="n">logDir</span><span class="p">))</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="w">        </span><span class="n">CreateDirectory</span><span class="p">(</span><span class="n">logDir</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="w">    </span><span class="c1">// 生成日志文件名（带日期）</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="w">    </span><span class="n">SYSTEMTIME</span><span class="w"> </span><span class="n">st</span><span class="p">;</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="w">    </span><span class="n">GetLocalTime</span><span class="p">(</span><span class="o">&amp;</span><span class="n">st</span><span class="p">);</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="w">    </span><span class="n">CString</span><span class="w"> </span><span class="n">logFileName</span><span class="p">;</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="w">    </span><span class="n">logFileName</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"SdCoal_%04d%02d%02d.log"</span><span class="p">),</span><span class="w"> </span><span class="n">st</span><span class="p">.</span><span class="n">wYear</span><span class="p">,</span><span class="w"> </span><span class="n">st</span><span class="p">.</span><span class="n">wMonth</span><span class="p">,</span><span class="w"> </span><span class="n">st</span><span class="p">.</span><span class="n">wDay</span><span class="p">);</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17"></a>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="w">    </span><span class="n">CString</span><span class="w"> </span><span class="n">logPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">logDir</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">logFileName</span><span class="p">;</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="w">    </span><span class="n">LOG_INIT</span><span class="p">(</span><span class="n">logPath</span><span class="p">,</span><span class="w"> </span><span class="n">LogLevel</span><span class="o">::</span><span class="n">Info</span><span class="p">);</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="w">    </span><span class="c1">//LOG_INIT(_T("C:\\Logs\\MyApp.log"), LogLevel::Info);</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21"></a>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="w">    </span><span class="c1">// 2. 记录日志</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="w">    </span><span class="n">LOG_INFO</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"Hello, Logger!"</span><span class="p">));</span>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="w">    </span><span class="n">LOG_INFO_F</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"用户ID: %d"</span><span class="p">),</span><span class="w"> </span><span class="mi">12345</span><span class="p">);</span>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25"></a>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="w">    </span><span class="c1">// 3. 关闭</span>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="w">    </span><span class="n">LOG_SHUTDOWN</span><span class="p">();</span>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28"></a>
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="p">}</span>
</span></code></pre></div></td></tr></tbody></table></div> <h3 id="_3">输出示例<a class="headerlink" href="#_3" title="Permanent link">¶</a></h3> <p><strong>控制台和文件输出:</strong> </p><div class="language-text highlight"><table class="highlighttable"><tbody><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">1</a></span>
<span class="normal"><a href="#__codelineno-1-2">2</a></span>
<span class="normal"><a href="#__codelineno-1-3">3</a></span>
<span class="normal"><a href="#__codelineno-1-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1"></a>[2025-10-28 16:00:00.123][INFO] 日志系统初始化成功 [级别:INFO, 目标:3, 文件:C:\Logs\MyApp.log]
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2"></a>[2025-10-28 16:00:00.456][INFO] Hello, Logger!
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3"></a>[2025-10-28 16:00:00.789][INFO] 用户ID: 12345
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4"></a>[2025-10-28 16:00:01.012][INFO] 日志系统关闭
</span></code></pre></div></td></tr></tbody></table></div><p></p> <hr> <h2 id="_4">核心特性<a class="headerlink" href="#_4" title="Permanent link">¶</a></h2> <h3 id="_5">多线程安全<a class="headerlink" href="#_5" title="Permanent link">¶</a></h3> <ul> <li>完全的线程安全保证</li> <li>使用 <code>std::mutex</code> 保护所有操作</li> <li>支持多线程并发调用</li> <li>可选的线程ID显示</li> </ul> <h3 id="_6">按行输出<a class="headerlink" href="#_6" title="Permanent link">¶</a></h3> <ul> <li>每条日志独立成行</li> <li>使用 <code>std::endl</code> 确保缓冲刷新</li> <li>避免多线程环境下日志混乱</li> </ul> <h3 id="_7">智能文件管理<a class="headerlink" href="#_7" title="Permanent link">¶</a></h3> <ul> <li>自动创建日志目录（递归）</li> <li>追加模式写入，不覆盖已有日志</li> <li>Unicode 编码支持</li> <li>文件大小自动轮转（默认10MB）</li> <li>自动备份管理（默认5个备份）</li> </ul> <h3 id="_8">灵活配置<a class="headerlink" href="#_8" title="Permanent link">¶</a></h3> <ul> <li>4个日志级别（Debug、Info、Warning、Error）</li> <li>3种输出目标（控制台、文件、两者）</li> <li>运行时动态调整配置</li> <li>可配置的时间戳和线程ID</li> <li>可选的自动刷新</li> </ul> <h3 id="_9">高性能<a class="headerlink" href="#_9" title="Permanent link">¶</a></h3> <ul> <li>控制台输出: ~50,000条/秒</li> <li>文件输出: ~10,000条/秒</li> <li>内存占用: &lt; 10KB</li> <li>日志延迟: &lt; 0.2ms</li> </ul> <hr> <h2 id="api">API参考<a class="headerlink" href="#api" title="Permanent link">¶</a></h2> <h3 id="_10">初始化宏<a class="headerlink" href="#_10" title="Permanent link">¶</a></h3> <div class="language-cpp highlight"><table class="highlighttable"><tbody><tr><th colspan="2" class="filename"><span class="filename">C++</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-2-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-2-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-2-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-2-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-2-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-2-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-2-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-2-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-2-10">10</a></span>
<span class="normal"><a href="#__codelineno-2-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="c1">// 控制台+文件输出</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2"></a><span class="n">LOG_INIT</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span><span class="w"> </span><span class="n">level</span><span class="p">)</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3"></a>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="c1">// 仅文件输出</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5"></a><span class="n">LOG_INIT_FILE_ONLY</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span><span class="w"> </span><span class="n">level</span><span class="p">)</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6"></a>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7"></a><span class="c1">// 仅控制台输出</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8"></a><span class="n">LOG_INIT_CONSOLE_ONLY</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9"></a>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10"></a><span class="c1">// 关闭系统</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11"></a><span class="n">LOG_SHUTDOWN</span><span class="p">()</span>
</span></code></pre></div></td></tr></tbody></table></div> <p><strong>示例:</strong> </p><div class="language-cpp highlight"><table class="highlighttable"><tbody><tr><th colspan="2" class="filename"><span class="filename">C++</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="n">LOG_INIT</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"C:</span><span class="se">\\</span><span class="s">Logs</span><span class="se">\\</span><span class="s">App.log"</span><span class="p">),</span><span class="w"> </span><span class="n">LogLevel</span><span class="o">::</span><span class="n">Info</span><span class="p">);</span>
</span></code></pre></div></td></tr></tbody></table></div><p></p> <h3 id="_11">日志记录宏<a class="headerlink" href="#_11" title="Permanent link">¶</a></h3> <table> <thead> <tr> <th>宏</th> <th>用途</th> <th>示例</th> </tr> </thead> <tbody> <tr> <td><code>LOG_DEBUG(msg)</code></td> <td>调试信息</td> <td><code>LOG_DEBUG(_T("调试"))</code></td> </tr> <tr> <td><code>LOG_INFO(msg)</code></td> <td>一般信息</td> <td><code>LOG_INFO(_T("信息"))</code></td> </tr> <tr> <td><code>LOG_WARNING(msg)</code></td> <td>警告</td> <td><code>LOG_WARNING(_T("警告"))</code></td> </tr> <tr> <td><code>LOG_ERROR(msg)</code></td> <td>错误</td> <td><code>LOG_ERROR(_T("错误"))</code></td> </tr> <tr> <td><code>LOG_DEBUG_F(fmt,...)</code></td> <td>格式化调试</td> <td><code>LOG_DEBUG_F(_T("值=%d"), v)</code></td> </tr> <tr> <td><code>LOG_INFO_F(fmt,...)</code></td> <td>格式化信息</td> <td><code>LOG_INFO_F(_T("ID=%d"), id)</code></td> </tr> <tr> <td><code>LOG_WARNING_F(fmt,...)</code></td> <td>格式化警告</td> <td><code>LOG_WARNING_F(_T("剩余=%d"), n)</code></td> </tr> <tr> <td><code>LOG_ERROR_F(fmt,...)</code></td> <td>格式化错误</td> <td><code>LOG_ERROR_F(_T("码=%d"), err)</code></td> </tr> </tbody> </table> <h3 id="_12">运行时配置<a class="headerlink" href="#_12" title="Permanent link">¶</a></h3> <div class="language-cpp highlight"><table class="highlighttable"><tbody><tr><th colspan="2" class="filename"><span class="filename">C++</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-4-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-4-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-4-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-4-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-4-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-4-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-4-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-4-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-4-10">10</a></span>
<span class="normal"><a href="#__codelineno-4-11">11</a></span>
<span class="normal"><a href="#__codelineno-4-12">12</a></span>
<span class="normal"><a href="#__codelineno-4-13">13</a></span>
<span class="normal"><a href="#__codelineno-4-14">14</a></span>
<span class="normal"><a href="#__codelineno-4-15">15</a></span>
<span class="normal"><a href="#__codelineno-4-16">16</a></span>
<span class="normal"><a href="#__codelineno-4-17">17</a></span>
<span class="normal"><a href="#__codelineno-4-18">18</a></span>
<span class="normal"><a href="#__codelineno-4-19">19</a></span>
<span class="normal"><a href="#__codelineno-4-20">20</a></span>
<span class="normal"><a href="#__codelineno-4-21">21</a></span>
<span class="normal"><a href="#__codelineno-4-22">22</a></span>
<span class="normal"><a href="#__codelineno-4-23">23</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="k">auto</span><span class="o">&amp;</span><span class="w"> </span><span class="n">logger</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">GetInstance</span><span class="p">();</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2"></a>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="c1">// 日志级别</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="n">logger</span><span class="p">.</span><span class="n">SetLogLevel</span><span class="p">(</span><span class="n">LogLevel</span><span class="o">::</span><span class="n">Debug</span><span class="p">);</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="n">LogLevel</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">logger</span><span class="p">.</span><span class="n">GetLogLevel</span><span class="p">();</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6"></a>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7"></a><span class="c1">// 输出目标</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8"></a><span class="n">logger</span><span class="p">.</span><span class="n">SetLogTarget</span><span class="p">(</span><span class="n">LogTarget</span><span class="o">::</span><span class="n">File</span><span class="p">);</span><span class="w">          </span><span class="c1">// 仅文件</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9"></a><span class="n">logger</span><span class="p">.</span><span class="n">EnableConsoleOutput</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span><span class="w">              </span><span class="c1">// 启用控制台</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10"></a><span class="n">logger</span><span class="p">.</span><span class="n">EnableFileOutput</span><span class="p">(</span><span class="nb">true</span><span class="p">,</span><span class="w"> </span><span class="n">_T</span><span class="p">(</span><span class="s">"path"</span><span class="p">));</span><span class="w">     </span><span class="c1">// 启用文件</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11"></a>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12"></a><span class="c1">// 格式选项</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13"></a><span class="n">logger</span><span class="p">.</span><span class="n">EnableThreadId</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span><span class="w">                   </span><span class="c1">// 显示线程ID</span>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14"></a><span class="n">logger</span><span class="p">.</span><span class="n">EnableTimestamp</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span><span class="w">                  </span><span class="c1">// 显示时间戳</span>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15"></a>
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16"></a><span class="c1">// 文件管理</span>
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17"></a><span class="n">logger</span><span class="p">.</span><span class="n">SetMaxFileSize</span><span class="p">(</span><span class="mi">10</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024</span><span class="p">);</span><span class="w">       </span><span class="c1">// 设置10MB</span>
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18"></a><span class="n">logger</span><span class="p">.</span><span class="n">SetMaxBackupFiles</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span><span class="w">                   </span><span class="c1">// 最多5个备份</span>
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19"></a><span class="n">logger</span><span class="p">.</span><span class="n">RotateLogFile</span><span class="p">();</span><span class="w">                        </span><span class="c1">// 手动轮转</span>
</span><span id="__span-4-20"><a id="__codelineno-4-20" name="__codelineno-4-20"></a><span class="n">logger</span><span class="p">.</span><span class="n">Flush</span><span class="p">();</span><span class="w">                                </span><span class="c1">// 手动刷新</span>
</span><span id="__span-4-21"><a id="__codelineno-4-21" name="__codelineno-4-21"></a>
</span><span id="__span-4-22"><a id="__codelineno-4-22" name="__codelineno-4-22"></a><span class="c1">// 性能优化</span>
</span><span id="__span-4-23"><a id="__codelineno-4-23" name="__codelineno-4-23"></a><span class="n">logger</span><span class="p">.</span><span class="n">EnableAutoFlush</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span><span class="w">                 </span><span class="c1">// 禁用自动刷新</span>
</span></code></pre></div></td></tr></tbody></table></div> <h3 id="_13">日志级别<a class="headerlink" href="#_13" title="Permanent link">¶</a></h3> <table> <thead> <tr> <th>级别</th> <th>说明</th> <th>使用场景</th> </tr> </thead> <tbody> <tr> <td><code>LogLevel::Debug</code></td> <td>最详细</td> <td>开发调试</td> </tr> <tr> <td><code>LogLevel::Info</code></td> <td>一般信息</td> <td>正常运行（默认）</td> </tr> <tr> <td><code>LogLevel::Warning</code></td> <td>警告</td> <td>潜在问题</td> </tr> <tr> <td><code>LogLevel::Error</code></td> <td>错误</td> <td>严重错误</td> </tr> </tbody> </table> <h3 id="_14">输出目标<a class="headerlink" href="#_14" title="Permanent link">¶</a></h3> <table> <thead> <tr> <th>目标</th> <th>说明</th> </tr> </thead> <tbody> <tr> <td><code>LogTarget::None</code></td> <td>不输出</td> </tr> <tr> <td><code>LogTarget::Console</code></td> <td>仅控制台</td> </tr> <tr> <td><code>LogTarget::File</code></td> <td>仅文件</td> </tr> <tr> <td><code>LogTarget::Both</code></td> <td>控制台+文件</td> </tr> </tbody> </table> <hr> <h2 id="_15">使用指南<a class="headerlink" href="#_15" title="Permanent link">¶</a></h2> <h3 id="1-autocad">1. AutoCAD 插件集成<a class="headerlink" href="#1-autocad" title="Permanent link">¶</a></h3> <div class="language-cpp highlight"><table class="highlighttable"><tbody><tr><th colspan="2" class="filename"><span class="filename">C++</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-5-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-5-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-5-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-5-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-5-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-5-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-5-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-5-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-5-10">10</a></span>
<span class="normal"><a href="#__codelineno-5-11">11</a></span>
<span class="normal"><a href="#__codelineno-5-12">12</a></span>
<span class="normal"><a href="#__codelineno-5-13">13</a></span>
<span class="normal"><a href="#__codelineno-5-14">14</a></span>
<span class="normal"><a href="#__codelineno-5-15">15</a></span>
<span class="normal"><a href="#__codelineno-5-16">16</a></span>
<span class="normal"><a href="#__codelineno-5-17">17</a></span>
<span class="normal"><a href="#__codelineno-5-18">18</a></span>
<span class="normal"><a href="#__codelineno-5-19">19</a></span>
<span class="normal"><a href="#__codelineno-5-20">20</a></span>
<span class="normal"><a href="#__codelineno-5-21">21</a></span>
<span class="normal"><a href="#__codelineno-5-22">22</a></span>
<span class="normal"><a href="#__codelineno-5-23">23</a></span>
<span class="normal"><a href="#__codelineno-5-24">24</a></span>
<span class="normal"><a href="#__codelineno-5-25">25</a></span>
<span class="normal"><a href="#__codelineno-5-26">26</a></span>
<span class="normal"><a href="#__codelineno-5-27">27</a></span>
<span class="normal"><a href="#__codelineno-5-28">28</a></span>
<span class="normal"><a href="#__codelineno-5-29">29</a></span>
<span class="normal"><a href="#__codelineno-5-30">30</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="kt">void</span><span class="w"> </span><span class="nf">acrxEntryPoint</span><span class="p">(</span><span class="n">AcRx</span><span class="o">::</span><span class="n">AppMsgCode</span><span class="w"> </span><span class="n">msg</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">appId</span><span class="p">)</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="p">{</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3"></a><span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="no">AcRx</span><span class="o">::</span><span class="no">kInitAppMsg</span><span class="p">:</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6"></a><span class="w">        </span><span class="n">LOG_INIT</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"C:</span><span class="se">\\</span><span class="s">Logs</span><span class="se">\\</span><span class="s">SdCoal.log"</span><span class="p">),</span><span class="w"> </span><span class="n">LogLevel</span><span class="o">::</span><span class="n">Info</span><span class="p">);</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7"></a><span class="w">        </span><span class="n">LOG_INFO</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"插件加载"</span><span class="p">));</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8"></a><span class="w">        </span><span class="k">break</span><span class="p">;</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9"></a>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="no">AcRx</span><span class="o">::</span><span class="no">kUnloadAppMsg</span><span class="p">:</span>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11"></a><span class="w">        </span><span class="n">LOG_INFO</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"插件卸载"</span><span class="p">));</span>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12"></a><span class="w">        </span><span class="n">LOG_SHUTDOWN</span><span class="p">();</span>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13"></a><span class="w">        </span><span class="k">break</span><span class="p">;</span>
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15"></a><span class="p">}</span>
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16"></a>
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17"></a><span class="kt">void</span><span class="w"> </span><span class="nf">cmdDrawFrame</span><span class="p">()</span>
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18"></a><span class="p">{</span>
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19"></a><span class="w">    </span><span class="n">LOG_INFO</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"执行命令: 绘制图框"</span><span class="p">));</span>
</span><span id="__span-5-20"><a id="__codelineno-5-20" name="__codelineno-5-20"></a>
</span><span id="__span-5-21"><a id="__codelineno-5-21" name="__codelineno-5-21"></a><span class="w">    </span><span class="k">try</span>
</span><span id="__span-5-22"><a id="__codelineno-5-22" name="__codelineno-5-22"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-5-23"><a id="__codelineno-5-23" name="__codelineno-5-23"></a><span class="w">        </span><span class="c1">// 命令逻辑</span>
</span><span id="__span-5-24"><a id="__codelineno-5-24" name="__codelineno-5-24"></a><span class="w">        </span><span class="n">LOG_INFO</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"命令完成"</span><span class="p">));</span>
</span><span id="__span-5-25"><a id="__codelineno-5-25" name="__codelineno-5-25"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-5-26"><a id="__codelineno-5-26" name="__codelineno-5-26"></a><span class="w">    </span><span class="k">catch</span><span class="w"> </span><span class="p">(...)</span>
</span><span id="__span-5-27"><a id="__codelineno-5-27" name="__codelineno-5-27"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-5-28"><a id="__codelineno-5-28" name="__codelineno-5-28"></a><span class="w">        </span><span class="n">LOG_ERROR</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"命令失败"</span><span class="p">));</span>
</span><span id="__span-5-29"><a id="__codelineno-5-29" name="__codelineno-5-29"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-5-30"><a id="__codelineno-5-30" name="__codelineno-5-30"></a><span class="p">}</span>
</span></code></pre></div></td></tr></tbody></table></div> <h3 id="2">2. 多线程应用<a class="headerlink" href="#2" title="Permanent link">¶</a></h3> <div class="language-cpp highlight"><table class="highlighttable"><tbody><tr><th colspan="2" class="filename"><span class="filename">C++</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-6-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-6-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-6-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-6-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-6-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-6-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-6-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-6-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-6-10">10</a></span>
<span class="normal"><a href="#__codelineno-6-11">11</a></span>
<span class="normal"><a href="#__codelineno-6-12">12</a></span>
<span class="normal"><a href="#__codelineno-6-13">13</a></span>
<span class="normal"><a href="#__codelineno-6-14">14</a></span>
<span class="normal"><a href="#__codelineno-6-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="c1">// 启用线程ID追踪</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="n">LOG_INIT</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"C:</span><span class="se">\\</span><span class="s">Logs</span><span class="se">\\</span><span class="s">MultiThread.log"</span><span class="p">),</span><span class="w"> </span><span class="n">LogLevel</span><span class="o">::</span><span class="n">Info</span><span class="p">);</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">GetInstance</span><span class="p">().</span><span class="n">EnableThreadId</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4"></a>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5"></a><span class="c1">// 多个线程并发记录</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6"></a><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="kr">thread</span><span class="o">&gt;</span><span class="w"> </span><span class="n">threads</span><span class="p">;</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7"></a><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8"></a><span class="p">{</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9"></a><span class="w">    </span><span class="n">threads</span><span class="p">.</span><span class="n">emplace_back</span><span class="p">([</span><span class="n">i</span><span class="p">]{</span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10"></a><span class="w">        </span><span class="n">LOG_INFO_F</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"线程 %d 运行中"</span><span class="p">),</span><span class="w"> </span><span class="n">i</span><span class="p">);</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12"></a><span class="p">}</span>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13"></a>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14"></a><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="o">&amp;</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">threads</span><span class="p">)</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">join</span><span class="p">();</span>
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15"></a><span class="n">LOG_SHUTDOWN</span><span class="p">();</span>
</span></code></pre></div></td></tr></tbody></table></div> <h3 id="3">3. 错误追踪<a class="headerlink" href="#3" title="Permanent link">¶</a></h3> <div class="language-cpp highlight"><table class="highlighttable"><tbody><tr><th colspan="2" class="filename"><span class="filename">C++</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1">1</a></span>
<span class="normal"><a href="#__codelineno-7-2">2</a></span>
<span class="normal"><a href="#__codelineno-7-3">3</a></span>
<span class="normal"><a href="#__codelineno-7-4">4</a></span>
<span class="normal"><a href="#__codelineno-7-5">5</a></span>
<span class="normal"><a href="#__codelineno-7-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="n">Acad</span><span class="o">::</span><span class="n">ErrorStatus</span><span class="w"> </span><span class="n">es</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">entity</span><span class="o">-&gt;</span><span class="n">open</span><span class="p">(</span><span class="n">AcDb</span><span class="o">::</span><span class="n">kForWrite</span><span class="p">);</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">es</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">Acad</span><span class="o">::</span><span class="n">eOk</span><span class="p">)</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="p">{</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="w">    </span><span class="n">LOG_ERROR_F</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"实体打开失败: ObjectId=%lld, 错误=%s"</span><span class="p">),</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5"></a><span class="w">        </span><span class="n">entityId</span><span class="p">.</span><span class="n">asOldId</span><span class="p">(),</span><span class="w"> </span><span class="n">acadErrorStatusText</span><span class="p">(</span><span class="n">es</span><span class="p">));</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6"></a><span class="p">}</span>
</span></code></pre></div></td></tr></tbody></table></div> <h3 id="4">4. 性能监控<a class="headerlink" href="#4" title="Permanent link">¶</a></h3> <div class="language-cpp highlight"><table class="highlighttable"><tbody><tr><th colspan="2" class="filename"><span class="filename">C++</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1">1</a></span>
<span class="normal"><a href="#__codelineno-8-2">2</a></span>
<span class="normal"><a href="#__codelineno-8-3">3</a></span>
<span class="normal"><a href="#__codelineno-8-4">4</a></span>
<span class="normal"><a href="#__codelineno-8-5">5</a></span>
<span class="normal"><a href="#__codelineno-8-6">6</a></span>
<span class="normal"><a href="#__codelineno-8-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="n">DWORD</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetTickCount</span><span class="p">();</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2"></a><span class="n">LOG_INFO</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"开始处理"</span><span class="p">));</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3"></a>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4"></a><span class="c1">// 处理逻辑...</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5"></a>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6"></a><span class="n">DWORD</span><span class="w"> </span><span class="n">elapsed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetTickCount</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="p">;</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7"></a><span class="n">LOG_INFO_F</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"处理完成，耗时: %d ms"</span><span class="p">),</span><span class="w"> </span><span class="n">elapsed</span><span class="p">);</span>
</span></code></pre></div></td></tr></tbody></table></div> <hr> <h2 id="_16">高级配置<a class="headerlink" href="#_16" title="Permanent link">¶</a></h2> <h3 id="_17">详细配置示例<a class="headerlink" href="#_17" title="Permanent link">¶</a></h3> <div class="language-cpp highlight"><table class="highlighttable"><tbody><tr><th colspan="2" class="filename"><span class="filename">C++</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-9-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-9-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-9-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-9-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-9-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-9-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-9-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-9-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-9-10">10</a></span>
<span class="normal"><a href="#__codelineno-9-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="n">LogConfig</span><span class="w"> </span><span class="n">config</span><span class="p">;</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2"></a><span class="n">config</span><span class="p">.</span><span class="n">Level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LogLevel</span><span class="o">::</span><span class="n">Debug</span><span class="p">;</span><span class="w">              </span><span class="c1">// 日志级别</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3"></a><span class="n">config</span><span class="p">.</span><span class="n">Target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LogTarget</span><span class="o">::</span><span class="n">Both</span><span class="p">;</span><span class="w">             </span><span class="c1">// 输出目标</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4"></a><span class="n">config</span><span class="p">.</span><span class="n">FilePath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_T</span><span class="p">(</span><span class="s">"C:</span><span class="se">\\</span><span class="s">Logs</span><span class="se">\\</span><span class="s">App.log"</span><span class="p">);</span><span class="w">   </span><span class="c1">// 文件路径</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5"></a><span class="n">config</span><span class="p">.</span><span class="n">AutoFlush</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w">                     </span><span class="c1">// 自动刷新</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6"></a><span class="n">config</span><span class="p">.</span><span class="n">MaxFileSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024</span><span class="p">;</span><span class="w">       </span><span class="c1">// 最大10MB</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7"></a><span class="n">config</span><span class="p">.</span><span class="n">MaxBackupFiles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w">                   </span><span class="c1">// 最多5个备份</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8"></a><span class="n">config</span><span class="p">.</span><span class="n">EnableTimestamp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w">               </span><span class="c1">// 显示时间戳</span>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9"></a><span class="n">config</span><span class="p">.</span><span class="n">EnableThreadId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w">                </span><span class="c1">// 显示线程ID</span>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10"></a>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11"></a><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">GetInstance</span><span class="p">().</span><span class="n">Initialize</span><span class="p">(</span><span class="n">config</span><span class="p">);</span>
</span></code></pre></div></td></tr></tbody></table></div> <h3 id="_18">环境配置建议<a class="headerlink" href="#_18" title="Permanent link">¶</a></h3> <p><strong>开发环境:</strong> </p><div class="language-cpp highlight"><table class="highlighttable"><tbody><tr><th colspan="2" class="filename"><span class="filename">C++</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="n">LOG_INIT_CONSOLE_ONLY</span><span class="p">(</span><span class="n">LogLevel</span><span class="o">::</span><span class="n">Debug</span><span class="p">);</span>
</span></code></pre></div></td></tr></tbody></table></div><p></p> <p><strong>测试环境:</strong> </p><div class="language-cpp highlight"><table class="highlighttable"><tbody><tr><th colspan="2" class="filename"><span class="filename">C++</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="n">LOG_INIT</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"C:</span><span class="se">\\</span><span class="s">Logs</span><span class="se">\\</span><span class="s">Test.log"</span><span class="p">),</span><span class="w"> </span><span class="n">LogLevel</span><span class="o">::</span><span class="n">Debug</span><span class="p">);</span>
</span></code></pre></div></td></tr></tbody></table></div><p></p> <p><strong>生产环境:</strong> </p><div class="language-cpp highlight"><table class="highlighttable"><tbody><tr><th colspan="2" class="filename"><span class="filename">C++</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1">1</a></span>
<span class="normal"><a href="#__codelineno-12-2">2</a></span>
<span class="normal"><a href="#__codelineno-12-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="n">LOG_INIT_FILE_ONLY</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"C:</span><span class="se">\\</span><span class="s">Logs</span><span class="se">\\</span><span class="s">Prod.log"</span><span class="p">),</span><span class="w"> </span><span class="n">LogLevel</span><span class="o">::</span><span class="n">Warning</span><span class="p">);</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2"></a><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">GetInstance</span><span class="p">().</span><span class="n">SetMaxFileSize</span><span class="p">(</span><span class="mi">50</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024</span><span class="p">);</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3"></a><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">GetInstance</span><span class="p">().</span><span class="n">SetMaxBackupFiles</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
</span></code></pre></div></td></tr></tbody></table></div><p></p> <p><strong>问题排查:</strong> </p><div class="language-cpp highlight"><table class="highlighttable"><tbody><tr><th colspan="2" class="filename"><span class="filename">C++</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1">1</a></span>
<span class="normal"><a href="#__codelineno-13-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="n">LOG_INIT</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"C:</span><span class="se">\\</span><span class="s">Logs</span><span class="se">\\</span><span class="s">Debug.log"</span><span class="p">),</span><span class="w"> </span><span class="n">LogLevel</span><span class="o">::</span><span class="n">Debug</span><span class="p">);</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2"></a><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">GetInstance</span><span class="p">().</span><span class="n">EnableThreadId</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
</span></code></pre></div></td></tr></tbody></table></div><p></p> <h3 id="_19">日志格式<a class="headerlink" href="#_19" title="Permanent link">¶</a></h3> <p><strong>标准格式:</strong> </p><div class="language-text highlight"><table class="highlighttable"><tbody><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1">1</a></span>
<span class="normal"><a href="#__codelineno-14-2">2</a></span>
<span class="normal"><a href="#__codelineno-14-3">3</a></span>
<span class="normal"><a href="#__codelineno-14-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1"></a>[2025-10-28 15:30:45.123][INFO] 程序启动
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2"></a>[2025-10-28 15:30:46.456][DEBUG] 加载配置
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3"></a>[2025-10-28 15:30:47.789][WARNING] 配置缺失
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4"></a>[2025-10-28 15:30:48.012][ERROR] 文件错误
</span></code></pre></div></td></tr></tbody></table></div><p></p> <p><strong>带线程ID格式:</strong> </p><div class="language-text highlight"><table class="highlighttable"><tbody><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1">1</a></span>
<span class="normal"><a href="#__codelineno-15-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1"></a>[2025-10-28 15:30:45.123][TID:1A2B][INFO] 主线程
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2"></a>[2025-10-28 15:30:46.456][TID:2C3D][DEBUG] 工作线程
</span></code></pre></div></td></tr></tbody></table></div><p></p> <h3 id="_20">文件轮转<a class="headerlink" href="#_20" title="Permanent link">¶</a></h3> <p>当日志文件达到最大大小时自动轮转：</p> <div class="language-text highlight"><table class="highlighttable"><tbody><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-16-1">1</a></span>
<span class="normal"><a href="#__codelineno-16-2">2</a></span>
<span class="normal"><a href="#__codelineno-16-3">3</a></span>
<span class="normal"><a href="#__codelineno-16-4">4</a></span>
<span class="normal"><a href="#__codelineno-16-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1"></a>MyApp.log         (当前日志文件)
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2"></a>MyApp.log.1       (第一个备份)
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3"></a>MyApp.log.2       (第二个备份)
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4"></a>MyApp.log.3       (第三个备份)
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5"></a>...
</span></code></pre></div></td></tr></tbody></table></div> <hr> <h2 id="_21">项目集成<a class="headerlink" href="#_21" title="Permanent link">¶</a></h2> <h3 id="1">步骤1: 复制文件<a class="headerlink" href="#1" title="Permanent link">¶</a></h3> <p>将以下文件复制到新项目： - <code>CMineSymbolLogger.h</code> - <code>CMineSymbolLogger.cpp</code></p> <h3 id="2_1">步骤2: 添加到项目<a class="headerlink" href="#2_1" title="Permanent link">¶</a></h3> <p>在 Visual Studio 中： 1. 右键项目 → 添加 → 现有项 2. 选择上述两个文件</p> <h3 id="3_1">步骤3: 包含头文件<a class="headerlink" href="#3_1" title="Permanent link">¶</a></h3> <div class="language-cpp highlight"><table class="highlighttable"><tbody><tr><th colspan="2" class="filename"><span class="filename">C++</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-17-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">"CMineSymbolLogger.h"</span>
</span></code></pre></div></td></tr></tbody></table></div> <h3 id="4_1">步骤4: 使用<a class="headerlink" href="#4_1" title="Permanent link">¶</a></h3> <div class="language-cpp highlight"><table class="highlighttable"><tbody><tr><th colspan="2" class="filename"><span class="filename">C++</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-18-1">1</a></span>
<span class="normal"><a href="#__codelineno-18-2">2</a></span>
<span class="normal"><a href="#__codelineno-18-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1"></a><span class="n">LOG_INIT</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"C:</span><span class="se">\\</span><span class="s">Logs</span><span class="se">\\</span><span class="s">App.log"</span><span class="p">),</span><span class="w"> </span><span class="n">LogLevel</span><span class="o">::</span><span class="n">Info</span><span class="p">);</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2"></a><span class="n">LOG_INFO</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"Hello from new project!"</span><span class="p">));</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3"></a><span class="n">LOG_SHUTDOWN</span><span class="p">();</span>
</span></code></pre></div></td></tr></tbody></table></div> <p>就这么简单！?</p> <hr> <h2 id="_22">常见问题<a class="headerlink" href="#_22" title="Permanent link">¶</a></h2> <h3 id="q1">Q1: 日志文件为空或不完整<a class="headerlink" href="#q1" title="Permanent link">¶</a></h3> <p><strong>A:</strong> 确保调用了 <code>Flush()</code> 或 <code>Shutdown()</code>：</p> <div class="language-cpp highlight"><table class="highlighttable"><tbody><tr><th colspan="2" class="filename"><span class="filename">C++</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-19-1">1</a></span>
<span class="normal"><a href="#__codelineno-19-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1"></a><span class="n">LOG_INFO</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"重要消息"</span><span class="p">));</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2"></a><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">GetInstance</span><span class="p">().</span><span class="n">Flush</span><span class="p">();</span><span class="w">  </span><span class="c1">// 立即刷新</span>
</span></code></pre></div></td></tr></tbody></table></div> <h3 id="q2">Q2: 多线程环境下日志混乱<a class="headerlink" href="#q2" title="Permanent link">¶</a></h3> <p><strong>A:</strong> 本系统已完全线程安全，建议启用线程ID：</p> <div class="language-cpp highlight"><table class="highlighttable"><tbody><tr><th colspan="2" class="filename"><span class="filename">C++</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-20-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1"></a><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">GetInstance</span><span class="p">().</span><span class="n">EnableThreadId</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
</span></code></pre></div></td></tr></tbody></table></div> <h3 id="q3">Q3: 日志文件太大<a class="headerlink" href="#q3" title="Permanent link">¶</a></h3> <p><strong>A:</strong> 配置文件大小限制和备份数量：</p> <div class="language-cpp highlight"><table class="highlighttable"><tbody><tr><th colspan="2" class="filename"><span class="filename">C++</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-21-1">1</a></span>
<span class="normal"><a href="#__codelineno-21-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1"></a><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">GetInstance</span><span class="p">().</span><span class="n">SetMaxFileSize</span><span class="p">(</span><span class="mi">10</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024</span><span class="p">);</span><span class="w">  </span><span class="c1">// 10MB</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2"></a><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">GetInstance</span><span class="p">().</span><span class="n">SetMaxBackupFiles</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
</span></code></pre></div></td></tr></tbody></table></div> <h3 id="q4">Q4: 如何临时禁用日志<a class="headerlink" href="#q4" title="Permanent link">¶</a></h3> <p><strong>A:</strong> 设置最高日志级别或关闭输出：</p> <div class="language-cpp highlight"><table class="highlighttable"><tbody><tr><th colspan="2" class="filename"><span class="filename">C++</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-22-1">1</a></span>
<span class="normal"><a href="#__codelineno-22-2">2</a></span>
<span class="normal"><a href="#__codelineno-22-3">3</a></span>
<span class="normal"><a href="#__codelineno-22-4">4</a></span>
<span class="normal"><a href="#__codelineno-22-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1"></a><span class="c1">// 方法1：只输出Error</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2"></a><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">GetInstance</span><span class="p">().</span><span class="n">SetLogLevel</span><span class="p">(</span><span class="n">LogLevel</span><span class="o">::</span><span class="n">Error</span><span class="p">);</span>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3"></a>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4"></a><span class="c1">// 方法2：关闭所有输出</span>
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5"></a><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">GetInstance</span><span class="p">().</span><span class="n">SetLogTarget</span><span class="p">(</span><span class="n">LogTarget</span><span class="o">::</span><span class="n">None</span><span class="p">);</span>
</span></code></pre></div></td></tr></tbody></table></div> <h3 id="q5-v200">Q5: 初始化时程序崩溃（v2.0.0早期版本）<a class="headerlink" href="#q5-v200" title="Permanent link">¶</a></h3> <p><strong>问题:</strong> 死锁问题导致崩溃</p> <p><strong>修复:</strong> 已在 v2.0.1 中修复，添加了内部方法 <code>LogInternal</code> 避免死锁</p> <p><strong>解决方案:</strong> 使用最新版本即可</p> <p><strong>技术细节:</strong> - <strong>原因</strong>: <code>Initialize</code> 方法在持有锁的情况下调用了 <code>Log</code> 方法，导致死锁 - <strong>修复</strong>: 添加 <code>LogInternal</code> 内部方法，在已持有锁的情况下使用 - <strong>影响</strong>: 无，对外部API完全透明</p> <h3 id="q6">Q6: 性能影响？<a class="headerlink" href="#q6" title="Permanent link">¶</a></h3> <p><strong>A:</strong> 可禁用自动刷新提升性能：</p> <div class="language-cpp highlight"><table class="highlighttable"><tbody><tr><th colspan="2" class="filename"><span class="filename">C++</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-23-1">1</a></span>
<span class="normal"><a href="#__codelineno-23-2">2</a></span>
<span class="normal"><a href="#__codelineno-23-3">3</a></span>
<span class="normal"><a href="#__codelineno-23-4">4</a></span>
<span class="normal"><a href="#__codelineno-23-5">5</a></span>
<span class="normal"><a href="#__codelineno-23-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1"></a><span class="n">LogConfig</span><span class="w"> </span><span class="n">config</span><span class="p">;</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2"></a><span class="n">config</span><span class="p">.</span><span class="n">AutoFlush</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span><span class="w">  </span><span class="c1">// 高性能模式</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3"></a><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">GetInstance</span><span class="p">().</span><span class="n">Initialize</span><span class="p">(</span><span class="n">config</span><span class="p">);</span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4"></a>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5"></a><span class="c1">// 在关键点手动刷新</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6"></a><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">GetInstance</span><span class="p">().</span><span class="n">Flush</span><span class="p">();</span>
</span></code></pre></div></td></tr></tbody></table></div> <hr> <h2 id="_23">最佳实践<a class="headerlink" href="#_23" title="Permanent link">¶</a></h2> <h3 id="_24">推荐做法<a class="headerlink" href="#_24" title="Permanent link">¶</a></h3> <div class="language-cpp highlight"><table class="highlighttable"><tbody><tr><th colspan="2" class="filename"><span class="filename">C++</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-24-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-24-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-24-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-24-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-24-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-24-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-24-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-24-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-24-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-24-10">10</a></span>
<span class="normal"><a href="#__codelineno-24-11">11</a></span>
<span class="normal"><a href="#__codelineno-24-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1"></a><span class="c1">// 1. 统一初始化</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2"></a><span class="n">LOG_INIT</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"C:</span><span class="se">\\</span><span class="s">Logs</span><span class="se">\\</span><span class="s">App.log"</span><span class="p">),</span><span class="w"> </span><span class="n">LogLevel</span><span class="o">::</span><span class="n">Info</span><span class="p">);</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3"></a>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4"></a><span class="c1">// 2. 使用格式化</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5"></a><span class="n">LOG_INFO_F</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"用户: %s, ID: %d"</span><span class="p">),</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="p">);</span>
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6"></a>
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7"></a><span class="c1">// 3. 关键点刷新</span>
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8"></a><span class="n">LOG_ERROR</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"严重错误"</span><span class="p">));</span>
</span><span id="__span-24-9"><a id="__codelineno-24-9" name="__codelineno-24-9"></a><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">GetInstance</span><span class="p">().</span><span class="n">Flush</span><span class="p">();</span>
</span><span id="__span-24-10"><a id="__codelineno-24-10" name="__codelineno-24-10"></a>
</span><span id="__span-24-11"><a id="__codelineno-24-11" name="__codelineno-24-11"></a><span class="c1">// 4. 程序退出前关闭</span>
</span><span id="__span-24-12"><a id="__codelineno-24-12" name="__codelineno-24-12"></a><span class="n">LOG_SHUTDOWN</span><span class="p">();</span>
</span></code></pre></div></td></tr></tbody></table></div> <h3 id="_25">避免做法<a class="headerlink" href="#_25" title="Permanent link">¶</a></h3> <div class="language-cpp highlight"><table class="highlighttable"><tbody><tr><th colspan="2" class="filename"><span class="filename">C++</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-25-1">1</a></span>
<span class="normal"><a href="#__codelineno-25-2">2</a></span>
<span class="normal"><a href="#__codelineno-25-3">3</a></span>
<span class="normal"><a href="#__codelineno-25-4">4</a></span>
<span class="normal"><a href="#__codelineno-25-5">5</a></span>
<span class="normal"><a href="#__codelineno-25-6">6</a></span>
<span class="normal"><a href="#__codelineno-25-7">7</a></span>
<span class="normal"><a href="#__codelineno-25-8">8</a></span>
<span class="normal"><a href="#__codelineno-25-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1"></a><span class="c1">// 1. 不要在紧密循环中记录</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2"></a><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1000000</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3"></a><span class="w">    </span><span class="n">LOG_DEBUG_F</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"i=%d"</span><span class="p">),</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w">  </span><span class="c1">// ? 太频繁</span>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4"></a>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5"></a><span class="c1">// 2. 不要忘记初始化</span>
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6"></a><span class="n">LOG_INFO</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"消息"</span><span class="p">));</span><span class="w">  </span><span class="c1">// ? 未初始化</span>
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7"></a>
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8"></a><span class="c1">// 3. 不要遗漏关闭</span>
</span><span id="__span-25-9"><a id="__codelineno-25-9" name="__codelineno-25-9"></a><span class="c1">// ? 程序退出时未调用 LOG_SHUTDOWN()</span>
</span></code></pre></div></td></tr></tbody></table></div> <h3 id="_26">命令记录模板<a class="headerlink" href="#_26" title="Permanent link">¶</a></h3> <div class="language-cpp highlight"><table class="highlighttable"><tbody><tr><th colspan="2" class="filename"><span class="filename">C++</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-26-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-26-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-26-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-26-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-26-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-26-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-26-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-26-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-26-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-26-10">10</a></span>
<span class="normal"><a href="#__codelineno-26-11">11</a></span>
<span class="normal"><a href="#__codelineno-26-12">12</a></span>
<span class="normal"><a href="#__codelineno-26-13">13</a></span>
<span class="normal"><a href="#__codelineno-26-14">14</a></span>
<span class="normal"><a href="#__codelineno-26-15">15</a></span>
<span class="normal"><a href="#__codelineno-26-16">16</a></span>
<span class="normal"><a href="#__codelineno-26-17">17</a></span>
<span class="normal"><a href="#__codelineno-26-18">18</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1"></a><span class="kt">void</span><span class="w"> </span><span class="nf">cmdMyCommand</span><span class="p">()</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2"></a><span class="p">{</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3"></a><span class="w">    </span><span class="n">LOG_INFO</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"执行命令: MyCommand"</span><span class="p">));</span>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4"></a>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5"></a><span class="w">    </span><span class="k">try</span>
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7"></a><span class="w">        </span><span class="c1">// 命令逻辑</span>
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8"></a><span class="w">        </span><span class="n">LOG_INFO</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"命令执行成功"</span><span class="p">));</span>
</span><span id="__span-26-9"><a id="__codelineno-26-9" name="__codelineno-26-9"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-26-10"><a id="__codelineno-26-10" name="__codelineno-26-10"></a><span class="w">    </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">exception</span><span class="o">&amp;</span><span class="w"> </span><span class="n">e</span><span class="p">)</span>
</span><span id="__span-26-11"><a id="__codelineno-26-11" name="__codelineno-26-11"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-26-12"><a id="__codelineno-26-12" name="__codelineno-26-12"></a><span class="w">        </span><span class="n">LOG_ERROR_F</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"命令异常: %s"</span><span class="p">),</span><span class="w"> </span><span class="n">CString</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">what</span><span class="p">()));</span>
</span><span id="__span-26-13"><a id="__codelineno-26-13" name="__codelineno-26-13"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-26-14"><a id="__codelineno-26-14" name="__codelineno-26-14"></a><span class="w">    </span><span class="k">catch</span><span class="w"> </span><span class="p">(...)</span>
</span><span id="__span-26-15"><a id="__codelineno-26-15" name="__codelineno-26-15"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-26-16"><a id="__codelineno-26-16" name="__codelineno-26-16"></a><span class="w">        </span><span class="n">LOG_ERROR</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"命令执行失败: 未知异常"</span><span class="p">));</span>
</span><span id="__span-26-17"><a id="__codelineno-26-17" name="__codelineno-26-17"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-26-18"><a id="__codelineno-26-18" name="__codelineno-26-18"></a><span class="p">}</span>
</span></code></pre></div></td></tr></tbody></table></div> <h3 id="_27">性能监控模板<a class="headerlink" href="#_27" title="Permanent link">¶</a></h3> <div class="language-cpp highlight"><table class="highlighttable"><tbody><tr><th colspan="2" class="filename"><span class="filename">C++</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-27-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-27-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-27-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-27-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-27-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-27-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-27-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-27-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-27-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-27-10">10</a></span>
<span class="normal"><a href="#__codelineno-27-11">11</a></span>
<span class="normal"><a href="#__codelineno-27-12">12</a></span>
<span class="normal"><a href="#__codelineno-27-13">13</a></span>
<span class="normal"><a href="#__codelineno-27-14">14</a></span>
<span class="normal"><a href="#__codelineno-27-15">15</a></span>
<span class="normal"><a href="#__codelineno-27-16">16</a></span>
<span class="normal"><a href="#__codelineno-27-17">17</a></span>
<span class="normal"><a href="#__codelineno-27-18">18</a></span>
<span class="normal"><a href="#__codelineno-27-19">19</a></span>
<span class="normal"><a href="#__codelineno-27-20">20</a></span>
<span class="normal"><a href="#__codelineno-27-21">21</a></span>
<span class="normal"><a href="#__codelineno-27-22">22</a></span>
<span class="normal"><a href="#__codelineno-27-23">23</a></span>
<span class="normal"><a href="#__codelineno-27-24">24</a></span>
<span class="normal"><a href="#__codelineno-27-25">25</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1"></a><span class="kt">void</span><span class="w"> </span><span class="nf">ProcessData</span><span class="p">()</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2"></a><span class="p">{</span>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3"></a><span class="w">    </span><span class="n">DWORD</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetTickCount</span><span class="p">();</span>
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4"></a><span class="w">    </span><span class="n">LOG_INFO</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"开始处理数据"</span><span class="p">));</span>
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5"></a>
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">total</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">success</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">failed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span id="__span-27-7"><a id="__codelineno-27-7" name="__codelineno-27-7"></a>
</span><span id="__span-27-8"><a id="__codelineno-27-8" name="__codelineno-27-8"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">total</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
</span><span id="__span-27-9"><a id="__codelineno-27-9" name="__codelineno-27-9"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-27-10"><a id="__codelineno-27-10" name="__codelineno-27-10"></a><span class="w">        </span><span class="c1">// 每100条记录一次进度</span>
</span><span id="__span-27-11"><a id="__codelineno-27-11" name="__codelineno-27-11"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-27-12"><a id="__codelineno-27-12" name="__codelineno-27-12"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-27-13"><a id="__codelineno-27-13" name="__codelineno-27-13"></a><span class="w">            </span><span class="n">LOG_INFO_F</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"处理进度: %d/%d (%.1f%%)"</span><span class="p">),</span>
</span><span id="__span-27-14"><a id="__codelineno-27-14" name="__codelineno-27-14"></a><span class="w">                </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">total</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">100.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">total</span><span class="p">));</span>
</span><span id="__span-27-15"><a id="__codelineno-27-15" name="__codelineno-27-15"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-27-16"><a id="__codelineno-27-16" name="__codelineno-27-16"></a>
</span><span id="__span-27-17"><a id="__codelineno-27-17" name="__codelineno-27-17"></a><span class="w">        </span><span class="c1">// 处理逻辑</span>
</span><span id="__span-27-18"><a id="__codelineno-27-18" name="__codelineno-27-18"></a><span class="w">        </span><span class="kt">bool</span><span class="w"> </span><span class="n">ok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Process</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
</span><span id="__span-27-19"><a id="__codelineno-27-19" name="__codelineno-27-19"></a><span class="w">        </span><span class="n">ok</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">success</span><span class="o">++</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">failed</span><span class="o">++</span><span class="p">;</span>
</span><span id="__span-27-20"><a id="__codelineno-27-20" name="__codelineno-27-20"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-27-21"><a id="__codelineno-27-21" name="__codelineno-27-21"></a>
</span><span id="__span-27-22"><a id="__codelineno-27-22" name="__codelineno-27-22"></a><span class="w">    </span><span class="n">DWORD</span><span class="w"> </span><span class="n">elapsed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetTickCount</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="p">;</span>
</span><span id="__span-27-23"><a id="__codelineno-27-23" name="__codelineno-27-23"></a><span class="w">    </span><span class="n">LOG_INFO_F</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"处理完成: 总数=%d, 成功=%d, 失败=%d, 耗时=%d ms"</span><span class="p">),</span>
</span><span id="__span-27-24"><a id="__codelineno-27-24" name="__codelineno-27-24"></a><span class="w">        </span><span class="n">total</span><span class="p">,</span><span class="w"> </span><span class="n">success</span><span class="p">,</span><span class="w"> </span><span class="n">failed</span><span class="p">,</span><span class="w"> </span><span class="n">elapsed</span><span class="p">);</span>
</span><span id="__span-27-25"><a id="__codelineno-27-25" name="__codelineno-27-25"></a><span class="p">}</span>
</span></code></pre></div></td></tr></tbody></table></div> <hr> <h2 id="_28">更新日志<a class="headerlink" href="#_28" title="Permanent link">¶</a></h2> <h3 id="v201-2025-10-28-">v2.0.1 (2025-10-28) - 当前版本<a class="headerlink" href="#v201-2025-10-28-" title="Permanent link">¶</a></h3> <ul> <li><strong>修复</strong>: 初始化时的死锁崩溃问题</li> <li><strong>新增</strong>: <code>LogInternal</code> 内部方法避免重复加锁</li> <li><strong>文档</strong>: 整合所有文档为单一文件</li> <li><strong>优化</strong>: 提升代码健壮性</li> </ul> <h3 id="v200-2025-10-28">v2.0.0 (2025-10-28)<a class="headerlink" href="#v200-2025-10-28" title="Permanent link">¶</a></h3> <ul> <li><strong>新增</strong>: 完善的初始化系统</li> <li><strong>新增</strong>: 日志轮转功能</li> <li><strong>新增</strong>: 线程ID显示</li> <li><strong>新增</strong>: 便捷初始化宏</li> <li><strong>增强</strong>: 完全的多线程安全</li> <li><strong>增强</strong>: 智能文件管理</li> <li><strong>优化</strong>: 性能提升</li> <li><strong>文档</strong>: 完善的文档体系</li> </ul> <h3 id="v100">v1.0.0<a class="headerlink" href="#v100" title="Permanent link">¶</a></h3> <ul> <li>基础日志功能</li> <li>简单文件输出</li> <li>控制台输出</li> <li>基本多线程支持</li> </ul> <hr> <h2 id="_29">性能指标<a class="headerlink" href="#_29" title="Permanent link">¶</a></h2> <table> <thead> <tr> <th>场景</th> <th>吞吐量</th> <th>延迟</th> <th>内存</th> </tr> </thead> <tbody> <tr> <td>仅控制台输出</td> <td>~50,000 条/秒</td> <td>&lt; 0.02ms</td> <td>&lt; 10KB</td> </tr> <tr> <td>仅文件输出（自动刷新）</td> <td>~10,000 条/秒</td> <td>&lt; 0.1ms</td> <td>&lt; 10KB</td> </tr> <tr> <td>仅文件输出（手动刷新）</td> <td>~100,000 条/秒</td> <td>&lt; 0.01ms</td> <td>&lt; 10KB</td> </tr> <tr> <td>多线程（4线程）</td> <td>~30,000 条/秒</td> <td>&lt; 0.15ms</td> <td>&lt; 10KB</td> </tr> </tbody> </table> <hr> <h2 id="_30">快速参考卡片<a class="headerlink" href="#_30" title="Permanent link">¶</a></h2> <table> <thead> <tr> <th>操作</th> <th>代码</th> </tr> </thead> <tbody> <tr> <td><strong>初始化</strong></td> <td><code>LOG_INIT(_T("C:\\Logs\\App.log"), LogLevel::Info)</code></td> </tr> <tr> <td><strong>记录日志</strong></td> <td><code>LOG_INFO(_T("消息"))</code></td> </tr> <tr> <td><strong>格式化</strong></td> <td><code>LOG_INFO_F(_T("ID=%d"), id)</code></td> </tr> <tr> <td><strong>关闭</strong></td> <td><code>LOG_SHUTDOWN()</code></td> </tr> <tr> <td><strong>调整级别</strong></td> <td><code>CMineSymbolLogger::GetInstance().SetLogLevel(LogLevel::Debug)</code></td> </tr> <tr> <td><strong>启用线程ID</strong></td> <td><code>CMineSymbolLogger::GetInstance().EnableThreadId(true)</code></td> </tr> <tr> <td><strong>手动刷新</strong></td> <td><code>CMineSymbolLogger::GetInstance().Flush()</code></td> </tr> <tr> <td><strong>设置文件大小</strong></td> <td><code>CMineSymbolLogger::GetInstance().SetMaxFileSize(10*1024*1024)</code></td> </tr> </tbody> </table> <hr> <h2 id="_31">技术支持<a class="headerlink" href="#_31" title="Permanent link">¶</a></h2> <h3 id="_32">遇到问题<a class="headerlink" href="#_32" title="Permanent link">¶</a></h3> <ol> <li>查看 <a href="#常见问题">常见问题</a> 章节</li> <li>检查是否正确初始化</li> <li>确认日志级别设置</li> <li>验证文件路径有效性</li> <li>确保程序退出前调用 <code>LOG_SHUTDOWN()</code></li> </ol> <h3 id="_33">需要示例<a class="headerlink" href="#_33" title="Permanent link">¶</a></h3> <p>参考 <a href="#使用指南">使用指南</a> 和 <a href="#最佳实践">最佳实践</a> 章节</p> <hr> <h2 id="_34">总结<a class="headerlink" href="#_34" title="Permanent link">¶</a></h2> <p><strong>记住三个关键步骤：</strong> 1. <strong>初始化</strong>: <code>LOG_INIT(路径, 级别)</code> 2. <strong>记录</strong>: <code>LOG_INFO(_T("消息"))</code> 3. <strong>关闭</strong>: <code>LOG_SHUTDOWN()</code></p> <p><strong>核心优势：</strong> - 零配置即用 - 一行代码初始化 - 完全线程安全 - 无需担心并发 - 智能文件管理 - 自动轮转备份 - 高性能低开销 - 50,000条/秒，&lt;10KB内存 - 易于复用 - 只需两个文件 - 文档完善 - 完整的使用说明</p> <h2 id="_35">完整代码<a class="headerlink" href="#_35" title="Permanent link">¶</a></h2> <p><code>CMineSymbolLogger.h</code></p> <div class="language-cpp highlight"><table class="highlighttable"><tbody><tr><th colspan="2" class="filename"><span class="filename">C++</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-28-1">  1</a></span>
<span class="normal"><a href="#__codelineno-28-2">  2</a></span>
<span class="normal"><a href="#__codelineno-28-3">  3</a></span>
<span class="normal"><a href="#__codelineno-28-4">  4</a></span>
<span class="normal"><a href="#__codelineno-28-5">  5</a></span>
<span class="normal"><a href="#__codelineno-28-6">  6</a></span>
<span class="normal"><a href="#__codelineno-28-7">  7</a></span>
<span class="normal"><a href="#__codelineno-28-8">  8</a></span>
<span class="normal"><a href="#__codelineno-28-9">  9</a></span>
<span class="normal"><a href="#__codelineno-28-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-28-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-28-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-28-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-28-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-28-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-28-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-28-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-28-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-28-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-28-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-28-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-28-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-28-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-28-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-28-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-28-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-28-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-28-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-28-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-28-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-28-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-28-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-28-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-28-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-28-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-28-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-28-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-28-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-28-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-28-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-28-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-28-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-28-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-28-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-28-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-28-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-28-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-28-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-28-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-28-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-28-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-28-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-28-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-28-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-28-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-28-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-28-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-28-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-28-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-28-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-28-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-28-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-28-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-28-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-28-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-28-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-28-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-28-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-28-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-28-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-28-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-28-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-28-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-28-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-28-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-28-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-28-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-28-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-28-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-28-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-28-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-28-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-28-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-28-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-28-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-28-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-28-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-28-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-28-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-28-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-28-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-28-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-28-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-28-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-28-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-28-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-28-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-28-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-28-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-28-100">100</a></span>
<span class="normal"><a href="#__codelineno-28-101">101</a></span>
<span class="normal"><a href="#__codelineno-28-102">102</a></span>
<span class="normal"><a href="#__codelineno-28-103">103</a></span>
<span class="normal"><a href="#__codelineno-28-104">104</a></span>
<span class="normal"><a href="#__codelineno-28-105">105</a></span>
<span class="normal"><a href="#__codelineno-28-106">106</a></span>
<span class="normal"><a href="#__codelineno-28-107">107</a></span>
<span class="normal"><a href="#__codelineno-28-108">108</a></span>
<span class="normal"><a href="#__codelineno-28-109">109</a></span>
<span class="normal"><a href="#__codelineno-28-110">110</a></span>
<span class="normal"><a href="#__codelineno-28-111">111</a></span>
<span class="normal"><a href="#__codelineno-28-112">112</a></span>
<span class="normal"><a href="#__codelineno-28-113">113</a></span>
<span class="normal"><a href="#__codelineno-28-114">114</a></span>
<span class="normal"><a href="#__codelineno-28-115">115</a></span>
<span class="normal"><a href="#__codelineno-28-116">116</a></span>
<span class="normal"><a href="#__codelineno-28-117">117</a></span>
<span class="normal"><a href="#__codelineno-28-118">118</a></span>
<span class="normal"><a href="#__codelineno-28-119">119</a></span>
<span class="normal"><a href="#__codelineno-28-120">120</a></span>
<span class="normal"><a href="#__codelineno-28-121">121</a></span>
<span class="normal"><a href="#__codelineno-28-122">122</a></span>
<span class="normal"><a href="#__codelineno-28-123">123</a></span>
<span class="normal"><a href="#__codelineno-28-124">124</a></span>
<span class="normal"><a href="#__codelineno-28-125">125</a></span>
<span class="normal"><a href="#__codelineno-28-126">126</a></span>
<span class="normal"><a href="#__codelineno-28-127">127</a></span>
<span class="normal"><a href="#__codelineno-28-128">128</a></span>
<span class="normal"><a href="#__codelineno-28-129">129</a></span>
<span class="normal"><a href="#__codelineno-28-130">130</a></span>
<span class="normal"><a href="#__codelineno-28-131">131</a></span>
<span class="normal"><a href="#__codelineno-28-132">132</a></span>
<span class="normal"><a href="#__codelineno-28-133">133</a></span>
<span class="normal"><a href="#__codelineno-28-134">134</a></span>
<span class="normal"><a href="#__codelineno-28-135">135</a></span>
<span class="normal"><a href="#__codelineno-28-136">136</a></span>
<span class="normal"><a href="#__codelineno-28-137">137</a></span>
<span class="normal"><a href="#__codelineno-28-138">138</a></span>
<span class="normal"><a href="#__codelineno-28-139">139</a></span>
<span class="normal"><a href="#__codelineno-28-140">140</a></span>
<span class="normal"><a href="#__codelineno-28-141">141</a></span>
<span class="normal"><a href="#__codelineno-28-142">142</a></span>
<span class="normal"><a href="#__codelineno-28-143">143</a></span>
<span class="normal"><a href="#__codelineno-28-144">144</a></span>
<span class="normal"><a href="#__codelineno-28-145">145</a></span>
<span class="normal"><a href="#__codelineno-28-146">146</a></span>
<span class="normal"><a href="#__codelineno-28-147">147</a></span>
<span class="normal"><a href="#__codelineno-28-148">148</a></span>
<span class="normal"><a href="#__codelineno-28-149">149</a></span>
<span class="normal"><a href="#__codelineno-28-150">150</a></span>
<span class="normal"><a href="#__codelineno-28-151">151</a></span>
<span class="normal"><a href="#__codelineno-28-152">152</a></span>
<span class="normal"><a href="#__codelineno-28-153">153</a></span>
<span class="normal"><a href="#__codelineno-28-154">154</a></span>
<span class="normal"><a href="#__codelineno-28-155">155</a></span>
<span class="normal"><a href="#__codelineno-28-156">156</a></span>
<span class="normal"><a href="#__codelineno-28-157">157</a></span>
<span class="normal"><a href="#__codelineno-28-158">158</a></span>
<span class="normal"><a href="#__codelineno-28-159">159</a></span>
<span class="normal"><a href="#__codelineno-28-160">160</a></span>
<span class="normal"><a href="#__codelineno-28-161">161</a></span>
<span class="normal"><a href="#__codelineno-28-162">162</a></span>
<span class="normal"><a href="#__codelineno-28-163">163</a></span>
<span class="normal"><a href="#__codelineno-28-164">164</a></span>
<span class="normal"><a href="#__codelineno-28-165">165</a></span>
<span class="normal"><a href="#__codelineno-28-166">166</a></span>
<span class="normal"><a href="#__codelineno-28-167">167</a></span>
<span class="normal"><a href="#__codelineno-28-168">168</a></span>
<span class="normal"><a href="#__codelineno-28-169">169</a></span>
<span class="normal"><a href="#__codelineno-28-170">170</a></span>
<span class="normal"><a href="#__codelineno-28-171">171</a></span>
<span class="normal"><a href="#__codelineno-28-172">172</a></span>
<span class="normal"><a href="#__codelineno-28-173">173</a></span>
<span class="normal"><a href="#__codelineno-28-174">174</a></span>
<span class="normal"><a href="#__codelineno-28-175">175</a></span>
<span class="normal"><a href="#__codelineno-28-176">176</a></span>
<span class="normal"><a href="#__codelineno-28-177">177</a></span>
<span class="normal"><a href="#__codelineno-28-178">178</a></span>
<span class="normal"><a href="#__codelineno-28-179">179</a></span>
<span class="normal"><a href="#__codelineno-28-180">180</a></span>
<span class="normal"><a href="#__codelineno-28-181">181</a></span>
<span class="normal"><a href="#__codelineno-28-182">182</a></span>
<span class="normal"><a href="#__codelineno-28-183">183</a></span>
<span class="normal"><a href="#__codelineno-28-184">184</a></span>
<span class="normal"><a href="#__codelineno-28-185">185</a></span>
<span class="normal"><a href="#__codelineno-28-186">186</a></span>
<span class="normal"><a href="#__codelineno-28-187">187</a></span>
<span class="normal"><a href="#__codelineno-28-188">188</a></span>
<span class="normal"><a href="#__codelineno-28-189">189</a></span>
<span class="normal"><a href="#__codelineno-28-190">190</a></span>
<span class="normal"><a href="#__codelineno-28-191">191</a></span>
<span class="normal"><a href="#__codelineno-28-192">192</a></span>
<span class="normal"><a href="#__codelineno-28-193">193</a></span>
<span class="normal"><a href="#__codelineno-28-194">194</a></span>
<span class="normal"><a href="#__codelineno-28-195">195</a></span>
<span class="normal"><a href="#__codelineno-28-196">196</a></span>
<span class="normal"><a href="#__codelineno-28-197">197</a></span>
<span class="normal"><a href="#__codelineno-28-198">198</a></span>
<span class="normal"><a href="#__codelineno-28-199">199</a></span>
<span class="normal"><a href="#__codelineno-28-200">200</a></span>
<span class="normal"><a href="#__codelineno-28-201">201</a></span>
<span class="normal"><a href="#__codelineno-28-202">202</a></span>
<span class="normal"><a href="#__codelineno-28-203">203</a></span>
<span class="normal"><a href="#__codelineno-28-204">204</a></span>
<span class="normal"><a href="#__codelineno-28-205">205</a></span>
<span class="normal"><a href="#__codelineno-28-206">206</a></span>
<span class="normal"><a href="#__codelineno-28-207">207</a></span>
<span class="normal"><a href="#__codelineno-28-208">208</a></span>
<span class="normal"><a href="#__codelineno-28-209">209</a></span>
<span class="normal"><a href="#__codelineno-28-210">210</a></span>
<span class="normal"><a href="#__codelineno-28-211">211</a></span>
<span class="normal"><a href="#__codelineno-28-212">212</a></span>
<span class="normal"><a href="#__codelineno-28-213">213</a></span>
<span class="normal"><a href="#__codelineno-28-214">214</a></span>
<span class="normal"><a href="#__codelineno-28-215">215</a></span>
<span class="normal"><a href="#__codelineno-28-216">216</a></span>
<span class="normal"><a href="#__codelineno-28-217">217</a></span>
<span class="normal"><a href="#__codelineno-28-218">218</a></span>
<span class="normal"><a href="#__codelineno-28-219">219</a></span>
<span class="normal"><a href="#__codelineno-28-220">220</a></span>
<span class="normal"><a href="#__codelineno-28-221">221</a></span>
<span class="normal"><a href="#__codelineno-28-222">222</a></span>
<span class="normal"><a href="#__codelineno-28-223">223</a></span>
<span class="normal"><a href="#__codelineno-28-224">224</a></span>
<span class="normal"><a href="#__codelineno-28-225">225</a></span>
<span class="normal"><a href="#__codelineno-28-226">226</a></span>
<span class="normal"><a href="#__codelineno-28-227">227</a></span>
<span class="normal"><a href="#__codelineno-28-228">228</a></span>
<span class="normal"><a href="#__codelineno-28-229">229</a></span>
<span class="normal"><a href="#__codelineno-28-230">230</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1"></a><span class="cp">#pragma once</span>
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;mutex&gt;</span>
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;fstream&gt;</span>
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;memory&gt;</span>
</span><span id="__span-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5"></a>
</span><span id="__span-28-6"><a id="__codelineno-28-6" name="__codelineno-28-6"></a><span class="c1">// 日志级别</span>
</span><span id="__span-28-7"><a id="__codelineno-28-7" name="__codelineno-28-7"></a><span class="k">enum</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">LogLevel</span>
</span><span id="__span-28-8"><a id="__codelineno-28-8" name="__codelineno-28-8"></a><span class="p">{</span>
</span><span id="__span-28-9"><a id="__codelineno-28-9" name="__codelineno-28-9"></a><span class="w">    </span><span class="n">Debug</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
</span><span id="__span-28-10"><a id="__codelineno-28-10" name="__codelineno-28-10"></a><span class="w">    </span><span class="n">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
</span><span id="__span-28-11"><a id="__codelineno-28-11" name="__codelineno-28-11"></a><span class="w">    </span><span class="n">Warning</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
</span><span id="__span-28-12"><a id="__codelineno-28-12" name="__codelineno-28-12"></a><span class="w">    </span><span class="n">Error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span>
</span><span id="__span-28-13"><a id="__codelineno-28-13" name="__codelineno-28-13"></a><span class="p">};</span>
</span><span id="__span-28-14"><a id="__codelineno-28-14" name="__codelineno-28-14"></a>
</span><span id="__span-28-15"><a id="__codelineno-28-15" name="__codelineno-28-15"></a><span class="c1">// 日志输出目标</span>
</span><span id="__span-28-16"><a id="__codelineno-28-16" name="__codelineno-28-16"></a><span class="k">enum</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">LogTarget</span>
</span><span id="__span-28-17"><a id="__codelineno-28-17" name="__codelineno-28-17"></a><span class="p">{</span>
</span><span id="__span-28-18"><a id="__codelineno-28-18" name="__codelineno-28-18"></a><span class="w">    </span><span class="n">None</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
</span><span id="__span-28-19"><a id="__codelineno-28-19" name="__codelineno-28-19"></a><span class="w">    </span><span class="n">Console</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
</span><span id="__span-28-20"><a id="__codelineno-28-20" name="__codelineno-28-20"></a><span class="w">    </span><span class="n">File</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
</span><span id="__span-28-21"><a id="__codelineno-28-21" name="__codelineno-28-21"></a><span class="w">    </span><span class="n">Both</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w">  </span><span class="c1">// Console | File</span>
</span><span id="__span-28-22"><a id="__codelineno-28-22" name="__codelineno-28-22"></a><span class="p">};</span>
</span><span id="__span-28-23"><a id="__codelineno-28-23" name="__codelineno-28-23"></a>
</span><span id="__span-28-24"><a id="__codelineno-28-24" name="__codelineno-28-24"></a><span class="c1">// 日志配置结构</span>
</span><span id="__span-28-25"><a id="__codelineno-28-25" name="__codelineno-28-25"></a><span class="k">struct</span><span class="w"> </span><span class="nc">LogConfig</span>
</span><span id="__span-28-26"><a id="__codelineno-28-26" name="__codelineno-28-26"></a><span class="p">{</span>
</span><span id="__span-28-27"><a id="__codelineno-28-27" name="__codelineno-28-27"></a><span class="w">    </span><span class="n">LogLevel</span><span class="w">    </span><span class="n">Level</span><span class="p">;</span><span class="w">              </span><span class="c1">// 日志级别</span>
</span><span id="__span-28-28"><a id="__codelineno-28-28" name="__codelineno-28-28"></a><span class="w">    </span><span class="n">LogTarget</span><span class="w">   </span><span class="n">Target</span><span class="p">;</span><span class="w">             </span><span class="c1">// 输出目标</span>
</span><span id="__span-28-29"><a id="__codelineno-28-29" name="__codelineno-28-29"></a><span class="w">    </span><span class="n">CString</span><span class="w">     </span><span class="n">FilePath</span><span class="p">;</span><span class="w">           </span><span class="c1">// 文件路径</span>
</span><span id="__span-28-30"><a id="__codelineno-28-30" name="__codelineno-28-30"></a><span class="w">    </span><span class="kt">bool</span><span class="w">        </span><span class="n">AutoFlush</span><span class="p">;</span><span class="w">          </span><span class="c1">// 是否自动刷新</span>
</span><span id="__span-28-31"><a id="__codelineno-28-31" name="__codelineno-28-31"></a><span class="w">    </span><span class="kt">size_t</span><span class="w">      </span><span class="n">MaxFileSize</span><span class="p">;</span><span class="w">        </span><span class="c1">// 最大文件大小（字节），0表示不限制</span>
</span><span id="__span-28-32"><a id="__codelineno-28-32" name="__codelineno-28-32"></a><span class="w">    </span><span class="kt">int</span><span class="w">         </span><span class="n">MaxBackupFiles</span><span class="p">;</span><span class="w">     </span><span class="c1">// 最大备份文件数</span>
</span><span id="__span-28-33"><a id="__codelineno-28-33" name="__codelineno-28-33"></a><span class="w">    </span><span class="kt">bool</span><span class="w">        </span><span class="n">EnableTimestamp</span><span class="p">;</span><span class="w">    </span><span class="c1">// 是否包含时间戳</span>
</span><span id="__span-28-34"><a id="__codelineno-28-34" name="__codelineno-28-34"></a><span class="w">    </span><span class="kt">bool</span><span class="w">        </span><span class="n">EnableThreadId</span><span class="p">;</span><span class="w">     </span><span class="c1">// 是否包含线程ID</span>
</span><span id="__span-28-35"><a id="__codelineno-28-35" name="__codelineno-28-35"></a><span class="w">    </span><span class="kt">bool</span><span class="w">        </span><span class="n">EnableSourceInfo</span><span class="p">;</span><span class="w">   </span><span class="c1">// 是否包含源文件信息（预留）</span>
</span><span id="__span-28-36"><a id="__codelineno-28-36" name="__codelineno-28-36"></a>
</span><span id="__span-28-37"><a id="__codelineno-28-37" name="__codelineno-28-37"></a><span class="w">    </span><span class="n">LogConfig</span><span class="p">()</span>
</span><span id="__span-28-38"><a id="__codelineno-28-38" name="__codelineno-28-38"></a><span class="w">        </span><span class="o">:</span><span class="w"> </span><span class="n">Level</span><span class="p">(</span><span class="n">LogLevel</span><span class="o">::</span><span class="n">Info</span><span class="p">)</span>
</span><span id="__span-28-39"><a id="__codelineno-28-39" name="__codelineno-28-39"></a><span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="n">Target</span><span class="p">(</span><span class="n">LogTarget</span><span class="o">::</span><span class="n">Both</span><span class="p">)</span>
</span><span id="__span-28-40"><a id="__codelineno-28-40" name="__codelineno-28-40"></a><span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="n">AutoFlush</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>
</span><span id="__span-28-41"><a id="__codelineno-28-41" name="__codelineno-28-41"></a><span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="n">MaxFileSize</span><span class="p">(</span><span class="mi">10</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024</span><span class="p">)</span><span class="w">  </span><span class="c1">// 默认10MB</span>
</span><span id="__span-28-42"><a id="__codelineno-28-42" name="__codelineno-28-42"></a><span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="n">MaxBackupFiles</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span><span id="__span-28-43"><a id="__codelineno-28-43" name="__codelineno-28-43"></a><span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="n">EnableTimestamp</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>
</span><span id="__span-28-44"><a id="__codelineno-28-44" name="__codelineno-28-44"></a><span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="n">EnableThreadId</span><span class="p">(</span><span class="nb">false</span><span class="p">)</span>
</span><span id="__span-28-45"><a id="__codelineno-28-45" name="__codelineno-28-45"></a><span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="n">EnableSourceInfo</span><span class="p">(</span><span class="nb">false</span><span class="p">)</span>
</span><span id="__span-28-46"><a id="__codelineno-28-46" name="__codelineno-28-46"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-28-47"><a id="__codelineno-28-47" name="__codelineno-28-47"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-28-48"><a id="__codelineno-28-48" name="__codelineno-28-48"></a><span class="p">};</span>
</span><span id="__span-28-49"><a id="__codelineno-28-49" name="__codelineno-28-49"></a>
</span><span id="__span-28-50"><a id="__codelineno-28-50" name="__codelineno-28-50"></a><span class="c1">// 矿山符号日志记录器</span>
</span><span id="__span-28-51"><a id="__codelineno-28-51" name="__codelineno-28-51"></a><span class="k">class</span><span class="w"> </span><span class="nc">CMineSymbolLogger</span>
</span><span id="__span-28-52"><a id="__codelineno-28-52" name="__codelineno-28-52"></a><span class="p">{</span>
</span><span id="__span-28-53"><a id="__codelineno-28-53" name="__codelineno-28-53"></a><span class="k">public</span><span class="o">:</span>
</span><span id="__span-28-54"><a id="__codelineno-28-54" name="__codelineno-28-54"></a><span class="w">    </span><span class="c1">// 获取单例</span>
</span><span id="__span-28-55"><a id="__codelineno-28-55" name="__codelineno-28-55"></a><span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="n">CMineSymbolLogger</span><span class="o">&amp;</span><span class="w"> </span><span class="n">GetInstance</span><span class="p">();</span>
</span><span id="__span-28-56"><a id="__codelineno-28-56" name="__codelineno-28-56"></a>
</span><span id="__span-28-57"><a id="__codelineno-28-57" name="__codelineno-28-57"></a><span class="w">    </span><span class="c1">// ========== 初始化接口（新增）==========</span>
</span><span id="__span-28-58"><a id="__codelineno-28-58" name="__codelineno-28-58"></a>
</span><span id="__span-28-59"><a id="__codelineno-28-59" name="__codelineno-28-59"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-28-60"><a id="__codelineno-28-60" name="__codelineno-28-60"></a><span class="cm">     * @brief 初始化日志系统（推荐使用）</span>
</span><span id="__span-28-61"><a id="__codelineno-28-61" name="__codelineno-28-61"></a><span class="cm">     * @param config 日志配置</span>
</span><span id="__span-28-62"><a id="__codelineno-28-62" name="__codelineno-28-62"></a><span class="cm">     * @return 是否初始化成功</span>
</span><span id="__span-28-63"><a id="__codelineno-28-63" name="__codelineno-28-63"></a><span class="cm">     */</span>
</span><span id="__span-28-64"><a id="__codelineno-28-64" name="__codelineno-28-64"></a><span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="nf">Initialize</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">LogConfig</span><span class="o">&amp;</span><span class="w"> </span><span class="n">config</span><span class="p">);</span>
</span><span id="__span-28-65"><a id="__codelineno-28-65" name="__codelineno-28-65"></a>
</span><span id="__span-28-66"><a id="__codelineno-28-66" name="__codelineno-28-66"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-28-67"><a id="__codelineno-28-67" name="__codelineno-28-67"></a><span class="cm">     * @brief 快速初始化（便捷方法）</span>
</span><span id="__span-28-68"><a id="__codelineno-28-68" name="__codelineno-28-68"></a><span class="cm">     * @param logFilePath 日志文件路径</span>
</span><span id="__span-28-69"><a id="__codelineno-28-69" name="__codelineno-28-69"></a><span class="cm">     * @param level 日志级别</span>
</span><span id="__span-28-70"><a id="__codelineno-28-70" name="__codelineno-28-70"></a><span class="cm">     * @param target 输出目标</span>
</span><span id="__span-28-71"><a id="__codelineno-28-71" name="__codelineno-28-71"></a><span class="cm">     * @return 是否初始化成功</span>
</span><span id="__span-28-72"><a id="__codelineno-28-72" name="__codelineno-28-72"></a><span class="cm">     */</span>
</span><span id="__span-28-73"><a id="__codelineno-28-73" name="__codelineno-28-73"></a><span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="nf">Initialize</span><span class="p">(</span>
</span><span id="__span-28-74"><a id="__codelineno-28-74" name="__codelineno-28-74"></a><span class="w">        </span><span class="k">const</span><span class="w"> </span><span class="n">CString</span><span class="o">&amp;</span><span class="w"> </span><span class="n">logFilePath</span><span class="p">,</span>
</span><span id="__span-28-75"><a id="__codelineno-28-75" name="__codelineno-28-75"></a><span class="w">        </span><span class="n">LogLevel</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LogLevel</span><span class="o">::</span><span class="n">Info</span><span class="p">,</span>
</span><span id="__span-28-76"><a id="__codelineno-28-76" name="__codelineno-28-76"></a><span class="w">        </span><span class="n">LogTarget</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LogTarget</span><span class="o">::</span><span class="n">Both</span><span class="p">);</span>
</span><span id="__span-28-77"><a id="__codelineno-28-77" name="__codelineno-28-77"></a>
</span><span id="__span-28-78"><a id="__codelineno-28-78" name="__codelineno-28-78"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-28-79"><a id="__codelineno-28-79" name="__codelineno-28-79"></a><span class="cm">     * @brief 检查是否已初始化</span>
</span><span id="__span-28-80"><a id="__codelineno-28-80" name="__codelineno-28-80"></a><span class="cm">     */</span>
</span><span id="__span-28-81"><a id="__codelineno-28-81" name="__codelineno-28-81"></a><span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="nf">IsInitialized</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">m_initialized</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-28-82"><a id="__codelineno-28-82" name="__codelineno-28-82"></a>
</span><span id="__span-28-83"><a id="__codelineno-28-83" name="__codelineno-28-83"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-28-84"><a id="__codelineno-28-84" name="__codelineno-28-84"></a><span class="cm">     * @brief 关闭日志系统并刷新缓冲</span>
</span><span id="__span-28-85"><a id="__codelineno-28-85" name="__codelineno-28-85"></a><span class="cm">     */</span>
</span><span id="__span-28-86"><a id="__codelineno-28-86" name="__codelineno-28-86"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">Shutdown</span><span class="p">();</span>
</span><span id="__span-28-87"><a id="__codelineno-28-87" name="__codelineno-28-87"></a>
</span><span id="__span-28-88"><a id="__codelineno-28-88" name="__codelineno-28-88"></a><span class="w">    </span><span class="c1">// ========== 日志级别设置 ==========</span>
</span><span id="__span-28-89"><a id="__codelineno-28-89" name="__codelineno-28-89"></a>
</span><span id="__span-28-90"><a id="__codelineno-28-90" name="__codelineno-28-90"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">SetLogLevel</span><span class="p">(</span><span class="n">LogLevel</span><span class="w"> </span><span class="n">level</span><span class="p">);</span>
</span><span id="__span-28-91"><a id="__codelineno-28-91" name="__codelineno-28-91"></a><span class="w">    </span><span class="n">LogLevel</span><span class="w"> </span><span class="nf">GetLogLevel</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">m_logLevel</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-28-92"><a id="__codelineno-28-92" name="__codelineno-28-92"></a>
</span><span id="__span-28-93"><a id="__codelineno-28-93" name="__codelineno-28-93"></a><span class="w">    </span><span class="c1">// ========== 日志记录接口 ==========</span>
</span><span id="__span-28-94"><a id="__codelineno-28-94" name="__codelineno-28-94"></a>
</span><span id="__span-28-95"><a id="__codelineno-28-95" name="__codelineno-28-95"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">Debug</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CString</span><span class="o">&amp;</span><span class="w"> </span><span class="n">message</span><span class="p">);</span>
</span><span id="__span-28-96"><a id="__codelineno-28-96" name="__codelineno-28-96"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">Info</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CString</span><span class="o">&amp;</span><span class="w"> </span><span class="n">message</span><span class="p">);</span>
</span><span id="__span-28-97"><a id="__codelineno-28-97" name="__codelineno-28-97"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">Warning</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CString</span><span class="o">&amp;</span><span class="w"> </span><span class="n">message</span><span class="p">);</span>
</span><span id="__span-28-98"><a id="__codelineno-28-98" name="__codelineno-28-98"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">Error</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CString</span><span class="o">&amp;</span><span class="w"> </span><span class="n">message</span><span class="p">);</span>
</span><span id="__span-28-99"><a id="__codelineno-28-99" name="__codelineno-28-99"></a>
</span><span id="__span-28-100"><a id="__codelineno-28-100" name="__codelineno-28-100"></a><span class="w">    </span><span class="c1">// 格式化日志</span>
</span><span id="__span-28-101"><a id="__codelineno-28-101" name="__codelineno-28-101"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">DebugFormat</span><span class="p">(</span><span class="n">LPCTSTR</span><span class="w"> </span><span class="n">format</span><span class="p">,</span><span class="w"> </span><span class="p">...);</span>
</span><span id="__span-28-102"><a id="__codelineno-28-102" name="__codelineno-28-102"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">InfoFormat</span><span class="p">(</span><span class="n">LPCTSTR</span><span class="w"> </span><span class="n">format</span><span class="p">,</span><span class="w"> </span><span class="p">...);</span>
</span><span id="__span-28-103"><a id="__codelineno-28-103" name="__codelineno-28-103"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">WarningFormat</span><span class="p">(</span><span class="n">LPCTSTR</span><span class="w"> </span><span class="n">format</span><span class="p">,</span><span class="w"> </span><span class="p">...);</span>
</span><span id="__span-28-104"><a id="__codelineno-28-104" name="__codelineno-28-104"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">ErrorFormat</span><span class="p">(</span><span class="n">LPCTSTR</span><span class="w"> </span><span class="n">format</span><span class="p">,</span><span class="w"> </span><span class="p">...);</span>
</span><span id="__span-28-105"><a id="__codelineno-28-105" name="__codelineno-28-105"></a>
</span><span id="__span-28-106"><a id="__codelineno-28-106" name="__codelineno-28-106"></a><span class="w">    </span><span class="c1">// ========== 输出控制（兼容旧接口）==========</span>
</span><span id="__span-28-107"><a id="__codelineno-28-107" name="__codelineno-28-107"></a>
</span><span id="__span-28-108"><a id="__codelineno-28-108" name="__codelineno-28-108"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">EnableConsoleOutput</span><span class="p">(</span><span class="kt">bool</span><span class="w"> </span><span class="n">enable</span><span class="p">);</span>
</span><span id="__span-28-109"><a id="__codelineno-28-109" name="__codelineno-28-109"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="n">EnableFileOutput</span><span class="p">(</span><span class="kt">bool</span><span class="w"> </span><span class="n">enable</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">CString</span><span class="o">&amp;</span><span class="w"> </span><span class="n">filePath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_T</span><span class="p">(</span><span class="s">""</span><span class="p">));</span>
</span><span id="__span-28-110"><a id="__codelineno-28-110" name="__codelineno-28-110"></a>
</span><span id="__span-28-111"><a id="__codelineno-28-111" name="__codelineno-28-111"></a><span class="w">    </span><span class="c1">// 新增：设置输出目标</span>
</span><span id="__span-28-112"><a id="__codelineno-28-112" name="__codelineno-28-112"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">SetLogTarget</span><span class="p">(</span><span class="n">LogTarget</span><span class="w"> </span><span class="n">target</span><span class="p">);</span>
</span><span id="__span-28-113"><a id="__codelineno-28-113" name="__codelineno-28-113"></a>
</span><span id="__span-28-114"><a id="__codelineno-28-114" name="__codelineno-28-114"></a><span class="w">    </span><span class="c1">// 新增：手动刷新缓冲</span>
</span><span id="__span-28-115"><a id="__codelineno-28-115" name="__codelineno-28-115"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">Flush</span><span class="p">();</span>
</span><span id="__span-28-116"><a id="__codelineno-28-116" name="__codelineno-28-116"></a>
</span><span id="__span-28-117"><a id="__codelineno-28-117" name="__codelineno-28-117"></a><span class="w">    </span><span class="c1">// ========== 文件管理 ==========</span>
</span><span id="__span-28-118"><a id="__codelineno-28-118" name="__codelineno-28-118"></a>
</span><span id="__span-28-119"><a id="__codelineno-28-119" name="__codelineno-28-119"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-28-120"><a id="__codelineno-28-120" name="__codelineno-28-120"></a><span class="cm">     * @brief 设置文件大小限制</span>
</span><span id="__span-28-121"><a id="__codelineno-28-121" name="__codelineno-28-121"></a><span class="cm">     * @param maxSize 最大文件大小（字节），0表示不限制</span>
</span><span id="__span-28-122"><a id="__codelineno-28-122" name="__codelineno-28-122"></a><span class="cm">     */</span>
</span><span id="__span-28-123"><a id="__codelineno-28-123" name="__codelineno-28-123"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">SetMaxFileSize</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">maxSize</span><span class="p">);</span>
</span><span id="__span-28-124"><a id="__codelineno-28-124" name="__codelineno-28-124"></a>
</span><span id="__span-28-125"><a id="__codelineno-28-125" name="__codelineno-28-125"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-28-126"><a id="__codelineno-28-126" name="__codelineno-28-126"></a><span class="cm">     * @brief 设置最大备份文件数</span>
</span><span id="__span-28-127"><a id="__codelineno-28-127" name="__codelineno-28-127"></a><span class="cm">     */</span>
</span><span id="__span-28-128"><a id="__codelineno-28-128" name="__codelineno-28-128"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">SetMaxBackupFiles</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">maxFiles</span><span class="p">);</span>
</span><span id="__span-28-129"><a id="__codelineno-28-129" name="__codelineno-28-129"></a>
</span><span id="__span-28-130"><a id="__codelineno-28-130" name="__codelineno-28-130"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-28-131"><a id="__codelineno-28-131" name="__codelineno-28-131"></a><span class="cm">     * @brief 立即执行日志轮转</span>
</span><span id="__span-28-132"><a id="__codelineno-28-132" name="__codelineno-28-132"></a><span class="cm">     */</span>
</span><span id="__span-28-133"><a id="__codelineno-28-133" name="__codelineno-28-133"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">RotateLogFile</span><span class="p">();</span>
</span><span id="__span-28-134"><a id="__codelineno-28-134" name="__codelineno-28-134"></a>
</span><span id="__span-28-135"><a id="__codelineno-28-135" name="__codelineno-28-135"></a><span class="w">    </span><span class="c1">// ========== 其他设置 ==========</span>
</span><span id="__span-28-136"><a id="__codelineno-28-136" name="__codelineno-28-136"></a>
</span><span id="__span-28-137"><a id="__codelineno-28-137" name="__codelineno-28-137"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">EnableAutoFlush</span><span class="p">(</span><span class="kt">bool</span><span class="w"> </span><span class="n">enable</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">m_autoFlush</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">enable</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-28-138"><a id="__codelineno-28-138" name="__codelineno-28-138"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">EnableTimestamp</span><span class="p">(</span><span class="kt">bool</span><span class="w"> </span><span class="n">enable</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">m_enableTimestamp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">enable</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-28-139"><a id="__codelineno-28-139" name="__codelineno-28-139"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">EnableThreadId</span><span class="p">(</span><span class="kt">bool</span><span class="w"> </span><span class="n">enable</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">m_enableThreadId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">enable</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-28-140"><a id="__codelineno-28-140" name="__codelineno-28-140"></a>
</span><span id="__span-28-141"><a id="__codelineno-28-141" name="__codelineno-28-141"></a><span class="k">private</span><span class="o">:</span>
</span><span id="__span-28-142"><a id="__codelineno-28-142" name="__codelineno-28-142"></a><span class="w">    </span><span class="n">CMineSymbolLogger</span><span class="p">();</span>
</span><span id="__span-28-143"><a id="__codelineno-28-143" name="__codelineno-28-143"></a><span class="w">    </span><span class="o">~</span><span class="n">CMineSymbolLogger</span><span class="p">();</span>
</span><span id="__span-28-144"><a id="__codelineno-28-144" name="__codelineno-28-144"></a>
</span><span id="__span-28-145"><a id="__codelineno-28-145" name="__codelineno-28-145"></a><span class="w">    </span><span class="c1">// 禁止拷贝</span>
</span><span id="__span-28-146"><a id="__codelineno-28-146" name="__codelineno-28-146"></a><span class="w">    </span><span class="n">CMineSymbolLogger</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CMineSymbolLogger</span><span class="o">&amp;</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">delete</span><span class="p">;</span>
</span><span id="__span-28-147"><a id="__codelineno-28-147" name="__codelineno-28-147"></a><span class="w">    </span><span class="n">CMineSymbolLogger</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CMineSymbolLogger</span><span class="o">&amp;</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">delete</span><span class="p">;</span>
</span><span id="__span-28-148"><a id="__codelineno-28-148" name="__codelineno-28-148"></a>
</span><span id="__span-28-149"><a id="__codelineno-28-149" name="__codelineno-28-149"></a><span class="w">    </span><span class="c1">// ========== 内部方法 ==========</span>
</span><span id="__span-28-150"><a id="__codelineno-28-150" name="__codelineno-28-150"></a>
</span><span id="__span-28-151"><a id="__codelineno-28-151" name="__codelineno-28-151"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">Log</span><span class="p">(</span><span class="n">LogLevel</span><span class="w"> </span><span class="n">level</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">CString</span><span class="o">&amp;</span><span class="w"> </span><span class="n">message</span><span class="p">);</span>
</span><span id="__span-28-152"><a id="__codelineno-28-152" name="__codelineno-28-152"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">LogInternal</span><span class="p">(</span><span class="n">LogLevel</span><span class="w"> </span><span class="n">level</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">CString</span><span class="o">&amp;</span><span class="w"> </span><span class="n">message</span><span class="p">);</span><span class="w">  </span><span class="c1">// 内部版本，不加锁</span>
</span><span id="__span-28-153"><a id="__codelineno-28-153" name="__codelineno-28-153"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">WriteToConsole</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CString</span><span class="o">&amp;</span><span class="w"> </span><span class="n">message</span><span class="p">);</span>
</span><span id="__span-28-154"><a id="__codelineno-28-154" name="__codelineno-28-154"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">WriteToFile</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CString</span><span class="o">&amp;</span><span class="w"> </span><span class="n">message</span><span class="p">);</span>
</span><span id="__span-28-155"><a id="__codelineno-28-155" name="__codelineno-28-155"></a><span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="nf">OpenLogFile</span><span class="p">();</span>
</span><span id="__span-28-156"><a id="__codelineno-28-156" name="__codelineno-28-156"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">CloseLogFile</span><span class="p">();</span>
</span><span id="__span-28-157"><a id="__codelineno-28-157" name="__codelineno-28-157"></a><span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="nf">CheckAndRotateFile</span><span class="p">();</span>
</span><span id="__span-28-158"><a id="__codelineno-28-158" name="__codelineno-28-158"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">RotateBackupFiles</span><span class="p">();</span>
</span><span id="__span-28-159"><a id="__codelineno-28-159" name="__codelineno-28-159"></a>
</span><span id="__span-28-160"><a id="__codelineno-28-160" name="__codelineno-28-160"></a><span class="w">    </span><span class="n">CString</span><span class="w"> </span><span class="nf">FormatMessage</span><span class="p">(</span><span class="n">LogLevel</span><span class="w"> </span><span class="n">level</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">CString</span><span class="o">&amp;</span><span class="w"> </span><span class="n">message</span><span class="p">);</span>
</span><span id="__span-28-161"><a id="__codelineno-28-161" name="__codelineno-28-161"></a><span class="w">    </span><span class="n">CString</span><span class="w"> </span><span class="nf">GetLevelString</span><span class="p">(</span><span class="n">LogLevel</span><span class="w"> </span><span class="n">level</span><span class="p">);</span>
</span><span id="__span-28-162"><a id="__codelineno-28-162" name="__codelineno-28-162"></a><span class="w">    </span><span class="n">CString</span><span class="w"> </span><span class="nf">GetTimestamp</span><span class="p">();</span>
</span><span id="__span-28-163"><a id="__codelineno-28-163" name="__codelineno-28-163"></a><span class="w">    </span><span class="n">CString</span><span class="w"> </span><span class="nf">GetThreadId</span><span class="p">();</span>
</span><span id="__span-28-164"><a id="__codelineno-28-164" name="__codelineno-28-164"></a>
</span><span id="__span-28-165"><a id="__codelineno-28-165" name="__codelineno-28-165"></a><span class="k">private</span><span class="o">:</span>
</span><span id="__span-28-166"><a id="__codelineno-28-166" name="__codelineno-28-166"></a><span class="w">    </span><span class="c1">// 初始化状态</span>
</span><span id="__span-28-167"><a id="__codelineno-28-167" name="__codelineno-28-167"></a><span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">m_initialized</span><span class="p">;</span>
</span><span id="__span-28-168"><a id="__codelineno-28-168" name="__codelineno-28-168"></a>
</span><span id="__span-28-169"><a id="__codelineno-28-169" name="__codelineno-28-169"></a><span class="w">    </span><span class="c1">// 日志配置</span>
</span><span id="__span-28-170"><a id="__codelineno-28-170" name="__codelineno-28-170"></a><span class="w">    </span><span class="n">LogLevel</span><span class="w"> </span><span class="n">m_logLevel</span><span class="p">;</span>
</span><span id="__span-28-171"><a id="__codelineno-28-171" name="__codelineno-28-171"></a><span class="w">    </span><span class="n">LogTarget</span><span class="w"> </span><span class="n">m_logTarget</span><span class="p">;</span>
</span><span id="__span-28-172"><a id="__codelineno-28-172" name="__codelineno-28-172"></a><span class="w">    </span><span class="n">CString</span><span class="w"> </span><span class="n">m_logFilePath</span><span class="p">;</span>
</span><span id="__span-28-173"><a id="__codelineno-28-173" name="__codelineno-28-173"></a><span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">m_autoFlush</span><span class="p">;</span>
</span><span id="__span-28-174"><a id="__codelineno-28-174" name="__codelineno-28-174"></a><span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">m_maxFileSize</span><span class="p">;</span>
</span><span id="__span-28-175"><a id="__codelineno-28-175" name="__codelineno-28-175"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">m_maxBackupFiles</span><span class="p">;</span>
</span><span id="__span-28-176"><a id="__codelineno-28-176" name="__codelineno-28-176"></a>
</span><span id="__span-28-177"><a id="__codelineno-28-177" name="__codelineno-28-177"></a><span class="w">    </span><span class="c1">// 格式选项</span>
</span><span id="__span-28-178"><a id="__codelineno-28-178" name="__codelineno-28-178"></a><span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">m_enableTimestamp</span><span class="p">;</span>
</span><span id="__span-28-179"><a id="__codelineno-28-179" name="__codelineno-28-179"></a><span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">m_enableThreadId</span><span class="p">;</span>
</span><span id="__span-28-180"><a id="__codelineno-28-180" name="__codelineno-28-180"></a>
</span><span id="__span-28-181"><a id="__codelineno-28-181" name="__codelineno-28-181"></a><span class="w">    </span><span class="c1">// 文件输出</span>
</span><span id="__span-28-182"><a id="__codelineno-28-182" name="__codelineno-28-182"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">wofstream</span><span class="w"> </span><span class="n">m_logFile</span><span class="p">;</span>
</span><span id="__span-28-183"><a id="__codelineno-28-183" name="__codelineno-28-183"></a><span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">m_fileOpened</span><span class="p">;</span>
</span><span id="__span-28-184"><a id="__codelineno-28-184" name="__codelineno-28-184"></a>
</span><span id="__span-28-185"><a id="__codelineno-28-185" name="__codelineno-28-185"></a><span class="w">    </span><span class="c1">// 线程安全</span>
</span><span id="__span-28-186"><a id="__codelineno-28-186" name="__codelineno-28-186"></a><span class="w">    </span><span class="k">mutable</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">mutex</span><span class="w"> </span><span class="n">m_mutex</span><span class="p">;</span>
</span><span id="__span-28-187"><a id="__codelineno-28-187" name="__codelineno-28-187"></a>
</span><span id="__span-28-188"><a id="__codelineno-28-188" name="__codelineno-28-188"></a><span class="w">    </span><span class="c1">// 兼容旧接口</span>
</span><span id="__span-28-189"><a id="__codelineno-28-189" name="__codelineno-28-189"></a><span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">m_consoleOutput</span><span class="p">;</span>
</span><span id="__span-28-190"><a id="__codelineno-28-190" name="__codelineno-28-190"></a><span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">m_fileOutput</span><span class="p">;</span>
</span><span id="__span-28-191"><a id="__codelineno-28-191" name="__codelineno-28-191"></a><span class="p">};</span>
</span><span id="__span-28-192"><a id="__codelineno-28-192" name="__codelineno-28-192"></a>
</span><span id="__span-28-193"><a id="__codelineno-28-193" name="__codelineno-28-193"></a><span class="c1">// ========== 便捷宏定义 ==========</span>
</span><span id="__span-28-194"><a id="__codelineno-28-194" name="__codelineno-28-194"></a>
</span><span id="__span-28-195"><a id="__codelineno-28-195" name="__codelineno-28-195"></a><span class="cp">#define LOG_DEBUG(msg)    CMineSymbolLogger::GetInstance().Debug(msg)</span>
</span><span id="__span-28-196"><a id="__codelineno-28-196" name="__codelineno-28-196"></a><span class="cp">#define LOG_INFO(msg)     CMineSymbolLogger::GetInstance().Info(msg)</span>
</span><span id="__span-28-197"><a id="__codelineno-28-197" name="__codelineno-28-197"></a><span class="cp">#define LOG_WARNING(msg)  CMineSymbolLogger::GetInstance().Warning(msg)</span>
</span><span id="__span-28-198"><a id="__codelineno-28-198" name="__codelineno-28-198"></a><span class="cp">#define LOG_ERROR(msg)    CMineSymbolLogger::GetInstance().Error(msg)</span>
</span><span id="__span-28-199"><a id="__codelineno-28-199" name="__codelineno-28-199"></a>
</span><span id="__span-28-200"><a id="__codelineno-28-200" name="__codelineno-28-200"></a><span class="cp">#define LOG_DEBUG_F(fmt, ...)   CMineSymbolLogger::GetInstance().DebugFormat(fmt, __VA_ARGS__)</span>
</span><span id="__span-28-201"><a id="__codelineno-28-201" name="__codelineno-28-201"></a><span class="cp">#define LOG_INFO_F(fmt, ...)    CMineSymbolLogger::GetInstance().InfoFormat(fmt, __VA_ARGS__)</span>
</span><span id="__span-28-202"><a id="__codelineno-28-202" name="__codelineno-28-202"></a><span class="cp">#define LOG_WARNING_F(fmt, ...) CMineSymbolLogger::GetInstance().WarningFormat(fmt, __VA_ARGS__)</span>
</span><span id="__span-28-203"><a id="__codelineno-28-203" name="__codelineno-28-203"></a><span class="cp">#define LOG_ERROR_F(fmt, ...)   CMineSymbolLogger::GetInstance().ErrorFormat(fmt, __VA_ARGS__)</span>
</span><span id="__span-28-204"><a id="__codelineno-28-204" name="__codelineno-28-204"></a>
</span><span id="__span-28-205"><a id="__codelineno-28-205" name="__codelineno-28-205"></a><span class="c1">// ========== 初始化宏（便于项目复用）==========</span>
</span><span id="__span-28-206"><a id="__codelineno-28-206" name="__codelineno-28-206"></a>
</span><span id="__span-28-207"><a id="__codelineno-28-207" name="__codelineno-28-207"></a><span class="cm">/**</span>
</span><span id="__span-28-208"><a id="__codelineno-28-208" name="__codelineno-28-208"></a><span class="cm"> * 快速初始化日志系统的宏</span>
</span><span id="__span-28-209"><a id="__codelineno-28-209" name="__codelineno-28-209"></a><span class="cm"> * 用法：LOG_INIT(_T("C:\\Logs\\app.log"), LogLevel::Info)</span>
</span><span id="__span-28-210"><a id="__codelineno-28-210" name="__codelineno-28-210"></a><span class="cm"> */</span>
</span><span id="__span-28-211"><a id="__codelineno-28-211" name="__codelineno-28-211"></a><span class="cp">#define LOG_INIT(filepath, level) \</span>
</span><span id="__span-28-212"><a id="__codelineno-28-212" name="__codelineno-28-212"></a><span class="cp">    CMineSymbolLogger::GetInstance().Initialize(filepath, level, LogTarget::Both)</span>
</span><span id="__span-28-213"><a id="__codelineno-28-213" name="__codelineno-28-213"></a>
</span><span id="__span-28-214"><a id="__codelineno-28-214" name="__codelineno-28-214"></a><span class="cm">/**</span>
</span><span id="__span-28-215"><a id="__codelineno-28-215" name="__codelineno-28-215"></a><span class="cm"> * 仅文件输出的初始化</span>
</span><span id="__span-28-216"><a id="__codelineno-28-216" name="__codelineno-28-216"></a><span class="cm"> */</span>
</span><span id="__span-28-217"><a id="__codelineno-28-217" name="__codelineno-28-217"></a><span class="cp">#define LOG_INIT_FILE_ONLY(filepath, level) \</span>
</span><span id="__span-28-218"><a id="__codelineno-28-218" name="__codelineno-28-218"></a><span class="cp">    CMineSymbolLogger::GetInstance().Initialize(filepath, level, LogTarget::File)</span>
</span><span id="__span-28-219"><a id="__codelineno-28-219" name="__codelineno-28-219"></a>
</span><span id="__span-28-220"><a id="__codelineno-28-220" name="__codelineno-28-220"></a><span class="cm">/**</span>
</span><span id="__span-28-221"><a id="__codelineno-28-221" name="__codelineno-28-221"></a><span class="cm"> * 仅控制台输出的初始化</span>
</span><span id="__span-28-222"><a id="__codelineno-28-222" name="__codelineno-28-222"></a><span class="cm"> */</span>
</span><span id="__span-28-223"><a id="__codelineno-28-223" name="__codelineno-28-223"></a><span class="cp">#define LOG_INIT_CONSOLE_ONLY(level) \</span>
</span><span id="__span-28-224"><a id="__codelineno-28-224" name="__codelineno-28-224"></a><span class="cp">    CMineSymbolLogger::GetInstance().Initialize(_T(""), level, LogTarget::Console)</span>
</span><span id="__span-28-225"><a id="__codelineno-28-225" name="__codelineno-28-225"></a>
</span><span id="__span-28-226"><a id="__codelineno-28-226" name="__codelineno-28-226"></a><span class="cm">/**</span>
</span><span id="__span-28-227"><a id="__codelineno-28-227" name="__codelineno-28-227"></a><span class="cm"> * 关闭日志系统</span>
</span><span id="__span-28-228"><a id="__codelineno-28-228" name="__codelineno-28-228"></a><span class="cm"> */</span>
</span><span id="__span-28-229"><a id="__codelineno-28-229" name="__codelineno-28-229"></a><span class="cp">#define LOG_SHUTDOWN() \</span>
</span><span id="__span-28-230"><a id="__codelineno-28-230" name="__codelineno-28-230"></a><span class="cp">    CMineSymbolLogger::GetInstance().Shutdown()</span>
</span></code></pre></div></td></tr></tbody></table></div> <p><code>CMineSymbolLogger.cpp</code></p> <div class="language-cpp highlight"><table class="highlighttable"><tbody><tr><th colspan="2" class="filename"><span class="filename">C++</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-29-1">  1</a></span>
<span class="normal"><a href="#__codelineno-29-2">  2</a></span>
<span class="normal"><a href="#__codelineno-29-3">  3</a></span>
<span class="normal"><a href="#__codelineno-29-4">  4</a></span>
<span class="normal"><a href="#__codelineno-29-5">  5</a></span>
<span class="normal"><a href="#__codelineno-29-6">  6</a></span>
<span class="normal"><a href="#__codelineno-29-7">  7</a></span>
<span class="normal"><a href="#__codelineno-29-8">  8</a></span>
<span class="normal"><a href="#__codelineno-29-9">  9</a></span>
<span class="normal"><a href="#__codelineno-29-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-29-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-29-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-29-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-29-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-29-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-29-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-29-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-29-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-29-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-29-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-29-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-29-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-29-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-29-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-29-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-29-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-29-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-29-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-29-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-29-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-29-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-29-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-29-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-29-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-29-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-29-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-29-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-29-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-29-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-29-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-29-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-29-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-29-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-29-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-29-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-29-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-29-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-29-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-29-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-29-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-29-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-29-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-29-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-29-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-29-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-29-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-29-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-29-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-29-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-29-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-29-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-29-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-29-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-29-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-29-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-29-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-29-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-29-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-29-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-29-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-29-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-29-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-29-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-29-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-29-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-29-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-29-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-29-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-29-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-29-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-29-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-29-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-29-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-29-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-29-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-29-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-29-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-29-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-29-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-29-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-29-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-29-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-29-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-29-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-29-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-29-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-29-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-29-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-29-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-29-100">100</a></span>
<span class="normal"><a href="#__codelineno-29-101">101</a></span>
<span class="normal"><a href="#__codelineno-29-102">102</a></span>
<span class="normal"><a href="#__codelineno-29-103">103</a></span>
<span class="normal"><a href="#__codelineno-29-104">104</a></span>
<span class="normal"><a href="#__codelineno-29-105">105</a></span>
<span class="normal"><a href="#__codelineno-29-106">106</a></span>
<span class="normal"><a href="#__codelineno-29-107">107</a></span>
<span class="normal"><a href="#__codelineno-29-108">108</a></span>
<span class="normal"><a href="#__codelineno-29-109">109</a></span>
<span class="normal"><a href="#__codelineno-29-110">110</a></span>
<span class="normal"><a href="#__codelineno-29-111">111</a></span>
<span class="normal"><a href="#__codelineno-29-112">112</a></span>
<span class="normal"><a href="#__codelineno-29-113">113</a></span>
<span class="normal"><a href="#__codelineno-29-114">114</a></span>
<span class="normal"><a href="#__codelineno-29-115">115</a></span>
<span class="normal"><a href="#__codelineno-29-116">116</a></span>
<span class="normal"><a href="#__codelineno-29-117">117</a></span>
<span class="normal"><a href="#__codelineno-29-118">118</a></span>
<span class="normal"><a href="#__codelineno-29-119">119</a></span>
<span class="normal"><a href="#__codelineno-29-120">120</a></span>
<span class="normal"><a href="#__codelineno-29-121">121</a></span>
<span class="normal"><a href="#__codelineno-29-122">122</a></span>
<span class="normal"><a href="#__codelineno-29-123">123</a></span>
<span class="normal"><a href="#__codelineno-29-124">124</a></span>
<span class="normal"><a href="#__codelineno-29-125">125</a></span>
<span class="normal"><a href="#__codelineno-29-126">126</a></span>
<span class="normal"><a href="#__codelineno-29-127">127</a></span>
<span class="normal"><a href="#__codelineno-29-128">128</a></span>
<span class="normal"><a href="#__codelineno-29-129">129</a></span>
<span class="normal"><a href="#__codelineno-29-130">130</a></span>
<span class="normal"><a href="#__codelineno-29-131">131</a></span>
<span class="normal"><a href="#__codelineno-29-132">132</a></span>
<span class="normal"><a href="#__codelineno-29-133">133</a></span>
<span class="normal"><a href="#__codelineno-29-134">134</a></span>
<span class="normal"><a href="#__codelineno-29-135">135</a></span>
<span class="normal"><a href="#__codelineno-29-136">136</a></span>
<span class="normal"><a href="#__codelineno-29-137">137</a></span>
<span class="normal"><a href="#__codelineno-29-138">138</a></span>
<span class="normal"><a href="#__codelineno-29-139">139</a></span>
<span class="normal"><a href="#__codelineno-29-140">140</a></span>
<span class="normal"><a href="#__codelineno-29-141">141</a></span>
<span class="normal"><a href="#__codelineno-29-142">142</a></span>
<span class="normal"><a href="#__codelineno-29-143">143</a></span>
<span class="normal"><a href="#__codelineno-29-144">144</a></span>
<span class="normal"><a href="#__codelineno-29-145">145</a></span>
<span class="normal"><a href="#__codelineno-29-146">146</a></span>
<span class="normal"><a href="#__codelineno-29-147">147</a></span>
<span class="normal"><a href="#__codelineno-29-148">148</a></span>
<span class="normal"><a href="#__codelineno-29-149">149</a></span>
<span class="normal"><a href="#__codelineno-29-150">150</a></span>
<span class="normal"><a href="#__codelineno-29-151">151</a></span>
<span class="normal"><a href="#__codelineno-29-152">152</a></span>
<span class="normal"><a href="#__codelineno-29-153">153</a></span>
<span class="normal"><a href="#__codelineno-29-154">154</a></span>
<span class="normal"><a href="#__codelineno-29-155">155</a></span>
<span class="normal"><a href="#__codelineno-29-156">156</a></span>
<span class="normal"><a href="#__codelineno-29-157">157</a></span>
<span class="normal"><a href="#__codelineno-29-158">158</a></span>
<span class="normal"><a href="#__codelineno-29-159">159</a></span>
<span class="normal"><a href="#__codelineno-29-160">160</a></span>
<span class="normal"><a href="#__codelineno-29-161">161</a></span>
<span class="normal"><a href="#__codelineno-29-162">162</a></span>
<span class="normal"><a href="#__codelineno-29-163">163</a></span>
<span class="normal"><a href="#__codelineno-29-164">164</a></span>
<span class="normal"><a href="#__codelineno-29-165">165</a></span>
<span class="normal"><a href="#__codelineno-29-166">166</a></span>
<span class="normal"><a href="#__codelineno-29-167">167</a></span>
<span class="normal"><a href="#__codelineno-29-168">168</a></span>
<span class="normal"><a href="#__codelineno-29-169">169</a></span>
<span class="normal"><a href="#__codelineno-29-170">170</a></span>
<span class="normal"><a href="#__codelineno-29-171">171</a></span>
<span class="normal"><a href="#__codelineno-29-172">172</a></span>
<span class="normal"><a href="#__codelineno-29-173">173</a></span>
<span class="normal"><a href="#__codelineno-29-174">174</a></span>
<span class="normal"><a href="#__codelineno-29-175">175</a></span>
<span class="normal"><a href="#__codelineno-29-176">176</a></span>
<span class="normal"><a href="#__codelineno-29-177">177</a></span>
<span class="normal"><a href="#__codelineno-29-178">178</a></span>
<span class="normal"><a href="#__codelineno-29-179">179</a></span>
<span class="normal"><a href="#__codelineno-29-180">180</a></span>
<span class="normal"><a href="#__codelineno-29-181">181</a></span>
<span class="normal"><a href="#__codelineno-29-182">182</a></span>
<span class="normal"><a href="#__codelineno-29-183">183</a></span>
<span class="normal"><a href="#__codelineno-29-184">184</a></span>
<span class="normal"><a href="#__codelineno-29-185">185</a></span>
<span class="normal"><a href="#__codelineno-29-186">186</a></span>
<span class="normal"><a href="#__codelineno-29-187">187</a></span>
<span class="normal"><a href="#__codelineno-29-188">188</a></span>
<span class="normal"><a href="#__codelineno-29-189">189</a></span>
<span class="normal"><a href="#__codelineno-29-190">190</a></span>
<span class="normal"><a href="#__codelineno-29-191">191</a></span>
<span class="normal"><a href="#__codelineno-29-192">192</a></span>
<span class="normal"><a href="#__codelineno-29-193">193</a></span>
<span class="normal"><a href="#__codelineno-29-194">194</a></span>
<span class="normal"><a href="#__codelineno-29-195">195</a></span>
<span class="normal"><a href="#__codelineno-29-196">196</a></span>
<span class="normal"><a href="#__codelineno-29-197">197</a></span>
<span class="normal"><a href="#__codelineno-29-198">198</a></span>
<span class="normal"><a href="#__codelineno-29-199">199</a></span>
<span class="normal"><a href="#__codelineno-29-200">200</a></span>
<span class="normal"><a href="#__codelineno-29-201">201</a></span>
<span class="normal"><a href="#__codelineno-29-202">202</a></span>
<span class="normal"><a href="#__codelineno-29-203">203</a></span>
<span class="normal"><a href="#__codelineno-29-204">204</a></span>
<span class="normal"><a href="#__codelineno-29-205">205</a></span>
<span class="normal"><a href="#__codelineno-29-206">206</a></span>
<span class="normal"><a href="#__codelineno-29-207">207</a></span>
<span class="normal"><a href="#__codelineno-29-208">208</a></span>
<span class="normal"><a href="#__codelineno-29-209">209</a></span>
<span class="normal"><a href="#__codelineno-29-210">210</a></span>
<span class="normal"><a href="#__codelineno-29-211">211</a></span>
<span class="normal"><a href="#__codelineno-29-212">212</a></span>
<span class="normal"><a href="#__codelineno-29-213">213</a></span>
<span class="normal"><a href="#__codelineno-29-214">214</a></span>
<span class="normal"><a href="#__codelineno-29-215">215</a></span>
<span class="normal"><a href="#__codelineno-29-216">216</a></span>
<span class="normal"><a href="#__codelineno-29-217">217</a></span>
<span class="normal"><a href="#__codelineno-29-218">218</a></span>
<span class="normal"><a href="#__codelineno-29-219">219</a></span>
<span class="normal"><a href="#__codelineno-29-220">220</a></span>
<span class="normal"><a href="#__codelineno-29-221">221</a></span>
<span class="normal"><a href="#__codelineno-29-222">222</a></span>
<span class="normal"><a href="#__codelineno-29-223">223</a></span>
<span class="normal"><a href="#__codelineno-29-224">224</a></span>
<span class="normal"><a href="#__codelineno-29-225">225</a></span>
<span class="normal"><a href="#__codelineno-29-226">226</a></span>
<span class="normal"><a href="#__codelineno-29-227">227</a></span>
<span class="normal"><a href="#__codelineno-29-228">228</a></span>
<span class="normal"><a href="#__codelineno-29-229">229</a></span>
<span class="normal"><a href="#__codelineno-29-230">230</a></span>
<span class="normal"><a href="#__codelineno-29-231">231</a></span>
<span class="normal"><a href="#__codelineno-29-232">232</a></span>
<span class="normal"><a href="#__codelineno-29-233">233</a></span>
<span class="normal"><a href="#__codelineno-29-234">234</a></span>
<span class="normal"><a href="#__codelineno-29-235">235</a></span>
<span class="normal"><a href="#__codelineno-29-236">236</a></span>
<span class="normal"><a href="#__codelineno-29-237">237</a></span>
<span class="normal"><a href="#__codelineno-29-238">238</a></span>
<span class="normal"><a href="#__codelineno-29-239">239</a></span>
<span class="normal"><a href="#__codelineno-29-240">240</a></span>
<span class="normal"><a href="#__codelineno-29-241">241</a></span>
<span class="normal"><a href="#__codelineno-29-242">242</a></span>
<span class="normal"><a href="#__codelineno-29-243">243</a></span>
<span class="normal"><a href="#__codelineno-29-244">244</a></span>
<span class="normal"><a href="#__codelineno-29-245">245</a></span>
<span class="normal"><a href="#__codelineno-29-246">246</a></span>
<span class="normal"><a href="#__codelineno-29-247">247</a></span>
<span class="normal"><a href="#__codelineno-29-248">248</a></span>
<span class="normal"><a href="#__codelineno-29-249">249</a></span>
<span class="normal"><a href="#__codelineno-29-250">250</a></span>
<span class="normal"><a href="#__codelineno-29-251">251</a></span>
<span class="normal"><a href="#__codelineno-29-252">252</a></span>
<span class="normal"><a href="#__codelineno-29-253">253</a></span>
<span class="normal"><a href="#__codelineno-29-254">254</a></span>
<span class="normal"><a href="#__codelineno-29-255">255</a></span>
<span class="normal"><a href="#__codelineno-29-256">256</a></span>
<span class="normal"><a href="#__codelineno-29-257">257</a></span>
<span class="normal"><a href="#__codelineno-29-258">258</a></span>
<span class="normal"><a href="#__codelineno-29-259">259</a></span>
<span class="normal"><a href="#__codelineno-29-260">260</a></span>
<span class="normal"><a href="#__codelineno-29-261">261</a></span>
<span class="normal"><a href="#__codelineno-29-262">262</a></span>
<span class="normal"><a href="#__codelineno-29-263">263</a></span>
<span class="normal"><a href="#__codelineno-29-264">264</a></span>
<span class="normal"><a href="#__codelineno-29-265">265</a></span>
<span class="normal"><a href="#__codelineno-29-266">266</a></span>
<span class="normal"><a href="#__codelineno-29-267">267</a></span>
<span class="normal"><a href="#__codelineno-29-268">268</a></span>
<span class="normal"><a href="#__codelineno-29-269">269</a></span>
<span class="normal"><a href="#__codelineno-29-270">270</a></span>
<span class="normal"><a href="#__codelineno-29-271">271</a></span>
<span class="normal"><a href="#__codelineno-29-272">272</a></span>
<span class="normal"><a href="#__codelineno-29-273">273</a></span>
<span class="normal"><a href="#__codelineno-29-274">274</a></span>
<span class="normal"><a href="#__codelineno-29-275">275</a></span>
<span class="normal"><a href="#__codelineno-29-276">276</a></span>
<span class="normal"><a href="#__codelineno-29-277">277</a></span>
<span class="normal"><a href="#__codelineno-29-278">278</a></span>
<span class="normal"><a href="#__codelineno-29-279">279</a></span>
<span class="normal"><a href="#__codelineno-29-280">280</a></span>
<span class="normal"><a href="#__codelineno-29-281">281</a></span>
<span class="normal"><a href="#__codelineno-29-282">282</a></span>
<span class="normal"><a href="#__codelineno-29-283">283</a></span>
<span class="normal"><a href="#__codelineno-29-284">284</a></span>
<span class="normal"><a href="#__codelineno-29-285">285</a></span>
<span class="normal"><a href="#__codelineno-29-286">286</a></span>
<span class="normal"><a href="#__codelineno-29-287">287</a></span>
<span class="normal"><a href="#__codelineno-29-288">288</a></span>
<span class="normal"><a href="#__codelineno-29-289">289</a></span>
<span class="normal"><a href="#__codelineno-29-290">290</a></span>
<span class="normal"><a href="#__codelineno-29-291">291</a></span>
<span class="normal"><a href="#__codelineno-29-292">292</a></span>
<span class="normal"><a href="#__codelineno-29-293">293</a></span>
<span class="normal"><a href="#__codelineno-29-294">294</a></span>
<span class="normal"><a href="#__codelineno-29-295">295</a></span>
<span class="normal"><a href="#__codelineno-29-296">296</a></span>
<span class="normal"><a href="#__codelineno-29-297">297</a></span>
<span class="normal"><a href="#__codelineno-29-298">298</a></span>
<span class="normal"><a href="#__codelineno-29-299">299</a></span>
<span class="normal"><a href="#__codelineno-29-300">300</a></span>
<span class="normal"><a href="#__codelineno-29-301">301</a></span>
<span class="normal"><a href="#__codelineno-29-302">302</a></span>
<span class="normal"><a href="#__codelineno-29-303">303</a></span>
<span class="normal"><a href="#__codelineno-29-304">304</a></span>
<span class="normal"><a href="#__codelineno-29-305">305</a></span>
<span class="normal"><a href="#__codelineno-29-306">306</a></span>
<span class="normal"><a href="#__codelineno-29-307">307</a></span>
<span class="normal"><a href="#__codelineno-29-308">308</a></span>
<span class="normal"><a href="#__codelineno-29-309">309</a></span>
<span class="normal"><a href="#__codelineno-29-310">310</a></span>
<span class="normal"><a href="#__codelineno-29-311">311</a></span>
<span class="normal"><a href="#__codelineno-29-312">312</a></span>
<span class="normal"><a href="#__codelineno-29-313">313</a></span>
<span class="normal"><a href="#__codelineno-29-314">314</a></span>
<span class="normal"><a href="#__codelineno-29-315">315</a></span>
<span class="normal"><a href="#__codelineno-29-316">316</a></span>
<span class="normal"><a href="#__codelineno-29-317">317</a></span>
<span class="normal"><a href="#__codelineno-29-318">318</a></span>
<span class="normal"><a href="#__codelineno-29-319">319</a></span>
<span class="normal"><a href="#__codelineno-29-320">320</a></span>
<span class="normal"><a href="#__codelineno-29-321">321</a></span>
<span class="normal"><a href="#__codelineno-29-322">322</a></span>
<span class="normal"><a href="#__codelineno-29-323">323</a></span>
<span class="normal"><a href="#__codelineno-29-324">324</a></span>
<span class="normal"><a href="#__codelineno-29-325">325</a></span>
<span class="normal"><a href="#__codelineno-29-326">326</a></span>
<span class="normal"><a href="#__codelineno-29-327">327</a></span>
<span class="normal"><a href="#__codelineno-29-328">328</a></span>
<span class="normal"><a href="#__codelineno-29-329">329</a></span>
<span class="normal"><a href="#__codelineno-29-330">330</a></span>
<span class="normal"><a href="#__codelineno-29-331">331</a></span>
<span class="normal"><a href="#__codelineno-29-332">332</a></span>
<span class="normal"><a href="#__codelineno-29-333">333</a></span>
<span class="normal"><a href="#__codelineno-29-334">334</a></span>
<span class="normal"><a href="#__codelineno-29-335">335</a></span>
<span class="normal"><a href="#__codelineno-29-336">336</a></span>
<span class="normal"><a href="#__codelineno-29-337">337</a></span>
<span class="normal"><a href="#__codelineno-29-338">338</a></span>
<span class="normal"><a href="#__codelineno-29-339">339</a></span>
<span class="normal"><a href="#__codelineno-29-340">340</a></span>
<span class="normal"><a href="#__codelineno-29-341">341</a></span>
<span class="normal"><a href="#__codelineno-29-342">342</a></span>
<span class="normal"><a href="#__codelineno-29-343">343</a></span>
<span class="normal"><a href="#__codelineno-29-344">344</a></span>
<span class="normal"><a href="#__codelineno-29-345">345</a></span>
<span class="normal"><a href="#__codelineno-29-346">346</a></span>
<span class="normal"><a href="#__codelineno-29-347">347</a></span>
<span class="normal"><a href="#__codelineno-29-348">348</a></span>
<span class="normal"><a href="#__codelineno-29-349">349</a></span>
<span class="normal"><a href="#__codelineno-29-350">350</a></span>
<span class="normal"><a href="#__codelineno-29-351">351</a></span>
<span class="normal"><a href="#__codelineno-29-352">352</a></span>
<span class="normal"><a href="#__codelineno-29-353">353</a></span>
<span class="normal"><a href="#__codelineno-29-354">354</a></span>
<span class="normal"><a href="#__codelineno-29-355">355</a></span>
<span class="normal"><a href="#__codelineno-29-356">356</a></span>
<span class="normal"><a href="#__codelineno-29-357">357</a></span>
<span class="normal"><a href="#__codelineno-29-358">358</a></span>
<span class="normal"><a href="#__codelineno-29-359">359</a></span>
<span class="normal"><a href="#__codelineno-29-360">360</a></span>
<span class="normal"><a href="#__codelineno-29-361">361</a></span>
<span class="normal"><a href="#__codelineno-29-362">362</a></span>
<span class="normal"><a href="#__codelineno-29-363">363</a></span>
<span class="normal"><a href="#__codelineno-29-364">364</a></span>
<span class="normal"><a href="#__codelineno-29-365">365</a></span>
<span class="normal"><a href="#__codelineno-29-366">366</a></span>
<span class="normal"><a href="#__codelineno-29-367">367</a></span>
<span class="normal"><a href="#__codelineno-29-368">368</a></span>
<span class="normal"><a href="#__codelineno-29-369">369</a></span>
<span class="normal"><a href="#__codelineno-29-370">370</a></span>
<span class="normal"><a href="#__codelineno-29-371">371</a></span>
<span class="normal"><a href="#__codelineno-29-372">372</a></span>
<span class="normal"><a href="#__codelineno-29-373">373</a></span>
<span class="normal"><a href="#__codelineno-29-374">374</a></span>
<span class="normal"><a href="#__codelineno-29-375">375</a></span>
<span class="normal"><a href="#__codelineno-29-376">376</a></span>
<span class="normal"><a href="#__codelineno-29-377">377</a></span>
<span class="normal"><a href="#__codelineno-29-378">378</a></span>
<span class="normal"><a href="#__codelineno-29-379">379</a></span>
<span class="normal"><a href="#__codelineno-29-380">380</a></span>
<span class="normal"><a href="#__codelineno-29-381">381</a></span>
<span class="normal"><a href="#__codelineno-29-382">382</a></span>
<span class="normal"><a href="#__codelineno-29-383">383</a></span>
<span class="normal"><a href="#__codelineno-29-384">384</a></span>
<span class="normal"><a href="#__codelineno-29-385">385</a></span>
<span class="normal"><a href="#__codelineno-29-386">386</a></span>
<span class="normal"><a href="#__codelineno-29-387">387</a></span>
<span class="normal"><a href="#__codelineno-29-388">388</a></span>
<span class="normal"><a href="#__codelineno-29-389">389</a></span>
<span class="normal"><a href="#__codelineno-29-390">390</a></span>
<span class="normal"><a href="#__codelineno-29-391">391</a></span>
<span class="normal"><a href="#__codelineno-29-392">392</a></span>
<span class="normal"><a href="#__codelineno-29-393">393</a></span>
<span class="normal"><a href="#__codelineno-29-394">394</a></span>
<span class="normal"><a href="#__codelineno-29-395">395</a></span>
<span class="normal"><a href="#__codelineno-29-396">396</a></span>
<span class="normal"><a href="#__codelineno-29-397">397</a></span>
<span class="normal"><a href="#__codelineno-29-398">398</a></span>
<span class="normal"><a href="#__codelineno-29-399">399</a></span>
<span class="normal"><a href="#__codelineno-29-400">400</a></span>
<span class="normal"><a href="#__codelineno-29-401">401</a></span>
<span class="normal"><a href="#__codelineno-29-402">402</a></span>
<span class="normal"><a href="#__codelineno-29-403">403</a></span>
<span class="normal"><a href="#__codelineno-29-404">404</a></span>
<span class="normal"><a href="#__codelineno-29-405">405</a></span>
<span class="normal"><a href="#__codelineno-29-406">406</a></span>
<span class="normal"><a href="#__codelineno-29-407">407</a></span>
<span class="normal"><a href="#__codelineno-29-408">408</a></span>
<span class="normal"><a href="#__codelineno-29-409">409</a></span>
<span class="normal"><a href="#__codelineno-29-410">410</a></span>
<span class="normal"><a href="#__codelineno-29-411">411</a></span>
<span class="normal"><a href="#__codelineno-29-412">412</a></span>
<span class="normal"><a href="#__codelineno-29-413">413</a></span>
<span class="normal"><a href="#__codelineno-29-414">414</a></span>
<span class="normal"><a href="#__codelineno-29-415">415</a></span>
<span class="normal"><a href="#__codelineno-29-416">416</a></span>
<span class="normal"><a href="#__codelineno-29-417">417</a></span>
<span class="normal"><a href="#__codelineno-29-418">418</a></span>
<span class="normal"><a href="#__codelineno-29-419">419</a></span>
<span class="normal"><a href="#__codelineno-29-420">420</a></span>
<span class="normal"><a href="#__codelineno-29-421">421</a></span>
<span class="normal"><a href="#__codelineno-29-422">422</a></span>
<span class="normal"><a href="#__codelineno-29-423">423</a></span>
<span class="normal"><a href="#__codelineno-29-424">424</a></span>
<span class="normal"><a href="#__codelineno-29-425">425</a></span>
<span class="normal"><a href="#__codelineno-29-426">426</a></span>
<span class="normal"><a href="#__codelineno-29-427">427</a></span>
<span class="normal"><a href="#__codelineno-29-428">428</a></span>
<span class="normal"><a href="#__codelineno-29-429">429</a></span>
<span class="normal"><a href="#__codelineno-29-430">430</a></span>
<span class="normal"><a href="#__codelineno-29-431">431</a></span>
<span class="normal"><a href="#__codelineno-29-432">432</a></span>
<span class="normal"><a href="#__codelineno-29-433">433</a></span>
<span class="normal"><a href="#__codelineno-29-434">434</a></span>
<span class="normal"><a href="#__codelineno-29-435">435</a></span>
<span class="normal"><a href="#__codelineno-29-436">436</a></span>
<span class="normal"><a href="#__codelineno-29-437">437</a></span>
<span class="normal"><a href="#__codelineno-29-438">438</a></span>
<span class="normal"><a href="#__codelineno-29-439">439</a></span>
<span class="normal"><a href="#__codelineno-29-440">440</a></span>
<span class="normal"><a href="#__codelineno-29-441">441</a></span>
<span class="normal"><a href="#__codelineno-29-442">442</a></span>
<span class="normal"><a href="#__codelineno-29-443">443</a></span>
<span class="normal"><a href="#__codelineno-29-444">444</a></span>
<span class="normal"><a href="#__codelineno-29-445">445</a></span>
<span class="normal"><a href="#__codelineno-29-446">446</a></span>
<span class="normal"><a href="#__codelineno-29-447">447</a></span>
<span class="normal"><a href="#__codelineno-29-448">448</a></span>
<span class="normal"><a href="#__codelineno-29-449">449</a></span>
<span class="normal"><a href="#__codelineno-29-450">450</a></span>
<span class="normal"><a href="#__codelineno-29-451">451</a></span>
<span class="normal"><a href="#__codelineno-29-452">452</a></span>
<span class="normal"><a href="#__codelineno-29-453">453</a></span>
<span class="normal"><a href="#__codelineno-29-454">454</a></span>
<span class="normal"><a href="#__codelineno-29-455">455</a></span>
<span class="normal"><a href="#__codelineno-29-456">456</a></span>
<span class="normal"><a href="#__codelineno-29-457">457</a></span>
<span class="normal"><a href="#__codelineno-29-458">458</a></span>
<span class="normal"><a href="#__codelineno-29-459">459</a></span>
<span class="normal"><a href="#__codelineno-29-460">460</a></span>
<span class="normal"><a href="#__codelineno-29-461">461</a></span>
<span class="normal"><a href="#__codelineno-29-462">462</a></span>
<span class="normal"><a href="#__codelineno-29-463">463</a></span>
<span class="normal"><a href="#__codelineno-29-464">464</a></span>
<span class="normal"><a href="#__codelineno-29-465">465</a></span>
<span class="normal"><a href="#__codelineno-29-466">466</a></span>
<span class="normal"><a href="#__codelineno-29-467">467</a></span>
<span class="normal"><a href="#__codelineno-29-468">468</a></span>
<span class="normal"><a href="#__codelineno-29-469">469</a></span>
<span class="normal"><a href="#__codelineno-29-470">470</a></span>
<span class="normal"><a href="#__codelineno-29-471">471</a></span>
<span class="normal"><a href="#__codelineno-29-472">472</a></span>
<span class="normal"><a href="#__codelineno-29-473">473</a></span>
<span class="normal"><a href="#__codelineno-29-474">474</a></span>
<span class="normal"><a href="#__codelineno-29-475">475</a></span>
<span class="normal"><a href="#__codelineno-29-476">476</a></span>
<span class="normal"><a href="#__codelineno-29-477">477</a></span>
<span class="normal"><a href="#__codelineno-29-478">478</a></span>
<span class="normal"><a href="#__codelineno-29-479">479</a></span>
<span class="normal"><a href="#__codelineno-29-480">480</a></span>
<span class="normal"><a href="#__codelineno-29-481">481</a></span>
<span class="normal"><a href="#__codelineno-29-482">482</a></span>
<span class="normal"><a href="#__codelineno-29-483">483</a></span>
<span class="normal"><a href="#__codelineno-29-484">484</a></span>
<span class="normal"><a href="#__codelineno-29-485">485</a></span>
<span class="normal"><a href="#__codelineno-29-486">486</a></span>
<span class="normal"><a href="#__codelineno-29-487">487</a></span>
<span class="normal"><a href="#__codelineno-29-488">488</a></span>
<span class="normal"><a href="#__codelineno-29-489">489</a></span>
<span class="normal"><a href="#__codelineno-29-490">490</a></span>
<span class="normal"><a href="#__codelineno-29-491">491</a></span>
<span class="normal"><a href="#__codelineno-29-492">492</a></span>
<span class="normal"><a href="#__codelineno-29-493">493</a></span>
<span class="normal"><a href="#__codelineno-29-494">494</a></span>
<span class="normal"><a href="#__codelineno-29-495">495</a></span>
<span class="normal"><a href="#__codelineno-29-496">496</a></span>
<span class="normal"><a href="#__codelineno-29-497">497</a></span>
<span class="normal"><a href="#__codelineno-29-498">498</a></span>
<span class="normal"><a href="#__codelineno-29-499">499</a></span>
<span class="normal"><a href="#__codelineno-29-500">500</a></span>
<span class="normal"><a href="#__codelineno-29-501">501</a></span>
<span class="normal"><a href="#__codelineno-29-502">502</a></span>
<span class="normal"><a href="#__codelineno-29-503">503</a></span>
<span class="normal"><a href="#__codelineno-29-504">504</a></span>
<span class="normal"><a href="#__codelineno-29-505">505</a></span>
<span class="normal"><a href="#__codelineno-29-506">506</a></span>
<span class="normal"><a href="#__codelineno-29-507">507</a></span>
<span class="normal"><a href="#__codelineno-29-508">508</a></span>
<span class="normal"><a href="#__codelineno-29-509">509</a></span>
<span class="normal"><a href="#__codelineno-29-510">510</a></span>
<span class="normal"><a href="#__codelineno-29-511">511</a></span>
<span class="normal"><a href="#__codelineno-29-512">512</a></span>
<span class="normal"><a href="#__codelineno-29-513">513</a></span>
<span class="normal"><a href="#__codelineno-29-514">514</a></span>
<span class="normal"><a href="#__codelineno-29-515">515</a></span>
<span class="normal"><a href="#__codelineno-29-516">516</a></span>
<span class="normal"><a href="#__codelineno-29-517">517</a></span>
<span class="normal"><a href="#__codelineno-29-518">518</a></span>
<span class="normal"><a href="#__codelineno-29-519">519</a></span>
<span class="normal"><a href="#__codelineno-29-520">520</a></span>
<span class="normal"><a href="#__codelineno-29-521">521</a></span>
<span class="normal"><a href="#__codelineno-29-522">522</a></span>
<span class="normal"><a href="#__codelineno-29-523">523</a></span>
<span class="normal"><a href="#__codelineno-29-524">524</a></span>
<span class="normal"><a href="#__codelineno-29-525">525</a></span>
<span class="normal"><a href="#__codelineno-29-526">526</a></span>
<span class="normal"><a href="#__codelineno-29-527">527</a></span>
<span class="normal"><a href="#__codelineno-29-528">528</a></span>
<span class="normal"><a href="#__codelineno-29-529">529</a></span>
<span class="normal"><a href="#__codelineno-29-530">530</a></span>
<span class="normal"><a href="#__codelineno-29-531">531</a></span>
<span class="normal"><a href="#__codelineno-29-532">532</a></span>
<span class="normal"><a href="#__codelineno-29-533">533</a></span>
<span class="normal"><a href="#__codelineno-29-534">534</a></span>
<span class="normal"><a href="#__codelineno-29-535">535</a></span>
<span class="normal"><a href="#__codelineno-29-536">536</a></span>
<span class="normal"><a href="#__codelineno-29-537">537</a></span>
<span class="normal"><a href="#__codelineno-29-538">538</a></span>
<span class="normal"><a href="#__codelineno-29-539">539</a></span>
<span class="normal"><a href="#__codelineno-29-540">540</a></span>
<span class="normal"><a href="#__codelineno-29-541">541</a></span>
<span class="normal"><a href="#__codelineno-29-542">542</a></span>
<span class="normal"><a href="#__codelineno-29-543">543</a></span>
<span class="normal"><a href="#__codelineno-29-544">544</a></span>
<span class="normal"><a href="#__codelineno-29-545">545</a></span>
<span class="normal"><a href="#__codelineno-29-546">546</a></span>
<span class="normal"><a href="#__codelineno-29-547">547</a></span>
<span class="normal"><a href="#__codelineno-29-548">548</a></span>
<span class="normal"><a href="#__codelineno-29-549">549</a></span>
<span class="normal"><a href="#__codelineno-29-550">550</a></span>
<span class="normal"><a href="#__codelineno-29-551">551</a></span>
<span class="normal"><a href="#__codelineno-29-552">552</a></span>
<span class="normal"><a href="#__codelineno-29-553">553</a></span>
<span class="normal"><a href="#__codelineno-29-554">554</a></span>
<span class="normal"><a href="#__codelineno-29-555">555</a></span>
<span class="normal"><a href="#__codelineno-29-556">556</a></span>
<span class="normal"><a href="#__codelineno-29-557">557</a></span>
<span class="normal"><a href="#__codelineno-29-558">558</a></span>
<span class="normal"><a href="#__codelineno-29-559">559</a></span>
<span class="normal"><a href="#__codelineno-29-560">560</a></span>
<span class="normal"><a href="#__codelineno-29-561">561</a></span>
<span class="normal"><a href="#__codelineno-29-562">562</a></span>
<span class="normal"><a href="#__codelineno-29-563">563</a></span>
<span class="normal"><a href="#__codelineno-29-564">564</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">"stdafx.h"</span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">"CMineSymbolLogger.h"</span>
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sstream&gt;</span>
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iomanip&gt;</span>
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;Windows.h&gt;</span>
</span><span id="__span-29-6"><a id="__codelineno-29-6" name="__codelineno-29-6"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;Shlwapi.h&gt;</span>
</span><span id="__span-29-7"><a id="__codelineno-29-7" name="__codelineno-29-7"></a>
</span><span id="__span-29-8"><a id="__codelineno-29-8" name="__codelineno-29-8"></a><span class="cp">#pragma comment(lib, "Shlwapi.lib")</span>
</span><span id="__span-29-9"><a id="__codelineno-29-9" name="__codelineno-29-9"></a>
</span><span id="__span-29-10"><a id="__codelineno-29-10" name="__codelineno-29-10"></a><span class="n">CMineSymbolLogger</span><span class="o">&amp;</span><span class="w"> </span><span class="nf">CMineSymbolLogger::GetInstance</span><span class="p">()</span>
</span><span id="__span-29-11"><a id="__codelineno-29-11" name="__codelineno-29-11"></a><span class="p">{</span>
</span><span id="__span-29-12"><a id="__codelineno-29-12" name="__codelineno-29-12"></a><span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="n">CMineSymbolLogger</span><span class="w"> </span><span class="n">instance</span><span class="p">;</span>
</span><span id="__span-29-13"><a id="__codelineno-29-13" name="__codelineno-29-13"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">instance</span><span class="p">;</span>
</span><span id="__span-29-14"><a id="__codelineno-29-14" name="__codelineno-29-14"></a><span class="p">}</span>
</span><span id="__span-29-15"><a id="__codelineno-29-15" name="__codelineno-29-15"></a>
</span><span id="__span-29-16"><a id="__codelineno-29-16" name="__codelineno-29-16"></a><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">CMineSymbolLogger</span><span class="p">()</span>
</span><span id="__span-29-17"><a id="__codelineno-29-17" name="__codelineno-29-17"></a><span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="n">m_initialized</span><span class="p">(</span><span class="nb">false</span><span class="p">)</span>
</span><span id="__span-29-18"><a id="__codelineno-29-18" name="__codelineno-29-18"></a><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">m_logLevel</span><span class="p">(</span><span class="n">LogLevel</span><span class="o">::</span><span class="n">Info</span><span class="p">)</span>
</span><span id="__span-29-19"><a id="__codelineno-29-19" name="__codelineno-29-19"></a><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">m_logTarget</span><span class="p">(</span><span class="n">LogTarget</span><span class="o">::</span><span class="n">Both</span><span class="p">)</span>
</span><span id="__span-29-20"><a id="__codelineno-29-20" name="__codelineno-29-20"></a><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">m_autoFlush</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>
</span><span id="__span-29-21"><a id="__codelineno-29-21" name="__codelineno-29-21"></a><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">m_maxFileSize</span><span class="p">(</span><span class="mi">10</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024</span><span class="p">)</span><span class="w"> </span><span class="c1">// 10MB</span>
</span><span id="__span-29-22"><a id="__codelineno-29-22" name="__codelineno-29-22"></a><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">m_maxBackupFiles</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span><span id="__span-29-23"><a id="__codelineno-29-23" name="__codelineno-29-23"></a><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">m_enableTimestamp</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>
</span><span id="__span-29-24"><a id="__codelineno-29-24" name="__codelineno-29-24"></a><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">m_enableThreadId</span><span class="p">(</span><span class="nb">false</span><span class="p">)</span>
</span><span id="__span-29-25"><a id="__codelineno-29-25" name="__codelineno-29-25"></a><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">m_fileOpened</span><span class="p">(</span><span class="nb">false</span><span class="p">)</span>
</span><span id="__span-29-26"><a id="__codelineno-29-26" name="__codelineno-29-26"></a><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">m_consoleOutput</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>
</span><span id="__span-29-27"><a id="__codelineno-29-27" name="__codelineno-29-27"></a><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">m_fileOutput</span><span class="p">(</span><span class="nb">false</span><span class="p">)</span>
</span><span id="__span-29-28"><a id="__codelineno-29-28" name="__codelineno-29-28"></a><span class="p">{</span>
</span><span id="__span-29-29"><a id="__codelineno-29-29" name="__codelineno-29-29"></a><span class="p">}</span>
</span><span id="__span-29-30"><a id="__codelineno-29-30" name="__codelineno-29-30"></a>
</span><span id="__span-29-31"><a id="__codelineno-29-31" name="__codelineno-29-31"></a><span class="n">CMineSymbolLogger</span><span class="o">::~</span><span class="n">CMineSymbolLogger</span><span class="p">()</span>
</span><span id="__span-29-32"><a id="__codelineno-29-32" name="__codelineno-29-32"></a><span class="p">{</span>
</span><span id="__span-29-33"><a id="__codelineno-29-33" name="__codelineno-29-33"></a><span class="w">    </span><span class="n">Shutdown</span><span class="p">();</span>
</span><span id="__span-29-34"><a id="__codelineno-29-34" name="__codelineno-29-34"></a><span class="p">}</span>
</span><span id="__span-29-35"><a id="__codelineno-29-35" name="__codelineno-29-35"></a>
</span><span id="__span-29-36"><a id="__codelineno-29-36" name="__codelineno-29-36"></a><span class="c1">// ========== 初始化接口 ==========</span>
</span><span id="__span-29-37"><a id="__codelineno-29-37" name="__codelineno-29-37"></a>
</span><span id="__span-29-38"><a id="__codelineno-29-38" name="__codelineno-29-38"></a><span class="kt">bool</span><span class="w"> </span><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">Initialize</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">LogConfig</span><span class="o">&amp;</span><span class="w"> </span><span class="n">config</span><span class="p">)</span>
</span><span id="__span-29-39"><a id="__codelineno-29-39" name="__codelineno-29-39"></a><span class="p">{</span>
</span><span id="__span-29-40"><a id="__codelineno-29-40" name="__codelineno-29-40"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">lock_guard</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">mutex</span><span class="o">&gt;</span><span class="w"> </span><span class="n">lock</span><span class="p">(</span><span class="n">m_mutex</span><span class="p">);</span>
</span><span id="__span-29-41"><a id="__codelineno-29-41" name="__codelineno-29-41"></a>
</span><span id="__span-29-42"><a id="__codelineno-29-42" name="__codelineno-29-42"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_initialized</span><span class="p">)</span>
</span><span id="__span-29-43"><a id="__codelineno-29-43" name="__codelineno-29-43"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-29-44"><a id="__codelineno-29-44" name="__codelineno-29-44"></a><span class="w">        </span><span class="c1">// 已经初始化，先关闭</span>
</span><span id="__span-29-45"><a id="__codelineno-29-45" name="__codelineno-29-45"></a><span class="w">        </span><span class="n">CloseLogFile</span><span class="p">();</span>
</span><span id="__span-29-46"><a id="__codelineno-29-46" name="__codelineno-29-46"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-29-47"><a id="__codelineno-29-47" name="__codelineno-29-47"></a>
</span><span id="__span-29-48"><a id="__codelineno-29-48" name="__codelineno-29-48"></a><span class="w">    </span><span class="n">m_logLevel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">config</span><span class="p">.</span><span class="n">Level</span><span class="p">;</span>
</span><span id="__span-29-49"><a id="__codelineno-29-49" name="__codelineno-29-49"></a><span class="w">    </span><span class="n">m_logTarget</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">config</span><span class="p">.</span><span class="n">Target</span><span class="p">;</span>
</span><span id="__span-29-50"><a id="__codelineno-29-50" name="__codelineno-29-50"></a><span class="w">    </span><span class="n">m_logFilePath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">config</span><span class="p">.</span><span class="n">FilePath</span><span class="p">;</span>
</span><span id="__span-29-51"><a id="__codelineno-29-51" name="__codelineno-29-51"></a><span class="w">    </span><span class="n">m_autoFlush</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">config</span><span class="p">.</span><span class="n">AutoFlush</span><span class="p">;</span>
</span><span id="__span-29-52"><a id="__codelineno-29-52" name="__codelineno-29-52"></a><span class="w">    </span><span class="n">m_maxFileSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">config</span><span class="p">.</span><span class="n">MaxFileSize</span><span class="p">;</span>
</span><span id="__span-29-53"><a id="__codelineno-29-53" name="__codelineno-29-53"></a><span class="w">    </span><span class="n">m_maxBackupFiles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">config</span><span class="p">.</span><span class="n">MaxBackupFiles</span><span class="p">;</span>
</span><span id="__span-29-54"><a id="__codelineno-29-54" name="__codelineno-29-54"></a><span class="w">    </span><span class="n">m_enableTimestamp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">config</span><span class="p">.</span><span class="n">EnableTimestamp</span><span class="p">;</span>
</span><span id="__span-29-55"><a id="__codelineno-29-55" name="__codelineno-29-55"></a><span class="w">    </span><span class="n">m_enableThreadId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">config</span><span class="p">.</span><span class="n">EnableThreadId</span><span class="p">;</span>
</span><span id="__span-29-56"><a id="__codelineno-29-56" name="__codelineno-29-56"></a>
</span><span id="__span-29-57"><a id="__codelineno-29-57" name="__codelineno-29-57"></a><span class="w">    </span><span class="c1">// 更新兼容标志</span>
</span><span id="__span-29-58"><a id="__codelineno-29-58" name="__codelineno-29-58"></a><span class="w">    </span><span class="n">m_consoleOutput</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">config</span><span class="p">.</span><span class="n">Target</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">LogTarget</span><span class="o">::</span><span class="n">Console</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">config</span><span class="p">.</span><span class="n">Target</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">LogTarget</span><span class="o">::</span><span class="n">Both</span><span class="p">);</span>
</span><span id="__span-29-59"><a id="__codelineno-29-59" name="__codelineno-29-59"></a><span class="w">    </span><span class="n">m_fileOutput</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">config</span><span class="p">.</span><span class="n">Target</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">LogTarget</span><span class="o">::</span><span class="n">File</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">config</span><span class="p">.</span><span class="n">Target</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">LogTarget</span><span class="o">::</span><span class="n">Both</span><span class="p">);</span>
</span><span id="__span-29-60"><a id="__codelineno-29-60" name="__codelineno-29-60"></a>
</span><span id="__span-29-61"><a id="__codelineno-29-61" name="__codelineno-29-61"></a><span class="w">    </span><span class="c1">// 如果需要文件输出，打开文件</span>
</span><span id="__span-29-62"><a id="__codelineno-29-62" name="__codelineno-29-62"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_fileOutput</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">m_logFilePath</span><span class="p">.</span><span class="n">IsEmpty</span><span class="p">())</span>
</span><span id="__span-29-63"><a id="__codelineno-29-63" name="__codelineno-29-63"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-29-64"><a id="__codelineno-29-64" name="__codelineno-29-64"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">OpenLogFile</span><span class="p">())</span>
</span><span id="__span-29-65"><a id="__codelineno-29-65" name="__codelineno-29-65"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-29-66"><a id="__codelineno-29-66" name="__codelineno-29-66"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
</span><span id="__span-29-67"><a id="__codelineno-29-67" name="__codelineno-29-67"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-29-68"><a id="__codelineno-29-68" name="__codelineno-29-68"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-29-69"><a id="__codelineno-29-69" name="__codelineno-29-69"></a>
</span><span id="__span-29-70"><a id="__codelineno-29-70" name="__codelineno-29-70"></a><span class="w">    </span><span class="n">m_initialized</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
</span><span id="__span-29-71"><a id="__codelineno-29-71" name="__codelineno-29-71"></a>
</span><span id="__span-29-72"><a id="__codelineno-29-72" name="__codelineno-29-72"></a><span class="w">    </span><span class="c1">// 记录初始化信息（使用内部方法，避免死锁）</span>
</span><span id="__span-29-73"><a id="__codelineno-29-73" name="__codelineno-29-73"></a><span class="w">    </span><span class="n">CString</span><span class="w"> </span><span class="n">initMsg</span><span class="p">;</span>
</span><span id="__span-29-74"><a id="__codelineno-29-74" name="__codelineno-29-74"></a><span class="w">    </span><span class="n">initMsg</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"日志系统初始化成功 [级别:%s, 目标:%d, 文件:%s]"</span><span class="p">),</span>
</span><span id="__span-29-75"><a id="__codelineno-29-75" name="__codelineno-29-75"></a><span class="w">        </span><span class="n">GetLevelString</span><span class="p">(</span><span class="n">m_logLevel</span><span class="p">),</span>
</span><span id="__span-29-76"><a id="__codelineno-29-76" name="__codelineno-29-76"></a><span class="w">        </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">m_logTarget</span><span class="p">),</span>
</span><span id="__span-29-77"><a id="__codelineno-29-77" name="__codelineno-29-77"></a><span class="w">        </span><span class="n">m_logFilePath</span><span class="p">.</span><span class="n">IsEmpty</span><span class="p">()</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">_T</span><span class="p">(</span><span class="s">"无"</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">m_logFilePath</span><span class="p">);</span>
</span><span id="__span-29-78"><a id="__codelineno-29-78" name="__codelineno-29-78"></a>
</span><span id="__span-29-79"><a id="__codelineno-29-79" name="__codelineno-29-79"></a><span class="w">    </span><span class="n">LogInternal</span><span class="p">(</span><span class="n">LogLevel</span><span class="o">::</span><span class="n">Info</span><span class="p">,</span><span class="w"> </span><span class="n">initMsg</span><span class="p">);</span>
</span><span id="__span-29-80"><a id="__codelineno-29-80" name="__codelineno-29-80"></a>
</span><span id="__span-29-81"><a id="__codelineno-29-81" name="__codelineno-29-81"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
</span><span id="__span-29-82"><a id="__codelineno-29-82" name="__codelineno-29-82"></a><span class="p">}</span>
</span><span id="__span-29-83"><a id="__codelineno-29-83" name="__codelineno-29-83"></a>
</span><span id="__span-29-84"><a id="__codelineno-29-84" name="__codelineno-29-84"></a><span class="kt">bool</span><span class="w"> </span><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">Initialize</span><span class="p">(</span>
</span><span id="__span-29-85"><a id="__codelineno-29-85" name="__codelineno-29-85"></a><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">CString</span><span class="o">&amp;</span><span class="w"> </span><span class="n">logFilePath</span><span class="p">,</span>
</span><span id="__span-29-86"><a id="__codelineno-29-86" name="__codelineno-29-86"></a><span class="w">    </span><span class="n">LogLevel</span><span class="w"> </span><span class="n">level</span><span class="p">,</span>
</span><span id="__span-29-87"><a id="__codelineno-29-87" name="__codelineno-29-87"></a><span class="w">    </span><span class="n">LogTarget</span><span class="w"> </span><span class="n">target</span><span class="p">)</span>
</span><span id="__span-29-88"><a id="__codelineno-29-88" name="__codelineno-29-88"></a><span class="p">{</span>
</span><span id="__span-29-89"><a id="__codelineno-29-89" name="__codelineno-29-89"></a><span class="w">    </span><span class="n">LogConfig</span><span class="w"> </span><span class="n">config</span><span class="p">;</span>
</span><span id="__span-29-90"><a id="__codelineno-29-90" name="__codelineno-29-90"></a><span class="w">    </span><span class="n">config</span><span class="p">.</span><span class="n">Level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">level</span><span class="p">;</span>
</span><span id="__span-29-91"><a id="__codelineno-29-91" name="__codelineno-29-91"></a><span class="w">    </span><span class="n">config</span><span class="p">.</span><span class="n">Target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">target</span><span class="p">;</span>
</span><span id="__span-29-92"><a id="__codelineno-29-92" name="__codelineno-29-92"></a><span class="w">    </span><span class="n">config</span><span class="p">.</span><span class="n">FilePath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">logFilePath</span><span class="p">;</span>
</span><span id="__span-29-93"><a id="__codelineno-29-93" name="__codelineno-29-93"></a>
</span><span id="__span-29-94"><a id="__codelineno-29-94" name="__codelineno-29-94"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Initialize</span><span class="p">(</span><span class="n">config</span><span class="p">);</span>
</span><span id="__span-29-95"><a id="__codelineno-29-95" name="__codelineno-29-95"></a><span class="p">}</span>
</span><span id="__span-29-96"><a id="__codelineno-29-96" name="__codelineno-29-96"></a>
</span><span id="__span-29-97"><a id="__codelineno-29-97" name="__codelineno-29-97"></a><span class="kt">void</span><span class="w"> </span><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">Shutdown</span><span class="p">()</span>
</span><span id="__span-29-98"><a id="__codelineno-29-98" name="__codelineno-29-98"></a><span class="p">{</span>
</span><span id="__span-29-99"><a id="__codelineno-29-99" name="__codelineno-29-99"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">lock_guard</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">mutex</span><span class="o">&gt;</span><span class="w"> </span><span class="n">lock</span><span class="p">(</span><span class="n">m_mutex</span><span class="p">);</span>
</span><span id="__span-29-100"><a id="__codelineno-29-100" name="__codelineno-29-100"></a>
</span><span id="__span-29-101"><a id="__codelineno-29-101" name="__codelineno-29-101"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_initialized</span><span class="p">)</span>
</span><span id="__span-29-102"><a id="__codelineno-29-102" name="__codelineno-29-102"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-29-103"><a id="__codelineno-29-103" name="__codelineno-29-103"></a><span class="w">        </span><span class="n">LogInternal</span><span class="p">(</span><span class="n">LogLevel</span><span class="o">::</span><span class="n">Info</span><span class="p">,</span><span class="w"> </span><span class="n">_T</span><span class="p">(</span><span class="s">"日志系统关闭"</span><span class="p">));</span><span class="w">  </span><span class="c1">// 使用内部方法，避免死锁</span>
</span><span id="__span-29-104"><a id="__codelineno-29-104" name="__codelineno-29-104"></a><span class="w">        </span><span class="n">CloseLogFile</span><span class="p">();</span>
</span><span id="__span-29-105"><a id="__codelineno-29-105" name="__codelineno-29-105"></a><span class="w">        </span><span class="n">m_initialized</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
</span><span id="__span-29-106"><a id="__codelineno-29-106" name="__codelineno-29-106"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-29-107"><a id="__codelineno-29-107" name="__codelineno-29-107"></a><span class="p">}</span>
</span><span id="__span-29-108"><a id="__codelineno-29-108" name="__codelineno-29-108"></a>
</span><span id="__span-29-109"><a id="__codelineno-29-109" name="__codelineno-29-109"></a><span class="kt">void</span><span class="w"> </span><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">SetLogLevel</span><span class="p">(</span><span class="n">LogLevel</span><span class="w"> </span><span class="n">level</span><span class="p">)</span>
</span><span id="__span-29-110"><a id="__codelineno-29-110" name="__codelineno-29-110"></a><span class="p">{</span>
</span><span id="__span-29-111"><a id="__codelineno-29-111" name="__codelineno-29-111"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">lock_guard</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">mutex</span><span class="o">&gt;</span><span class="w"> </span><span class="n">lock</span><span class="p">(</span><span class="n">m_mutex</span><span class="p">);</span>
</span><span id="__span-29-112"><a id="__codelineno-29-112" name="__codelineno-29-112"></a><span class="w">    </span><span class="n">m_logLevel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">level</span><span class="p">;</span>
</span><span id="__span-29-113"><a id="__codelineno-29-113" name="__codelineno-29-113"></a><span class="p">}</span>
</span><span id="__span-29-114"><a id="__codelineno-29-114" name="__codelineno-29-114"></a>
</span><span id="__span-29-115"><a id="__codelineno-29-115" name="__codelineno-29-115"></a><span class="kt">void</span><span class="w"> </span><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">Debug</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CString</span><span class="o">&amp;</span><span class="w"> </span><span class="n">message</span><span class="p">)</span>
</span><span id="__span-29-116"><a id="__codelineno-29-116" name="__codelineno-29-116"></a><span class="p">{</span>
</span><span id="__span-29-117"><a id="__codelineno-29-117" name="__codelineno-29-117"></a><span class="w">    </span><span class="n">Log</span><span class="p">(</span><span class="n">LogLevel</span><span class="o">::</span><span class="n">Debug</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="p">);</span>
</span><span id="__span-29-118"><a id="__codelineno-29-118" name="__codelineno-29-118"></a><span class="p">}</span>
</span><span id="__span-29-119"><a id="__codelineno-29-119" name="__codelineno-29-119"></a>
</span><span id="__span-29-120"><a id="__codelineno-29-120" name="__codelineno-29-120"></a><span class="kt">void</span><span class="w"> </span><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">Info</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CString</span><span class="o">&amp;</span><span class="w"> </span><span class="n">message</span><span class="p">)</span>
</span><span id="__span-29-121"><a id="__codelineno-29-121" name="__codelineno-29-121"></a><span class="p">{</span>
</span><span id="__span-29-122"><a id="__codelineno-29-122" name="__codelineno-29-122"></a><span class="w">    </span><span class="n">Log</span><span class="p">(</span><span class="n">LogLevel</span><span class="o">::</span><span class="n">Info</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="p">);</span>
</span><span id="__span-29-123"><a id="__codelineno-29-123" name="__codelineno-29-123"></a><span class="p">}</span>
</span><span id="__span-29-124"><a id="__codelineno-29-124" name="__codelineno-29-124"></a>
</span><span id="__span-29-125"><a id="__codelineno-29-125" name="__codelineno-29-125"></a><span class="kt">void</span><span class="w"> </span><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">Warning</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CString</span><span class="o">&amp;</span><span class="w"> </span><span class="n">message</span><span class="p">)</span>
</span><span id="__span-29-126"><a id="__codelineno-29-126" name="__codelineno-29-126"></a><span class="p">{</span>
</span><span id="__span-29-127"><a id="__codelineno-29-127" name="__codelineno-29-127"></a><span class="w">    </span><span class="n">Log</span><span class="p">(</span><span class="n">LogLevel</span><span class="o">::</span><span class="n">Warning</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="p">);</span>
</span><span id="__span-29-128"><a id="__codelineno-29-128" name="__codelineno-29-128"></a><span class="p">}</span>
</span><span id="__span-29-129"><a id="__codelineno-29-129" name="__codelineno-29-129"></a>
</span><span id="__span-29-130"><a id="__codelineno-29-130" name="__codelineno-29-130"></a><span class="kt">void</span><span class="w"> </span><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">Error</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CString</span><span class="o">&amp;</span><span class="w"> </span><span class="n">message</span><span class="p">)</span>
</span><span id="__span-29-131"><a id="__codelineno-29-131" name="__codelineno-29-131"></a><span class="p">{</span>
</span><span id="__span-29-132"><a id="__codelineno-29-132" name="__codelineno-29-132"></a><span class="w">    </span><span class="n">Log</span><span class="p">(</span><span class="n">LogLevel</span><span class="o">::</span><span class="n">Error</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="p">);</span>
</span><span id="__span-29-133"><a id="__codelineno-29-133" name="__codelineno-29-133"></a><span class="p">}</span>
</span><span id="__span-29-134"><a id="__codelineno-29-134" name="__codelineno-29-134"></a>
</span><span id="__span-29-135"><a id="__codelineno-29-135" name="__codelineno-29-135"></a><span class="kt">void</span><span class="w"> </span><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">DebugFormat</span><span class="p">(</span><span class="n">LPCTSTR</span><span class="w"> </span><span class="n">format</span><span class="p">,</span><span class="w"> </span><span class="p">...)</span>
</span><span id="__span-29-136"><a id="__codelineno-29-136" name="__codelineno-29-136"></a><span class="p">{</span>
</span><span id="__span-29-137"><a id="__codelineno-29-137" name="__codelineno-29-137"></a><span class="w">    </span><span class="kt">va_list</span><span class="w"> </span><span class="n">args</span><span class="p">;</span>
</span><span id="__span-29-138"><a id="__codelineno-29-138" name="__codelineno-29-138"></a><span class="w">    </span><span class="n">va_start</span><span class="p">(</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="n">format</span><span class="p">);</span>
</span><span id="__span-29-139"><a id="__codelineno-29-139" name="__codelineno-29-139"></a><span class="w">    </span><span class="n">CString</span><span class="w"> </span><span class="n">message</span><span class="p">;</span>
</span><span id="__span-29-140"><a id="__codelineno-29-140" name="__codelineno-29-140"></a><span class="w">    </span><span class="n">message</span><span class="p">.</span><span class="n">FormatV</span><span class="p">(</span><span class="n">format</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
</span><span id="__span-29-141"><a id="__codelineno-29-141" name="__codelineno-29-141"></a><span class="w">    </span><span class="n">va_end</span><span class="p">(</span><span class="n">args</span><span class="p">);</span>
</span><span id="__span-29-142"><a id="__codelineno-29-142" name="__codelineno-29-142"></a><span class="w">    </span><span class="n">Debug</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
</span><span id="__span-29-143"><a id="__codelineno-29-143" name="__codelineno-29-143"></a><span class="p">}</span>
</span><span id="__span-29-144"><a id="__codelineno-29-144" name="__codelineno-29-144"></a>
</span><span id="__span-29-145"><a id="__codelineno-29-145" name="__codelineno-29-145"></a><span class="kt">void</span><span class="w"> </span><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">InfoFormat</span><span class="p">(</span><span class="n">LPCTSTR</span><span class="w"> </span><span class="n">format</span><span class="p">,</span><span class="w"> </span><span class="p">...)</span>
</span><span id="__span-29-146"><a id="__codelineno-29-146" name="__codelineno-29-146"></a><span class="p">{</span>
</span><span id="__span-29-147"><a id="__codelineno-29-147" name="__codelineno-29-147"></a><span class="w">    </span><span class="kt">va_list</span><span class="w"> </span><span class="n">args</span><span class="p">;</span>
</span><span id="__span-29-148"><a id="__codelineno-29-148" name="__codelineno-29-148"></a><span class="w">    </span><span class="n">va_start</span><span class="p">(</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="n">format</span><span class="p">);</span>
</span><span id="__span-29-149"><a id="__codelineno-29-149" name="__codelineno-29-149"></a><span class="w">    </span><span class="n">CString</span><span class="w"> </span><span class="n">message</span><span class="p">;</span>
</span><span id="__span-29-150"><a id="__codelineno-29-150" name="__codelineno-29-150"></a><span class="w">    </span><span class="n">message</span><span class="p">.</span><span class="n">FormatV</span><span class="p">(</span><span class="n">format</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
</span><span id="__span-29-151"><a id="__codelineno-29-151" name="__codelineno-29-151"></a><span class="w">    </span><span class="n">va_end</span><span class="p">(</span><span class="n">args</span><span class="p">);</span>
</span><span id="__span-29-152"><a id="__codelineno-29-152" name="__codelineno-29-152"></a><span class="w">    </span><span class="n">Info</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
</span><span id="__span-29-153"><a id="__codelineno-29-153" name="__codelineno-29-153"></a><span class="p">}</span>
</span><span id="__span-29-154"><a id="__codelineno-29-154" name="__codelineno-29-154"></a>
</span><span id="__span-29-155"><a id="__codelineno-29-155" name="__codelineno-29-155"></a><span class="kt">void</span><span class="w"> </span><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">WarningFormat</span><span class="p">(</span><span class="n">LPCTSTR</span><span class="w"> </span><span class="n">format</span><span class="p">,</span><span class="w"> </span><span class="p">...)</span>
</span><span id="__span-29-156"><a id="__codelineno-29-156" name="__codelineno-29-156"></a><span class="p">{</span>
</span><span id="__span-29-157"><a id="__codelineno-29-157" name="__codelineno-29-157"></a><span class="w">    </span><span class="kt">va_list</span><span class="w"> </span><span class="n">args</span><span class="p">;</span>
</span><span id="__span-29-158"><a id="__codelineno-29-158" name="__codelineno-29-158"></a><span class="w">    </span><span class="n">va_start</span><span class="p">(</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="n">format</span><span class="p">);</span>
</span><span id="__span-29-159"><a id="__codelineno-29-159" name="__codelineno-29-159"></a><span class="w">    </span><span class="n">CString</span><span class="w"> </span><span class="n">message</span><span class="p">;</span>
</span><span id="__span-29-160"><a id="__codelineno-29-160" name="__codelineno-29-160"></a><span class="w">    </span><span class="n">message</span><span class="p">.</span><span class="n">FormatV</span><span class="p">(</span><span class="n">format</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
</span><span id="__span-29-161"><a id="__codelineno-29-161" name="__codelineno-29-161"></a><span class="w">    </span><span class="n">va_end</span><span class="p">(</span><span class="n">args</span><span class="p">);</span>
</span><span id="__span-29-162"><a id="__codelineno-29-162" name="__codelineno-29-162"></a><span class="w">    </span><span class="n">Warning</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
</span><span id="__span-29-163"><a id="__codelineno-29-163" name="__codelineno-29-163"></a><span class="p">}</span>
</span><span id="__span-29-164"><a id="__codelineno-29-164" name="__codelineno-29-164"></a>
</span><span id="__span-29-165"><a id="__codelineno-29-165" name="__codelineno-29-165"></a><span class="kt">void</span><span class="w"> </span><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">ErrorFormat</span><span class="p">(</span><span class="n">LPCTSTR</span><span class="w"> </span><span class="n">format</span><span class="p">,</span><span class="w"> </span><span class="p">...)</span>
</span><span id="__span-29-166"><a id="__codelineno-29-166" name="__codelineno-29-166"></a><span class="p">{</span>
</span><span id="__span-29-167"><a id="__codelineno-29-167" name="__codelineno-29-167"></a><span class="w">    </span><span class="kt">va_list</span><span class="w"> </span><span class="n">args</span><span class="p">;</span>
</span><span id="__span-29-168"><a id="__codelineno-29-168" name="__codelineno-29-168"></a><span class="w">    </span><span class="n">va_start</span><span class="p">(</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="n">format</span><span class="p">);</span>
</span><span id="__span-29-169"><a id="__codelineno-29-169" name="__codelineno-29-169"></a><span class="w">    </span><span class="n">CString</span><span class="w"> </span><span class="n">message</span><span class="p">;</span>
</span><span id="__span-29-170"><a id="__codelineno-29-170" name="__codelineno-29-170"></a><span class="w">    </span><span class="n">message</span><span class="p">.</span><span class="n">FormatV</span><span class="p">(</span><span class="n">format</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
</span><span id="__span-29-171"><a id="__codelineno-29-171" name="__codelineno-29-171"></a><span class="w">    </span><span class="n">va_end</span><span class="p">(</span><span class="n">args</span><span class="p">);</span>
</span><span id="__span-29-172"><a id="__codelineno-29-172" name="__codelineno-29-172"></a><span class="w">    </span><span class="n">Error</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
</span><span id="__span-29-173"><a id="__codelineno-29-173" name="__codelineno-29-173"></a><span class="p">}</span>
</span><span id="__span-29-174"><a id="__codelineno-29-174" name="__codelineno-29-174"></a>
</span><span id="__span-29-175"><a id="__codelineno-29-175" name="__codelineno-29-175"></a><span class="c1">// ========== 输出控制 ==========</span>
</span><span id="__span-29-176"><a id="__codelineno-29-176" name="__codelineno-29-176"></a>
</span><span id="__span-29-177"><a id="__codelineno-29-177" name="__codelineno-29-177"></a><span class="kt">void</span><span class="w"> </span><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">EnableConsoleOutput</span><span class="p">(</span><span class="kt">bool</span><span class="w"> </span><span class="n">enable</span><span class="p">)</span>
</span><span id="__span-29-178"><a id="__codelineno-29-178" name="__codelineno-29-178"></a><span class="p">{</span>
</span><span id="__span-29-179"><a id="__codelineno-29-179" name="__codelineno-29-179"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">lock_guard</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">mutex</span><span class="o">&gt;</span><span class="w"> </span><span class="n">lock</span><span class="p">(</span><span class="n">m_mutex</span><span class="p">);</span>
</span><span id="__span-29-180"><a id="__codelineno-29-180" name="__codelineno-29-180"></a><span class="w">    </span><span class="n">m_consoleOutput</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">enable</span><span class="p">;</span>
</span><span id="__span-29-181"><a id="__codelineno-29-181" name="__codelineno-29-181"></a>
</span><span id="__span-29-182"><a id="__codelineno-29-182" name="__codelineno-29-182"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">enable</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m_fileOutput</span><span class="p">)</span>
</span><span id="__span-29-183"><a id="__codelineno-29-183" name="__codelineno-29-183"></a><span class="w">        </span><span class="n">m_logTarget</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LogTarget</span><span class="o">::</span><span class="n">Both</span><span class="p">;</span>
</span><span id="__span-29-184"><a id="__codelineno-29-184" name="__codelineno-29-184"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">enable</span><span class="p">)</span>
</span><span id="__span-29-185"><a id="__codelineno-29-185" name="__codelineno-29-185"></a><span class="w">        </span><span class="n">m_logTarget</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LogTarget</span><span class="o">::</span><span class="n">Console</span><span class="p">;</span>
</span><span id="__span-29-186"><a id="__codelineno-29-186" name="__codelineno-29-186"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_fileOutput</span><span class="p">)</span>
</span><span id="__span-29-187"><a id="__codelineno-29-187" name="__codelineno-29-187"></a><span class="w">        </span><span class="n">m_logTarget</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LogTarget</span><span class="o">::</span><span class="n">File</span><span class="p">;</span>
</span><span id="__span-29-188"><a id="__codelineno-29-188" name="__codelineno-29-188"></a><span class="w">    </span><span class="k">else</span>
</span><span id="__span-29-189"><a id="__codelineno-29-189" name="__codelineno-29-189"></a><span class="w">        </span><span class="n">m_logTarget</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LogTarget</span><span class="o">::</span><span class="n">None</span><span class="p">;</span>
</span><span id="__span-29-190"><a id="__codelineno-29-190" name="__codelineno-29-190"></a><span class="p">}</span>
</span><span id="__span-29-191"><a id="__codelineno-29-191" name="__codelineno-29-191"></a>
</span><span id="__span-29-192"><a id="__codelineno-29-192" name="__codelineno-29-192"></a><span class="kt">void</span><span class="w"> </span><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">EnableFileOutput</span><span class="p">(</span><span class="kt">bool</span><span class="w"> </span><span class="n">enable</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">CString</span><span class="o">&amp;</span><span class="w"> </span><span class="n">filePath</span><span class="p">)</span>
</span><span id="__span-29-193"><a id="__codelineno-29-193" name="__codelineno-29-193"></a><span class="p">{</span>
</span><span id="__span-29-194"><a id="__codelineno-29-194" name="__codelineno-29-194"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">lock_guard</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">mutex</span><span class="o">&gt;</span><span class="w"> </span><span class="n">lock</span><span class="p">(</span><span class="n">m_mutex</span><span class="p">);</span>
</span><span id="__span-29-195"><a id="__codelineno-29-195" name="__codelineno-29-195"></a>
</span><span id="__span-29-196"><a id="__codelineno-29-196" name="__codelineno-29-196"></a><span class="w">    </span><span class="n">m_fileOutput</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">enable</span><span class="p">;</span>
</span><span id="__span-29-197"><a id="__codelineno-29-197" name="__codelineno-29-197"></a>
</span><span id="__span-29-198"><a id="__codelineno-29-198" name="__codelineno-29-198"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">enable</span><span class="p">)</span>
</span><span id="__span-29-199"><a id="__codelineno-29-199" name="__codelineno-29-199"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-29-200"><a id="__codelineno-29-200" name="__codelineno-29-200"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">filePath</span><span class="p">.</span><span class="n">IsEmpty</span><span class="p">())</span>
</span><span id="__span-29-201"><a id="__codelineno-29-201" name="__codelineno-29-201"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-29-202"><a id="__codelineno-29-202" name="__codelineno-29-202"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_fileOpened</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m_logFilePath</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">filePath</span><span class="p">)</span>
</span><span id="__span-29-203"><a id="__codelineno-29-203" name="__codelineno-29-203"></a><span class="w">            </span><span class="p">{</span>
</span><span id="__span-29-204"><a id="__codelineno-29-204" name="__codelineno-29-204"></a><span class="w">                </span><span class="c1">// 文件路径变化，关闭旧文件</span>
</span><span id="__span-29-205"><a id="__codelineno-29-205" name="__codelineno-29-205"></a><span class="w">                </span><span class="n">CloseLogFile</span><span class="p">();</span>
</span><span id="__span-29-206"><a id="__codelineno-29-206" name="__codelineno-29-206"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-29-207"><a id="__codelineno-29-207" name="__codelineno-29-207"></a><span class="w">            </span><span class="n">m_logFilePath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">filePath</span><span class="p">;</span>
</span><span id="__span-29-208"><a id="__codelineno-29-208" name="__codelineno-29-208"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-29-209"><a id="__codelineno-29-209" name="__codelineno-29-209"></a>
</span><span id="__span-29-210"><a id="__codelineno-29-210" name="__codelineno-29-210"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">m_fileOpened</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">m_logFilePath</span><span class="p">.</span><span class="n">IsEmpty</span><span class="p">())</span>
</span><span id="__span-29-211"><a id="__codelineno-29-211" name="__codelineno-29-211"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-29-212"><a id="__codelineno-29-212" name="__codelineno-29-212"></a><span class="w">            </span><span class="n">OpenLogFile</span><span class="p">();</span>
</span><span id="__span-29-213"><a id="__codelineno-29-213" name="__codelineno-29-213"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-29-214"><a id="__codelineno-29-214" name="__codelineno-29-214"></a>
</span><span id="__span-29-215"><a id="__codelineno-29-215" name="__codelineno-29-215"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_consoleOutput</span><span class="p">)</span>
</span><span id="__span-29-216"><a id="__codelineno-29-216" name="__codelineno-29-216"></a><span class="w">            </span><span class="n">m_logTarget</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LogTarget</span><span class="o">::</span><span class="n">Both</span><span class="p">;</span>
</span><span id="__span-29-217"><a id="__codelineno-29-217" name="__codelineno-29-217"></a><span class="w">        </span><span class="k">else</span>
</span><span id="__span-29-218"><a id="__codelineno-29-218" name="__codelineno-29-218"></a><span class="w">            </span><span class="n">m_logTarget</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LogTarget</span><span class="o">::</span><span class="n">File</span><span class="p">;</span>
</span><span id="__span-29-219"><a id="__codelineno-29-219" name="__codelineno-29-219"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-29-220"><a id="__codelineno-29-220" name="__codelineno-29-220"></a><span class="w">    </span><span class="k">else</span>
</span><span id="__span-29-221"><a id="__codelineno-29-221" name="__codelineno-29-221"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-29-222"><a id="__codelineno-29-222" name="__codelineno-29-222"></a><span class="w">        </span><span class="n">CloseLogFile</span><span class="p">();</span>
</span><span id="__span-29-223"><a id="__codelineno-29-223" name="__codelineno-29-223"></a><span class="w">        </span><span class="n">m_logTarget</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_consoleOutput</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">LogTarget</span><span class="o">::</span><span class="n">Console</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">LogTarget</span><span class="o">::</span><span class="n">None</span><span class="p">;</span>
</span><span id="__span-29-224"><a id="__codelineno-29-224" name="__codelineno-29-224"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-29-225"><a id="__codelineno-29-225" name="__codelineno-29-225"></a><span class="p">}</span>
</span><span id="__span-29-226"><a id="__codelineno-29-226" name="__codelineno-29-226"></a>
</span><span id="__span-29-227"><a id="__codelineno-29-227" name="__codelineno-29-227"></a><span class="kt">void</span><span class="w"> </span><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">SetLogTarget</span><span class="p">(</span><span class="n">LogTarget</span><span class="w"> </span><span class="n">target</span><span class="p">)</span>
</span><span id="__span-29-228"><a id="__codelineno-29-228" name="__codelineno-29-228"></a><span class="p">{</span>
</span><span id="__span-29-229"><a id="__codelineno-29-229" name="__codelineno-29-229"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">lock_guard</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">mutex</span><span class="o">&gt;</span><span class="w"> </span><span class="n">lock</span><span class="p">(</span><span class="n">m_mutex</span><span class="p">);</span>
</span><span id="__span-29-230"><a id="__codelineno-29-230" name="__codelineno-29-230"></a>
</span><span id="__span-29-231"><a id="__codelineno-29-231" name="__codelineno-29-231"></a><span class="w">    </span><span class="n">m_logTarget</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">target</span><span class="p">;</span>
</span><span id="__span-29-232"><a id="__codelineno-29-232" name="__codelineno-29-232"></a><span class="w">    </span><span class="n">m_consoleOutput</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">target</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">LogTarget</span><span class="o">::</span><span class="n">Console</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">LogTarget</span><span class="o">::</span><span class="n">Both</span><span class="p">);</span>
</span><span id="__span-29-233"><a id="__codelineno-29-233" name="__codelineno-29-233"></a><span class="w">    </span><span class="n">m_fileOutput</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">target</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">LogTarget</span><span class="o">::</span><span class="n">File</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">LogTarget</span><span class="o">::</span><span class="n">Both</span><span class="p">);</span>
</span><span id="__span-29-234"><a id="__codelineno-29-234" name="__codelineno-29-234"></a>
</span><span id="__span-29-235"><a id="__codelineno-29-235" name="__codelineno-29-235"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_fileOutput</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">m_fileOpened</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">m_logFilePath</span><span class="p">.</span><span class="n">IsEmpty</span><span class="p">())</span>
</span><span id="__span-29-236"><a id="__codelineno-29-236" name="__codelineno-29-236"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-29-237"><a id="__codelineno-29-237" name="__codelineno-29-237"></a><span class="w">        </span><span class="n">OpenLogFile</span><span class="p">();</span>
</span><span id="__span-29-238"><a id="__codelineno-29-238" name="__codelineno-29-238"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-29-239"><a id="__codelineno-29-239" name="__codelineno-29-239"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">m_fileOutput</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m_fileOpened</span><span class="p">)</span>
</span><span id="__span-29-240"><a id="__codelineno-29-240" name="__codelineno-29-240"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-29-241"><a id="__codelineno-29-241" name="__codelineno-29-241"></a><span class="w">        </span><span class="n">CloseLogFile</span><span class="p">();</span>
</span><span id="__span-29-242"><a id="__codelineno-29-242" name="__codelineno-29-242"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-29-243"><a id="__codelineno-29-243" name="__codelineno-29-243"></a><span class="p">}</span>
</span><span id="__span-29-244"><a id="__codelineno-29-244" name="__codelineno-29-244"></a>
</span><span id="__span-29-245"><a id="__codelineno-29-245" name="__codelineno-29-245"></a><span class="kt">void</span><span class="w"> </span><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">Flush</span><span class="p">()</span>
</span><span id="__span-29-246"><a id="__codelineno-29-246" name="__codelineno-29-246"></a><span class="p">{</span>
</span><span id="__span-29-247"><a id="__codelineno-29-247" name="__codelineno-29-247"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">lock_guard</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">mutex</span><span class="o">&gt;</span><span class="w"> </span><span class="n">lock</span><span class="p">(</span><span class="n">m_mutex</span><span class="p">);</span>
</span><span id="__span-29-248"><a id="__codelineno-29-248" name="__codelineno-29-248"></a>
</span><span id="__span-29-249"><a id="__codelineno-29-249" name="__codelineno-29-249"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_fileOpened</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m_logFile</span><span class="p">.</span><span class="n">is_open</span><span class="p">())</span>
</span><span id="__span-29-250"><a id="__codelineno-29-250" name="__codelineno-29-250"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-29-251"><a id="__codelineno-29-251" name="__codelineno-29-251"></a><span class="w">        </span><span class="n">m_logFile</span><span class="p">.</span><span class="n">flush</span><span class="p">();</span>
</span><span id="__span-29-252"><a id="__codelineno-29-252" name="__codelineno-29-252"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-29-253"><a id="__codelineno-29-253" name="__codelineno-29-253"></a><span class="p">}</span>
</span><span id="__span-29-254"><a id="__codelineno-29-254" name="__codelineno-29-254"></a>
</span><span id="__span-29-255"><a id="__codelineno-29-255" name="__codelineno-29-255"></a><span class="c1">// ========== 文件管理 ==========</span>
</span><span id="__span-29-256"><a id="__codelineno-29-256" name="__codelineno-29-256"></a>
</span><span id="__span-29-257"><a id="__codelineno-29-257" name="__codelineno-29-257"></a><span class="kt">void</span><span class="w"> </span><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">SetMaxFileSize</span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">maxSize</span><span class="p">)</span>
</span><span id="__span-29-258"><a id="__codelineno-29-258" name="__codelineno-29-258"></a><span class="p">{</span>
</span><span id="__span-29-259"><a id="__codelineno-29-259" name="__codelineno-29-259"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">lock_guard</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">mutex</span><span class="o">&gt;</span><span class="w"> </span><span class="n">lock</span><span class="p">(</span><span class="n">m_mutex</span><span class="p">);</span>
</span><span id="__span-29-260"><a id="__codelineno-29-260" name="__codelineno-29-260"></a><span class="w">    </span><span class="n">m_maxFileSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">maxSize</span><span class="p">;</span>
</span><span id="__span-29-261"><a id="__codelineno-29-261" name="__codelineno-29-261"></a><span class="p">}</span>
</span><span id="__span-29-262"><a id="__codelineno-29-262" name="__codelineno-29-262"></a>
</span><span id="__span-29-263"><a id="__codelineno-29-263" name="__codelineno-29-263"></a><span class="kt">void</span><span class="w"> </span><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">SetMaxBackupFiles</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">maxFiles</span><span class="p">)</span>
</span><span id="__span-29-264"><a id="__codelineno-29-264" name="__codelineno-29-264"></a><span class="p">{</span>
</span><span id="__span-29-265"><a id="__codelineno-29-265" name="__codelineno-29-265"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">lock_guard</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">mutex</span><span class="o">&gt;</span><span class="w"> </span><span class="n">lock</span><span class="p">(</span><span class="n">m_mutex</span><span class="p">);</span>
</span><span id="__span-29-266"><a id="__codelineno-29-266" name="__codelineno-29-266"></a><span class="w">    </span><span class="n">m_maxBackupFiles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">maxFiles</span><span class="p">;</span>
</span><span id="__span-29-267"><a id="__codelineno-29-267" name="__codelineno-29-267"></a><span class="p">}</span>
</span><span id="__span-29-268"><a id="__codelineno-29-268" name="__codelineno-29-268"></a>
</span><span id="__span-29-269"><a id="__codelineno-29-269" name="__codelineno-29-269"></a><span class="kt">void</span><span class="w"> </span><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">RotateLogFile</span><span class="p">()</span>
</span><span id="__span-29-270"><a id="__codelineno-29-270" name="__codelineno-29-270"></a><span class="p">{</span>
</span><span id="__span-29-271"><a id="__codelineno-29-271" name="__codelineno-29-271"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">lock_guard</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">mutex</span><span class="o">&gt;</span><span class="w"> </span><span class="n">lock</span><span class="p">(</span><span class="n">m_mutex</span><span class="p">);</span>
</span><span id="__span-29-272"><a id="__codelineno-29-272" name="__codelineno-29-272"></a>
</span><span id="__span-29-273"><a id="__codelineno-29-273" name="__codelineno-29-273"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">m_fileOpened</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">m_logFilePath</span><span class="p">.</span><span class="n">IsEmpty</span><span class="p">())</span>
</span><span id="__span-29-274"><a id="__codelineno-29-274" name="__codelineno-29-274"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-29-275"><a id="__codelineno-29-275" name="__codelineno-29-275"></a><span class="w">        </span><span class="k">return</span><span class="p">;</span>
</span><span id="__span-29-276"><a id="__codelineno-29-276" name="__codelineno-29-276"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-29-277"><a id="__codelineno-29-277" name="__codelineno-29-277"></a>
</span><span id="__span-29-278"><a id="__codelineno-29-278" name="__codelineno-29-278"></a><span class="w">    </span><span class="n">CloseLogFile</span><span class="p">();</span>
</span><span id="__span-29-279"><a id="__codelineno-29-279" name="__codelineno-29-279"></a><span class="w">    </span><span class="n">RotateBackupFiles</span><span class="p">();</span>
</span><span id="__span-29-280"><a id="__codelineno-29-280" name="__codelineno-29-280"></a><span class="w">    </span><span class="n">OpenLogFile</span><span class="p">();</span>
</span><span id="__span-29-281"><a id="__codelineno-29-281" name="__codelineno-29-281"></a><span class="p">}</span>
</span><span id="__span-29-282"><a id="__codelineno-29-282" name="__codelineno-29-282"></a>
</span><span id="__span-29-283"><a id="__codelineno-29-283" name="__codelineno-29-283"></a><span class="c1">// ========== 核心日志记录 ==========</span>
</span><span id="__span-29-284"><a id="__codelineno-29-284" name="__codelineno-29-284"></a>
</span><span id="__span-29-285"><a id="__codelineno-29-285" name="__codelineno-29-285"></a><span class="kt">void</span><span class="w"> </span><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">Log</span><span class="p">(</span><span class="n">LogLevel</span><span class="w"> </span><span class="n">level</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">CString</span><span class="o">&amp;</span><span class="w"> </span><span class="n">message</span><span class="p">)</span>
</span><span id="__span-29-286"><a id="__codelineno-29-286" name="__codelineno-29-286"></a><span class="p">{</span>
</span><span id="__span-29-287"><a id="__codelineno-29-287" name="__codelineno-29-287"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">lock_guard</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">mutex</span><span class="o">&gt;</span><span class="w"> </span><span class="n">lock</span><span class="p">(</span><span class="n">m_mutex</span><span class="p">);</span>
</span><span id="__span-29-288"><a id="__codelineno-29-288" name="__codelineno-29-288"></a><span class="w">    </span><span class="n">LogInternal</span><span class="p">(</span><span class="n">level</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="p">);</span>
</span><span id="__span-29-289"><a id="__codelineno-29-289" name="__codelineno-29-289"></a><span class="p">}</span>
</span><span id="__span-29-290"><a id="__codelineno-29-290" name="__codelineno-29-290"></a>
</span><span id="__span-29-291"><a id="__codelineno-29-291" name="__codelineno-29-291"></a><span class="kt">void</span><span class="w"> </span><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">LogInternal</span><span class="p">(</span><span class="n">LogLevel</span><span class="w"> </span><span class="n">level</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">CString</span><span class="o">&amp;</span><span class="w"> </span><span class="n">message</span><span class="p">)</span>
</span><span id="__span-29-292"><a id="__codelineno-29-292" name="__codelineno-29-292"></a><span class="p">{</span>
</span><span id="__span-29-293"><a id="__codelineno-29-293" name="__codelineno-29-293"></a><span class="w">    </span><span class="c1">// 注意：此方法假定调用者已经持有锁</span>
</span><span id="__span-29-294"><a id="__codelineno-29-294" name="__codelineno-29-294"></a>
</span><span id="__span-29-295"><a id="__codelineno-29-295" name="__codelineno-29-295"></a><span class="w">    </span><span class="c1">// 检查日志级别</span>
</span><span id="__span-29-296"><a id="__codelineno-29-296" name="__codelineno-29-296"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">level</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">m_logLevel</span><span class="p">)</span>
</span><span id="__span-29-297"><a id="__codelineno-29-297" name="__codelineno-29-297"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-29-298"><a id="__codelineno-29-298" name="__codelineno-29-298"></a><span class="w">        </span><span class="k">return</span><span class="p">;</span>
</span><span id="__span-29-299"><a id="__codelineno-29-299" name="__codelineno-29-299"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-29-300"><a id="__codelineno-29-300" name="__codelineno-29-300"></a>
</span><span id="__span-29-301"><a id="__codelineno-29-301" name="__codelineno-29-301"></a><span class="w">    </span><span class="c1">// 格式化消息</span>
</span><span id="__span-29-302"><a id="__codelineno-29-302" name="__codelineno-29-302"></a><span class="w">    </span><span class="n">CString</span><span class="w"> </span><span class="n">fullMessage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FormatMessage</span><span class="p">(</span><span class="n">level</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="p">);</span>
</span><span id="__span-29-303"><a id="__codelineno-29-303" name="__codelineno-29-303"></a>
</span><span id="__span-29-304"><a id="__codelineno-29-304" name="__codelineno-29-304"></a><span class="w">    </span><span class="c1">// 输出到控制台</span>
</span><span id="__span-29-305"><a id="__codelineno-29-305" name="__codelineno-29-305"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_logTarget</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">LogTarget</span><span class="o">::</span><span class="n">Console</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">m_logTarget</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">LogTarget</span><span class="o">::</span><span class="n">Both</span><span class="p">)</span>
</span><span id="__span-29-306"><a id="__codelineno-29-306" name="__codelineno-29-306"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-29-307"><a id="__codelineno-29-307" name="__codelineno-29-307"></a><span class="w">        </span><span class="n">WriteToConsole</span><span class="p">(</span><span class="n">fullMessage</span><span class="p">);</span>
</span><span id="__span-29-308"><a id="__codelineno-29-308" name="__codelineno-29-308"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-29-309"><a id="__codelineno-29-309" name="__codelineno-29-309"></a>
</span><span id="__span-29-310"><a id="__codelineno-29-310" name="__codelineno-29-310"></a><span class="w">    </span><span class="c1">// 输出到文件</span>
</span><span id="__span-29-311"><a id="__codelineno-29-311" name="__codelineno-29-311"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_logTarget</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">LogTarget</span><span class="o">::</span><span class="n">File</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">m_logTarget</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">LogTarget</span><span class="o">::</span><span class="n">Both</span><span class="p">)</span>
</span><span id="__span-29-312"><a id="__codelineno-29-312" name="__codelineno-29-312"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-29-313"><a id="__codelineno-29-313" name="__codelineno-29-313"></a><span class="w">        </span><span class="c1">// 检查是否需要轮转</span>
</span><span id="__span-29-314"><a id="__codelineno-29-314" name="__codelineno-29-314"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_maxFileSize</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-29-315"><a id="__codelineno-29-315" name="__codelineno-29-315"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-29-316"><a id="__codelineno-29-316" name="__codelineno-29-316"></a><span class="w">            </span><span class="n">CheckAndRotateFile</span><span class="p">();</span>
</span><span id="__span-29-317"><a id="__codelineno-29-317" name="__codelineno-29-317"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-29-318"><a id="__codelineno-29-318" name="__codelineno-29-318"></a>
</span><span id="__span-29-319"><a id="__codelineno-29-319" name="__codelineno-29-319"></a><span class="w">        </span><span class="n">WriteToFile</span><span class="p">(</span><span class="n">fullMessage</span><span class="p">);</span>
</span><span id="__span-29-320"><a id="__codelineno-29-320" name="__codelineno-29-320"></a>
</span><span id="__span-29-321"><a id="__codelineno-29-321" name="__codelineno-29-321"></a><span class="w">        </span><span class="c1">// 自动刷新</span>
</span><span id="__span-29-322"><a id="__codelineno-29-322" name="__codelineno-29-322"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_autoFlush</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m_logFile</span><span class="p">.</span><span class="n">is_open</span><span class="p">())</span>
</span><span id="__span-29-323"><a id="__codelineno-29-323" name="__codelineno-29-323"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-29-324"><a id="__codelineno-29-324" name="__codelineno-29-324"></a><span class="w">            </span><span class="n">m_logFile</span><span class="p">.</span><span class="n">flush</span><span class="p">();</span>
</span><span id="__span-29-325"><a id="__codelineno-29-325" name="__codelineno-29-325"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-29-326"><a id="__codelineno-29-326" name="__codelineno-29-326"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-29-327"><a id="__codelineno-29-327" name="__codelineno-29-327"></a><span class="p">}</span>
</span><span id="__span-29-328"><a id="__codelineno-29-328" name="__codelineno-29-328"></a>
</span><span id="__span-29-329"><a id="__codelineno-29-329" name="__codelineno-29-329"></a><span class="n">CString</span><span class="w"> </span><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">GetLevelString</span><span class="p">(</span><span class="n">LogLevel</span><span class="w"> </span><span class="n">level</span><span class="p">)</span>
</span><span id="__span-29-330"><a id="__codelineno-29-330" name="__codelineno-29-330"></a><span class="p">{</span>
</span><span id="__span-29-331"><a id="__codelineno-29-331" name="__codelineno-29-331"></a><span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">level</span><span class="p">)</span>
</span><span id="__span-29-332"><a id="__codelineno-29-332" name="__codelineno-29-332"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-29-333"><a id="__codelineno-29-333" name="__codelineno-29-333"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="no">LogLevel</span><span class="o">::</span><span class="no">Debug</span><span class="p">:</span>
</span><span id="__span-29-334"><a id="__codelineno-29-334" name="__codelineno-29-334"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">_T</span><span class="p">(</span><span class="s">"DEBUG"</span><span class="p">);</span>
</span><span id="__span-29-335"><a id="__codelineno-29-335" name="__codelineno-29-335"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="no">LogLevel</span><span class="o">::</span><span class="no">Info</span><span class="p">:</span>
</span><span id="__span-29-336"><a id="__codelineno-29-336" name="__codelineno-29-336"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">_T</span><span class="p">(</span><span class="s">"INFO"</span><span class="p">);</span>
</span><span id="__span-29-337"><a id="__codelineno-29-337" name="__codelineno-29-337"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="no">LogLevel</span><span class="o">::</span><span class="no">Warning</span><span class="p">:</span>
</span><span id="__span-29-338"><a id="__codelineno-29-338" name="__codelineno-29-338"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">_T</span><span class="p">(</span><span class="s">"WARN"</span><span class="p">);</span>
</span><span id="__span-29-339"><a id="__codelineno-29-339" name="__codelineno-29-339"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="no">LogLevel</span><span class="o">::</span><span class="no">Error</span><span class="p">:</span>
</span><span id="__span-29-340"><a id="__codelineno-29-340" name="__codelineno-29-340"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">_T</span><span class="p">(</span><span class="s">"ERROR"</span><span class="p">);</span>
</span><span id="__span-29-341"><a id="__codelineno-29-341" name="__codelineno-29-341"></a><span class="w">    </span><span class="k">default</span><span class="o">:</span>
</span><span id="__span-29-342"><a id="__codelineno-29-342" name="__codelineno-29-342"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">_T</span><span class="p">(</span><span class="s">"UNKNOWN"</span><span class="p">);</span>
</span><span id="__span-29-343"><a id="__codelineno-29-343" name="__codelineno-29-343"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-29-344"><a id="__codelineno-29-344" name="__codelineno-29-344"></a><span class="p">}</span>
</span><span id="__span-29-345"><a id="__codelineno-29-345" name="__codelineno-29-345"></a>
</span><span id="__span-29-346"><a id="__codelineno-29-346" name="__codelineno-29-346"></a><span class="n">CString</span><span class="w"> </span><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">GetTimestamp</span><span class="p">()</span>
</span><span id="__span-29-347"><a id="__codelineno-29-347" name="__codelineno-29-347"></a><span class="p">{</span>
</span><span id="__span-29-348"><a id="__codelineno-29-348" name="__codelineno-29-348"></a><span class="w">    </span><span class="n">SYSTEMTIME</span><span class="w"> </span><span class="n">st</span><span class="p">;</span>
</span><span id="__span-29-349"><a id="__codelineno-29-349" name="__codelineno-29-349"></a><span class="w">    </span><span class="n">GetLocalTime</span><span class="p">(</span><span class="o">&amp;</span><span class="n">st</span><span class="p">);</span>
</span><span id="__span-29-350"><a id="__codelineno-29-350" name="__codelineno-29-350"></a><span class="w">    </span><span class="n">CString</span><span class="w"> </span><span class="n">timestamp</span><span class="p">;</span>
</span><span id="__span-29-351"><a id="__codelineno-29-351" name="__codelineno-29-351"></a><span class="w">    </span><span class="n">timestamp</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"%04d-%02d-%02d %02d:%02d:%02d.%03d"</span><span class="p">),</span>
</span><span id="__span-29-352"><a id="__codelineno-29-352" name="__codelineno-29-352"></a><span class="w">        </span><span class="n">st</span><span class="p">.</span><span class="n">wYear</span><span class="p">,</span><span class="w"> </span><span class="n">st</span><span class="p">.</span><span class="n">wMonth</span><span class="p">,</span><span class="w"> </span><span class="n">st</span><span class="p">.</span><span class="n">wDay</span><span class="p">,</span>
</span><span id="__span-29-353"><a id="__codelineno-29-353" name="__codelineno-29-353"></a><span class="w">        </span><span class="n">st</span><span class="p">.</span><span class="n">wHour</span><span class="p">,</span><span class="w"> </span><span class="n">st</span><span class="p">.</span><span class="n">wMinute</span><span class="p">,</span><span class="w"> </span><span class="n">st</span><span class="p">.</span><span class="n">wSecond</span><span class="p">,</span><span class="w"> </span><span class="n">st</span><span class="p">.</span><span class="n">wMilliseconds</span><span class="p">);</span>
</span><span id="__span-29-354"><a id="__codelineno-29-354" name="__codelineno-29-354"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">timestamp</span><span class="p">;</span>
</span><span id="__span-29-355"><a id="__codelineno-29-355" name="__codelineno-29-355"></a><span class="p">}</span>
</span><span id="__span-29-356"><a id="__codelineno-29-356" name="__codelineno-29-356"></a>
</span><span id="__span-29-357"><a id="__codelineno-29-357" name="__codelineno-29-357"></a><span class="c1">// ========== 内部辅助方法 ==========</span>
</span><span id="__span-29-358"><a id="__codelineno-29-358" name="__codelineno-29-358"></a>
</span><span id="__span-29-359"><a id="__codelineno-29-359" name="__codelineno-29-359"></a><span class="kt">void</span><span class="w"> </span><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">WriteToConsole</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CString</span><span class="o">&amp;</span><span class="w"> </span><span class="n">message</span><span class="p">)</span>
</span><span id="__span-29-360"><a id="__codelineno-29-360" name="__codelineno-29-360"></a><span class="p">{</span>
</span><span id="__span-29-361"><a id="__codelineno-29-361" name="__codelineno-29-361"></a><span class="w">    </span><span class="c1">// 输出到 AutoCAD 控制台（每条日志独立成行）</span>
</span><span id="__span-29-362"><a id="__codelineno-29-362" name="__codelineno-29-362"></a><span class="w">    </span><span class="n">acutPrintf</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">%s"</span><span class="p">),</span><span class="w"> </span><span class="n">message</span><span class="p">);</span>
</span><span id="__span-29-363"><a id="__codelineno-29-363" name="__codelineno-29-363"></a><span class="p">}</span>
</span><span id="__span-29-364"><a id="__codelineno-29-364" name="__codelineno-29-364"></a>
</span><span id="__span-29-365"><a id="__codelineno-29-365" name="__codelineno-29-365"></a><span class="kt">void</span><span class="w"> </span><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">WriteToFile</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">CString</span><span class="o">&amp;</span><span class="w"> </span><span class="n">message</span><span class="p">)</span>
</span><span id="__span-29-366"><a id="__codelineno-29-366" name="__codelineno-29-366"></a><span class="p">{</span>
</span><span id="__span-29-367"><a id="__codelineno-29-367" name="__codelineno-29-367"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">m_fileOpened</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">!</span><span class="n">m_logFile</span><span class="p">.</span><span class="n">is_open</span><span class="p">())</span>
</span><span id="__span-29-368"><a id="__codelineno-29-368" name="__codelineno-29-368"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-29-369"><a id="__codelineno-29-369" name="__codelineno-29-369"></a><span class="w">        </span><span class="k">return</span><span class="p">;</span>
</span><span id="__span-29-370"><a id="__codelineno-29-370" name="__codelineno-29-370"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-29-371"><a id="__codelineno-29-371" name="__codelineno-29-371"></a>
</span><span id="__span-29-372"><a id="__codelineno-29-372" name="__codelineno-29-372"></a><span class="w">    </span><span class="k">try</span>
</span><span id="__span-29-373"><a id="__codelineno-29-373" name="__codelineno-29-373"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-29-374"><a id="__codelineno-29-374" name="__codelineno-29-374"></a><span class="w">        </span><span class="c1">// 按行写入，确保每条日志独立成行</span>
</span><span id="__span-29-375"><a id="__codelineno-29-375" name="__codelineno-29-375"></a><span class="w">        </span><span class="n">m_logFile</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">message</span><span class="p">.</span><span class="n">GetString</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span><span id="__span-29-376"><a id="__codelineno-29-376" name="__codelineno-29-376"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-29-377"><a id="__codelineno-29-377" name="__codelineno-29-377"></a><span class="w">    </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">exception</span><span class="o">&amp;</span><span class="w"> </span><span class="n">e</span><span class="p">)</span>
</span><span id="__span-29-378"><a id="__codelineno-29-378" name="__codelineno-29-378"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-29-379"><a id="__codelineno-29-379" name="__codelineno-29-379"></a><span class="w">        </span><span class="c1">// 文件写入失败，输出到控制台</span>
</span><span id="__span-29-380"><a id="__codelineno-29-380" name="__codelineno-29-380"></a><span class="w">        </span><span class="n">CString</span><span class="w"> </span><span class="n">errorMsg</span><span class="p">;</span>
</span><span id="__span-29-381"><a id="__codelineno-29-381" name="__codelineno-29-381"></a><span class="w">        </span><span class="n">errorMsg</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"日志文件写入失败: %s"</span><span class="p">),</span><span class="w"> </span><span class="n">CString</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">what</span><span class="p">()));</span>
</span><span id="__span-29-382"><a id="__codelineno-29-382" name="__codelineno-29-382"></a><span class="w">        </span><span class="n">acutPrintf</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">[ERROR] %s"</span><span class="p">),</span><span class="w"> </span><span class="n">errorMsg</span><span class="p">);</span>
</span><span id="__span-29-383"><a id="__codelineno-29-383" name="__codelineno-29-383"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-29-384"><a id="__codelineno-29-384" name="__codelineno-29-384"></a><span class="w">    </span><span class="k">catch</span><span class="w"> </span><span class="p">(...)</span>
</span><span id="__span-29-385"><a id="__codelineno-29-385" name="__codelineno-29-385"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-29-386"><a id="__codelineno-29-386" name="__codelineno-29-386"></a><span class="w">        </span><span class="n">acutPrintf</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">[ERROR] 日志文件写入时发生未知异常"</span><span class="p">));</span>
</span><span id="__span-29-387"><a id="__codelineno-29-387" name="__codelineno-29-387"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-29-388"><a id="__codelineno-29-388" name="__codelineno-29-388"></a><span class="p">}</span>
</span><span id="__span-29-389"><a id="__codelineno-29-389" name="__codelineno-29-389"></a>
</span><span id="__span-29-390"><a id="__codelineno-29-390" name="__codelineno-29-390"></a><span class="kt">bool</span><span class="w"> </span><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">OpenLogFile</span><span class="p">()</span>
</span><span id="__span-29-391"><a id="__codelineno-29-391" name="__codelineno-29-391"></a><span class="p">{</span>
</span><span id="__span-29-392"><a id="__codelineno-29-392" name="__codelineno-29-392"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_logFilePath</span><span class="p">.</span><span class="n">IsEmpty</span><span class="p">())</span>
</span><span id="__span-29-393"><a id="__codelineno-29-393" name="__codelineno-29-393"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-29-394"><a id="__codelineno-29-394" name="__codelineno-29-394"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
</span><span id="__span-29-395"><a id="__codelineno-29-395" name="__codelineno-29-395"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-29-396"><a id="__codelineno-29-396" name="__codelineno-29-396"></a>
</span><span id="__span-29-397"><a id="__codelineno-29-397" name="__codelineno-29-397"></a><span class="w">    </span><span class="k">try</span>
</span><span id="__span-29-398"><a id="__codelineno-29-398" name="__codelineno-29-398"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-29-399"><a id="__codelineno-29-399" name="__codelineno-29-399"></a><span class="w">        </span><span class="c1">// 确保目录存在</span>
</span><span id="__span-29-400"><a id="__codelineno-29-400" name="__codelineno-29-400"></a><span class="w">        </span><span class="n">CString</span><span class="w"> </span><span class="n">dirPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_logFilePath</span><span class="p">;</span>
</span><span id="__span-29-401"><a id="__codelineno-29-401" name="__codelineno-29-401"></a><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">lastSlash</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dirPath</span><span class="p">.</span><span class="n">ReverseFind</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="sc">'\\'</span><span class="p">));</span>
</span><span id="__span-29-402"><a id="__codelineno-29-402" name="__codelineno-29-402"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">lastSlash</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">-1</span><span class="p">)</span>
</span><span id="__span-29-403"><a id="__codelineno-29-403" name="__codelineno-29-403"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-29-404"><a id="__codelineno-29-404" name="__codelineno-29-404"></a><span class="w">            </span><span class="n">dirPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dirPath</span><span class="p">.</span><span class="n">Left</span><span class="p">(</span><span class="n">lastSlash</span><span class="p">);</span>
</span><span id="__span-29-405"><a id="__codelineno-29-405" name="__codelineno-29-405"></a><span class="w">            </span><span class="c1">// 创建目录（递归）</span>
</span><span id="__span-29-406"><a id="__codelineno-29-406" name="__codelineno-29-406"></a><span class="w">            </span><span class="n">SHCreateDirectoryEx</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">dirPath</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
</span><span id="__span-29-407"><a id="__codelineno-29-407" name="__codelineno-29-407"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-29-408"><a id="__codelineno-29-408" name="__codelineno-29-408"></a>
</span><span id="__span-29-409"><a id="__codelineno-29-409" name="__codelineno-29-409"></a><span class="w">        </span><span class="c1">// 以追加模式打开文件，支持 Unicode</span>
</span><span id="__span-29-410"><a id="__codelineno-29-410" name="__codelineno-29-410"></a><span class="w">        </span><span class="n">m_logFile</span><span class="p">.</span><span class="n">open</span><span class="p">(</span><span class="n">m_logFilePath</span><span class="p">.</span><span class="n">GetString</span><span class="p">(),</span><span class="w"> </span>
</span><span id="__span-29-411"><a id="__codelineno-29-411" name="__codelineno-29-411"></a><span class="w">            </span><span class="n">std</span><span class="o">::</span><span class="n">ios</span><span class="o">::</span><span class="n">out</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">ios</span><span class="o">::</span><span class="n">app</span><span class="p">);</span>
</span><span id="__span-29-412"><a id="__codelineno-29-412" name="__codelineno-29-412"></a>
</span><span id="__span-29-413"><a id="__codelineno-29-413" name="__codelineno-29-413"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">m_logFile</span><span class="p">.</span><span class="n">is_open</span><span class="p">())</span>
</span><span id="__span-29-414"><a id="__codelineno-29-414" name="__codelineno-29-414"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-29-415"><a id="__codelineno-29-415" name="__codelineno-29-415"></a><span class="w">            </span><span class="n">CString</span><span class="w"> </span><span class="n">errorMsg</span><span class="p">;</span>
</span><span id="__span-29-416"><a id="__codelineno-29-416" name="__codelineno-29-416"></a><span class="w">            </span><span class="n">errorMsg</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"无法打开日志文件: %s"</span><span class="p">),</span><span class="w"> </span><span class="n">m_logFilePath</span><span class="p">);</span>
</span><span id="__span-29-417"><a id="__codelineno-29-417" name="__codelineno-29-417"></a><span class="w">            </span><span class="n">acutPrintf</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">[ERROR] %s"</span><span class="p">),</span><span class="w"> </span><span class="n">errorMsg</span><span class="p">);</span>
</span><span id="__span-29-418"><a id="__codelineno-29-418" name="__codelineno-29-418"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
</span><span id="__span-29-419"><a id="__codelineno-29-419" name="__codelineno-29-419"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-29-420"><a id="__codelineno-29-420" name="__codelineno-29-420"></a>
</span><span id="__span-29-421"><a id="__codelineno-29-421" name="__codelineno-29-421"></a><span class="w">        </span><span class="c1">// 设置为 UTF-8 编码（可选，根据需求调整）</span>
</span><span id="__span-29-422"><a id="__codelineno-29-422" name="__codelineno-29-422"></a><span class="w">        </span><span class="n">m_logFile</span><span class="p">.</span><span class="n">imbue</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">locale</span><span class="p">(</span><span class="s">""</span><span class="p">));</span>
</span><span id="__span-29-423"><a id="__codelineno-29-423" name="__codelineno-29-423"></a>
</span><span id="__span-29-424"><a id="__codelineno-29-424" name="__codelineno-29-424"></a><span class="w">        </span><span class="n">m_fileOpened</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
</span><span id="__span-29-425"><a id="__codelineno-29-425" name="__codelineno-29-425"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
</span><span id="__span-29-426"><a id="__codelineno-29-426" name="__codelineno-29-426"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-29-427"><a id="__codelineno-29-427" name="__codelineno-29-427"></a><span class="w">    </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">exception</span><span class="o">&amp;</span><span class="w"> </span><span class="n">e</span><span class="p">)</span>
</span><span id="__span-29-428"><a id="__codelineno-29-428" name="__codelineno-29-428"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-29-429"><a id="__codelineno-29-429" name="__codelineno-29-429"></a><span class="w">        </span><span class="n">CString</span><span class="w"> </span><span class="n">errorMsg</span><span class="p">;</span>
</span><span id="__span-29-430"><a id="__codelineno-29-430" name="__codelineno-29-430"></a><span class="w">        </span><span class="n">errorMsg</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"打开日志文件异常: %s"</span><span class="p">),</span><span class="w"> </span><span class="n">CString</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">what</span><span class="p">()));</span>
</span><span id="__span-29-431"><a id="__codelineno-29-431" name="__codelineno-29-431"></a><span class="w">        </span><span class="n">acutPrintf</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">[ERROR] %s"</span><span class="p">),</span><span class="w"> </span><span class="n">errorMsg</span><span class="p">);</span>
</span><span id="__span-29-432"><a id="__codelineno-29-432" name="__codelineno-29-432"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
</span><span id="__span-29-433"><a id="__codelineno-29-433" name="__codelineno-29-433"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-29-434"><a id="__codelineno-29-434" name="__codelineno-29-434"></a><span class="w">    </span><span class="k">catch</span><span class="w"> </span><span class="p">(...)</span>
</span><span id="__span-29-435"><a id="__codelineno-29-435" name="__codelineno-29-435"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-29-436"><a id="__codelineno-29-436" name="__codelineno-29-436"></a><span class="w">        </span><span class="n">acutPrintf</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">[ERROR] 打开日志文件时发生未知异常"</span><span class="p">));</span>
</span><span id="__span-29-437"><a id="__codelineno-29-437" name="__codelineno-29-437"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
</span><span id="__span-29-438"><a id="__codelineno-29-438" name="__codelineno-29-438"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-29-439"><a id="__codelineno-29-439" name="__codelineno-29-439"></a><span class="p">}</span>
</span><span id="__span-29-440"><a id="__codelineno-29-440" name="__codelineno-29-440"></a>
</span><span id="__span-29-441"><a id="__codelineno-29-441" name="__codelineno-29-441"></a><span class="kt">void</span><span class="w"> </span><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">CloseLogFile</span><span class="p">()</span>
</span><span id="__span-29-442"><a id="__codelineno-29-442" name="__codelineno-29-442"></a><span class="p">{</span>
</span><span id="__span-29-443"><a id="__codelineno-29-443" name="__codelineno-29-443"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_fileOpened</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">m_logFile</span><span class="p">.</span><span class="n">is_open</span><span class="p">())</span>
</span><span id="__span-29-444"><a id="__codelineno-29-444" name="__codelineno-29-444"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-29-445"><a id="__codelineno-29-445" name="__codelineno-29-445"></a><span class="w">        </span><span class="k">try</span>
</span><span id="__span-29-446"><a id="__codelineno-29-446" name="__codelineno-29-446"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-29-447"><a id="__codelineno-29-447" name="__codelineno-29-447"></a><span class="w">            </span><span class="n">m_logFile</span><span class="p">.</span><span class="n">flush</span><span class="p">();</span>
</span><span id="__span-29-448"><a id="__codelineno-29-448" name="__codelineno-29-448"></a><span class="w">            </span><span class="n">m_logFile</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>
</span><span id="__span-29-449"><a id="__codelineno-29-449" name="__codelineno-29-449"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-29-450"><a id="__codelineno-29-450" name="__codelineno-29-450"></a><span class="w">        </span><span class="k">catch</span><span class="w"> </span><span class="p">(...)</span>
</span><span id="__span-29-451"><a id="__codelineno-29-451" name="__codelineno-29-451"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-29-452"><a id="__codelineno-29-452" name="__codelineno-29-452"></a><span class="w">            </span><span class="c1">// 忽略关闭异常</span>
</span><span id="__span-29-453"><a id="__codelineno-29-453" name="__codelineno-29-453"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-29-454"><a id="__codelineno-29-454" name="__codelineno-29-454"></a><span class="w">        </span><span class="n">m_fileOpened</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
</span><span id="__span-29-455"><a id="__codelineno-29-455" name="__codelineno-29-455"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-29-456"><a id="__codelineno-29-456" name="__codelineno-29-456"></a><span class="p">}</span>
</span><span id="__span-29-457"><a id="__codelineno-29-457" name="__codelineno-29-457"></a>
</span><span id="__span-29-458"><a id="__codelineno-29-458" name="__codelineno-29-458"></a><span class="kt">bool</span><span class="w"> </span><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">CheckAndRotateFile</span><span class="p">()</span>
</span><span id="__span-29-459"><a id="__codelineno-29-459" name="__codelineno-29-459"></a><span class="p">{</span>
</span><span id="__span-29-460"><a id="__codelineno-29-460" name="__codelineno-29-460"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">m_fileOpened</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">m_logFilePath</span><span class="p">.</span><span class="n">IsEmpty</span><span class="p">()</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">m_maxFileSize</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-29-461"><a id="__codelineno-29-461" name="__codelineno-29-461"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-29-462"><a id="__codelineno-29-462" name="__codelineno-29-462"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
</span><span id="__span-29-463"><a id="__codelineno-29-463" name="__codelineno-29-463"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-29-464"><a id="__codelineno-29-464" name="__codelineno-29-464"></a>
</span><span id="__span-29-465"><a id="__codelineno-29-465" name="__codelineno-29-465"></a><span class="w">    </span><span class="k">try</span>
</span><span id="__span-29-466"><a id="__codelineno-29-466" name="__codelineno-29-466"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-29-467"><a id="__codelineno-29-467" name="__codelineno-29-467"></a><span class="w">        </span><span class="c1">// 获取当前文件大小</span>
</span><span id="__span-29-468"><a id="__codelineno-29-468" name="__codelineno-29-468"></a><span class="w">        </span><span class="n">m_logFile</span><span class="p">.</span><span class="n">flush</span><span class="p">();</span>
</span><span id="__span-29-469"><a id="__codelineno-29-469" name="__codelineno-29-469"></a><span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">streampos</span><span class="w"> </span><span class="n">currentPos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_logFile</span><span class="p">.</span><span class="n">tellp</span><span class="p">();</span>
</span><span id="__span-29-470"><a id="__codelineno-29-470" name="__codelineno-29-470"></a>
</span><span id="__span-29-471"><a id="__codelineno-29-471" name="__codelineno-29-471"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">currentPos</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="k">static_cast</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">streampos</span><span class="o">&gt;</span><span class="p">(</span><span class="n">m_maxFileSize</span><span class="p">))</span>
</span><span id="__span-29-472"><a id="__codelineno-29-472" name="__codelineno-29-472"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-29-473"><a id="__codelineno-29-473" name="__codelineno-29-473"></a><span class="w">            </span><span class="c1">// 需要轮转</span>
</span><span id="__span-29-474"><a id="__codelineno-29-474" name="__codelineno-29-474"></a><span class="w">            </span><span class="n">CloseLogFile</span><span class="p">();</span>
</span><span id="__span-29-475"><a id="__codelineno-29-475" name="__codelineno-29-475"></a><span class="w">            </span><span class="n">RotateBackupFiles</span><span class="p">();</span>
</span><span id="__span-29-476"><a id="__codelineno-29-476" name="__codelineno-29-476"></a><span class="w">            </span><span class="n">OpenLogFile</span><span class="p">();</span>
</span><span id="__span-29-477"><a id="__codelineno-29-477" name="__codelineno-29-477"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
</span><span id="__span-29-478"><a id="__codelineno-29-478" name="__codelineno-29-478"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-29-479"><a id="__codelineno-29-479" name="__codelineno-29-479"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-29-480"><a id="__codelineno-29-480" name="__codelineno-29-480"></a><span class="w">    </span><span class="k">catch</span><span class="w"> </span><span class="p">(...)</span>
</span><span id="__span-29-481"><a id="__codelineno-29-481" name="__codelineno-29-481"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-29-482"><a id="__codelineno-29-482" name="__codelineno-29-482"></a><span class="w">        </span><span class="c1">// 忽略检查异常</span>
</span><span id="__span-29-483"><a id="__codelineno-29-483" name="__codelineno-29-483"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-29-484"><a id="__codelineno-29-484" name="__codelineno-29-484"></a>
</span><span id="__span-29-485"><a id="__codelineno-29-485" name="__codelineno-29-485"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
</span><span id="__span-29-486"><a id="__codelineno-29-486" name="__codelineno-29-486"></a><span class="p">}</span>
</span><span id="__span-29-487"><a id="__codelineno-29-487" name="__codelineno-29-487"></a>
</span><span id="__span-29-488"><a id="__codelineno-29-488" name="__codelineno-29-488"></a><span class="kt">void</span><span class="w"> </span><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">RotateBackupFiles</span><span class="p">()</span>
</span><span id="__span-29-489"><a id="__codelineno-29-489" name="__codelineno-29-489"></a><span class="p">{</span>
</span><span id="__span-29-490"><a id="__codelineno-29-490" name="__codelineno-29-490"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_logFilePath</span><span class="p">.</span><span class="n">IsEmpty</span><span class="p">())</span>
</span><span id="__span-29-491"><a id="__codelineno-29-491" name="__codelineno-29-491"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-29-492"><a id="__codelineno-29-492" name="__codelineno-29-492"></a><span class="w">        </span><span class="k">return</span><span class="p">;</span>
</span><span id="__span-29-493"><a id="__codelineno-29-493" name="__codelineno-29-493"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-29-494"><a id="__codelineno-29-494" name="__codelineno-29-494"></a>
</span><span id="__span-29-495"><a id="__codelineno-29-495" name="__codelineno-29-495"></a><span class="w">    </span><span class="k">try</span>
</span><span id="__span-29-496"><a id="__codelineno-29-496" name="__codelineno-29-496"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-29-497"><a id="__codelineno-29-497" name="__codelineno-29-497"></a><span class="w">        </span><span class="c1">// 删除最旧的备份文件</span>
</span><span id="__span-29-498"><a id="__codelineno-29-498" name="__codelineno-29-498"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_maxBackupFiles</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-29-499"><a id="__codelineno-29-499" name="__codelineno-29-499"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-29-500"><a id="__codelineno-29-500" name="__codelineno-29-500"></a><span class="w">            </span><span class="n">CString</span><span class="w"> </span><span class="n">oldestBackup</span><span class="p">;</span>
</span><span id="__span-29-501"><a id="__codelineno-29-501" name="__codelineno-29-501"></a><span class="w">            </span><span class="n">oldestBackup</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"%s.%d"</span><span class="p">),</span><span class="w"> </span><span class="n">m_logFilePath</span><span class="p">,</span><span class="w"> </span><span class="n">m_maxBackupFiles</span><span class="p">);</span>
</span><span id="__span-29-502"><a id="__codelineno-29-502" name="__codelineno-29-502"></a><span class="w">            </span><span class="n">DeleteFile</span><span class="p">(</span><span class="n">oldestBackup</span><span class="p">);</span>
</span><span id="__span-29-503"><a id="__codelineno-29-503" name="__codelineno-29-503"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-29-504"><a id="__codelineno-29-504" name="__codelineno-29-504"></a>
</span><span id="__span-29-505"><a id="__codelineno-29-505" name="__codelineno-29-505"></a><span class="w">        </span><span class="c1">// 轮转备份文件</span>
</span><span id="__span-29-506"><a id="__codelineno-29-506" name="__codelineno-29-506"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m_maxBackupFiles</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">--</span><span class="p">)</span>
</span><span id="__span-29-507"><a id="__codelineno-29-507" name="__codelineno-29-507"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-29-508"><a id="__codelineno-29-508" name="__codelineno-29-508"></a><span class="w">            </span><span class="n">CString</span><span class="w"> </span><span class="n">oldFile</span><span class="p">,</span><span class="w"> </span><span class="n">newFile</span><span class="p">;</span>
</span><span id="__span-29-509"><a id="__codelineno-29-509" name="__codelineno-29-509"></a><span class="w">            </span><span class="n">oldFile</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"%s.%d"</span><span class="p">),</span><span class="w"> </span><span class="n">m_logFilePath</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span>
</span><span id="__span-29-510"><a id="__codelineno-29-510" name="__codelineno-29-510"></a><span class="w">            </span><span class="n">newFile</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"%s.%d"</span><span class="p">),</span><span class="w"> </span><span class="n">m_logFilePath</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-29-511"><a id="__codelineno-29-511" name="__codelineno-29-511"></a>
</span><span id="__span-29-512"><a id="__codelineno-29-512" name="__codelineno-29-512"></a><span class="w">            </span><span class="c1">// 重命名文件</span>
</span><span id="__span-29-513"><a id="__codelineno-29-513" name="__codelineno-29-513"></a><span class="w">            </span><span class="n">MoveFileEx</span><span class="p">(</span><span class="n">oldFile</span><span class="p">,</span><span class="w"> </span><span class="n">newFile</span><span class="p">,</span><span class="w"> </span><span class="n">MOVEFILE_REPLACE_EXISTING</span><span class="p">);</span>
</span><span id="__span-29-514"><a id="__codelineno-29-514" name="__codelineno-29-514"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-29-515"><a id="__codelineno-29-515" name="__codelineno-29-515"></a>
</span><span id="__span-29-516"><a id="__codelineno-29-516" name="__codelineno-29-516"></a><span class="w">        </span><span class="c1">// 将当前日志文件重命名为 .1</span>
</span><span id="__span-29-517"><a id="__codelineno-29-517" name="__codelineno-29-517"></a><span class="w">        </span><span class="n">CString</span><span class="w"> </span><span class="n">backupFile</span><span class="p">;</span>
</span><span id="__span-29-518"><a id="__codelineno-29-518" name="__codelineno-29-518"></a><span class="w">        </span><span class="n">backupFile</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"%s.1"</span><span class="p">),</span><span class="w"> </span><span class="n">m_logFilePath</span><span class="p">);</span>
</span><span id="__span-29-519"><a id="__codelineno-29-519" name="__codelineno-29-519"></a><span class="w">        </span><span class="n">MoveFileEx</span><span class="p">(</span><span class="n">m_logFilePath</span><span class="p">,</span><span class="w"> </span><span class="n">backupFile</span><span class="p">,</span><span class="w"> </span><span class="n">MOVEFILE_REPLACE_EXISTING</span><span class="p">);</span>
</span><span id="__span-29-520"><a id="__codelineno-29-520" name="__codelineno-29-520"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-29-521"><a id="__codelineno-29-521" name="__codelineno-29-521"></a><span class="w">    </span><span class="k">catch</span><span class="w"> </span><span class="p">(...)</span>
</span><span id="__span-29-522"><a id="__codelineno-29-522" name="__codelineno-29-522"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-29-523"><a id="__codelineno-29-523" name="__codelineno-29-523"></a><span class="w">        </span><span class="c1">// 轮转失败，忽略错误</span>
</span><span id="__span-29-524"><a id="__codelineno-29-524" name="__codelineno-29-524"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-29-525"><a id="__codelineno-29-525" name="__codelineno-29-525"></a><span class="p">}</span>
</span><span id="__span-29-526"><a id="__codelineno-29-526" name="__codelineno-29-526"></a>
</span><span id="__span-29-527"><a id="__codelineno-29-527" name="__codelineno-29-527"></a><span class="n">CString</span><span class="w"> </span><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">FormatMessage</span><span class="p">(</span><span class="n">LogLevel</span><span class="w"> </span><span class="n">level</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">CString</span><span class="o">&amp;</span><span class="w"> </span><span class="n">message</span><span class="p">)</span>
</span><span id="__span-29-528"><a id="__codelineno-29-528" name="__codelineno-29-528"></a><span class="p">{</span>
</span><span id="__span-29-529"><a id="__codelineno-29-529" name="__codelineno-29-529"></a><span class="w">    </span><span class="n">CString</span><span class="w"> </span><span class="n">formattedMsg</span><span class="p">;</span>
</span><span id="__span-29-530"><a id="__codelineno-29-530" name="__codelineno-29-530"></a>
</span><span id="__span-29-531"><a id="__codelineno-29-531" name="__codelineno-29-531"></a><span class="w">    </span><span class="c1">// 构建日志格式：[时间戳] [线程ID] [级别] 消息</span>
</span><span id="__span-29-532"><a id="__codelineno-29-532" name="__codelineno-29-532"></a><span class="w">    </span><span class="n">CString</span><span class="w"> </span><span class="n">parts</span><span class="p">;</span>
</span><span id="__span-29-533"><a id="__codelineno-29-533" name="__codelineno-29-533"></a>
</span><span id="__span-29-534"><a id="__codelineno-29-534" name="__codelineno-29-534"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_enableTimestamp</span><span class="p">)</span>
</span><span id="__span-29-535"><a id="__codelineno-29-535" name="__codelineno-29-535"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-29-536"><a id="__codelineno-29-536" name="__codelineno-29-536"></a><span class="w">        </span><span class="n">parts</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">_T</span><span class="p">(</span><span class="s">"["</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">GetTimestamp</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">_T</span><span class="p">(</span><span class="s">"]"</span><span class="p">);</span>
</span><span id="__span-29-537"><a id="__codelineno-29-537" name="__codelineno-29-537"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-29-538"><a id="__codelineno-29-538" name="__codelineno-29-538"></a>
</span><span id="__span-29-539"><a id="__codelineno-29-539" name="__codelineno-29-539"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m_enableThreadId</span><span class="p">)</span>
</span><span id="__span-29-540"><a id="__codelineno-29-540" name="__codelineno-29-540"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-29-541"><a id="__codelineno-29-541" name="__codelineno-29-541"></a><span class="w">        </span><span class="n">parts</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">_T</span><span class="p">(</span><span class="s">"["</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">GetThreadId</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">_T</span><span class="p">(</span><span class="s">"]"</span><span class="p">);</span>
</span><span id="__span-29-542"><a id="__codelineno-29-542" name="__codelineno-29-542"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-29-543"><a id="__codelineno-29-543" name="__codelineno-29-543"></a>
</span><span id="__span-29-544"><a id="__codelineno-29-544" name="__codelineno-29-544"></a><span class="w">    </span><span class="n">parts</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">_T</span><span class="p">(</span><span class="s">"["</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">GetLevelString</span><span class="p">(</span><span class="n">level</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">_T</span><span class="p">(</span><span class="s">"]"</span><span class="p">);</span>
</span><span id="__span-29-545"><a id="__codelineno-29-545" name="__codelineno-29-545"></a>
</span><span id="__span-29-546"><a id="__codelineno-29-546" name="__codelineno-29-546"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">parts</span><span class="p">.</span><span class="n">IsEmpty</span><span class="p">())</span>
</span><span id="__span-29-547"><a id="__codelineno-29-547" name="__codelineno-29-547"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-29-548"><a id="__codelineno-29-548" name="__codelineno-29-548"></a><span class="w">        </span><span class="n">formattedMsg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parts</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">_T</span><span class="p">(</span><span class="s">" "</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">message</span><span class="p">;</span>
</span><span id="__span-29-549"><a id="__codelineno-29-549" name="__codelineno-29-549"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-29-550"><a id="__codelineno-29-550" name="__codelineno-29-550"></a><span class="w">    </span><span class="k">else</span>
</span><span id="__span-29-551"><a id="__codelineno-29-551" name="__codelineno-29-551"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-29-552"><a id="__codelineno-29-552" name="__codelineno-29-552"></a><span class="w">        </span><span class="n">formattedMsg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">message</span><span class="p">;</span>
</span><span id="__span-29-553"><a id="__codelineno-29-553" name="__codelineno-29-553"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-29-554"><a id="__codelineno-29-554" name="__codelineno-29-554"></a>
</span><span id="__span-29-555"><a id="__codelineno-29-555" name="__codelineno-29-555"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">formattedMsg</span><span class="p">;</span>
</span><span id="__span-29-556"><a id="__codelineno-29-556" name="__codelineno-29-556"></a><span class="p">}</span>
</span><span id="__span-29-557"><a id="__codelineno-29-557" name="__codelineno-29-557"></a>
</span><span id="__span-29-558"><a id="__codelineno-29-558" name="__codelineno-29-558"></a><span class="n">CString</span><span class="w"> </span><span class="n">CMineSymbolLogger</span><span class="o">::</span><span class="n">GetThreadId</span><span class="p">()</span>
</span><span id="__span-29-559"><a id="__codelineno-29-559" name="__codelineno-29-559"></a><span class="p">{</span>
</span><span id="__span-29-560"><a id="__codelineno-29-560" name="__codelineno-29-560"></a><span class="w">    </span><span class="n">DWORD</span><span class="w"> </span><span class="n">threadId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetCurrentThreadId</span><span class="p">();</span>
</span><span id="__span-29-561"><a id="__codelineno-29-561" name="__codelineno-29-561"></a><span class="w">    </span><span class="n">CString</span><span class="w"> </span><span class="n">tidStr</span><span class="p">;</span>
</span><span id="__span-29-562"><a id="__codelineno-29-562" name="__codelineno-29-562"></a><span class="w">    </span><span class="n">tidStr</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="n">_T</span><span class="p">(</span><span class="s">"TID:%04X"</span><span class="p">),</span><span class="w"> </span><span class="n">threadId</span><span class="p">);</span>
</span><span id="__span-29-563"><a id="__codelineno-29-563" name="__codelineno-29-563"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">tidStr</span><span class="p">;</span>
</span><span id="__span-29-564"><a id="__codelineno-29-564" name="__codelineno-29-564"></a><span class="p">}</span>
</span></code></pre></div></td></tr></tbody></table></div> <hr> <p><strong>CMineSymbolLogger - 让日志记录变得简单而强大！</strong> </p> <p><em>最后更新: 2025-10-28 | 版本: v2.0.1</em></p> <form class="md-feedback" name="feedback" hidden> <fieldset> <legend class="md-feedback__title"> 这个页面对您有帮助吗？ </legend> <div class="md-feedback__inner"> <div class="md-feedback__list"> <button class="md-feedback__icon md-icon" type="submit" title="有帮助" data-md-value="1"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81"></path></svg> </button> <button class="md-feedback__icon md-icon" type="submit" title="可以改进" data-md-value="0"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14"></path></svg> </button> </div> <div class="md-feedback__note"> <div data-md-value="1" hidden> 感谢您的反馈！ </div> <div data-md-value="0" hidden> 感谢您的反馈！请帮助我们改进这个页面， <a href="https://github.com/mazaiguo/mazaiguo.github.io/issues/new/?title=[Feedback]+CMineSymbolLogger%20%E6%97%A5%E5%BF%97%E7%B3%BB%E7%BB%9F%E5%AE%8C%E6%95%B4%E6%96%87%E6%A1%A3+-+/blog/2025/10/29/cminesymbollogger-%E6%97%A5%E5%BF%97%E7%B3%BB%E7%BB%9F%E5%AE%8C%E6%95%B4%E6%96%87%E6%A1%A3.html" target="_blank" rel="noopener">告诉我们需要改进的地方</a>。 </div> </div> </div> </fieldset> </form> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type="button" class="md-top md-icon" data-md-component="top" hidden> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg> 回到页面顶部 </button> </main> <footer class="md-footer"> <nav class="md-footer__inner md-grid" aria-label="页脚"> <a href="../28/typora%E4%BB%A3%E7%A0%81%E5%9D%97mac%E9%A3%8E%E6%A0%BC%E5%8C%96.html" class="md-footer__link md-footer__link--prev" aria-label="上一页: Typora代码块Mac风格化"> <div class="md-footer__button md-icon"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> </div> <div class="md-footer__title"> <span class="md-footer__direction"> 上一页 </span> <div class="md-ellipsis"> Typora代码块Mac风格化 </div> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class="md-copyright"> <div class="md-copyright__highlight"> Copyright © 2016 - present JerryMa </div> </div> <div class="md-social"> <a href="https://github.com/mazaiguo" target="_blank" rel="noopener" title="JerryMa on Github" class="md-social__link"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg> </a> <a href="https://gitlab.zwsoft.cn/mazaiguo" target="_blank" rel="noopener" title="gitlab.zwsoft.cn" class="md-social__link"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="m504 204.6-.7-1.8L433.6 21c-1.4-3.6-3.9-6.6-7.2-8.6-2.4-1.6-5.1-2.5-8-2.8s-5.7.1-8.4 1.1-5.1 2.7-7.1 4.8c-1.9 2.1-3.3 4.7-4.1 7.4l-47 144H161.3l-47.1-144c-.8-2.8-2.2-5.3-4.1-7.4-2-2.1-4.4-3.7-7.1-4.8-2.6-1-5.5-1.4-8.4-1.1s-5.6 1.2-8 2.8c-3.2 2-5.8 5.1-7.2 8.6L9.8 202.8l-.8 1.8c-10 26.2-11.3 55-3.5 82 7.7 26.9 24 50.7 46.4 67.6l.3.2.6.4 106 79.5c38.5 29.1 66.7 50.3 84.6 63.9 3.7 1.9 8.3 4.3 13 4.3s9.3-2.4 13-4.3c17.9-13.5 46.1-34.9 84.6-63.9l106.7-79.9.3-.3c22.4-16.9 38.7-40.6 45.6-67.5 8.6-27 7.4-55.8-2.6-82"></path></svg> </a> <a href="mailto:mazaiguo@126.com" target="_blank" rel="noopener" title="Email" class="md-social__link"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M61.4 64C27.5 64 0 91.5 0 125.4c0 .9 0 1.7.1 2.6H0v256c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64V128h-.1c0-.9.1-1.7.1-2.6 0-33.9-27.5-61.4-61.4-61.4zM464 192.3V384c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192.3l154.8 117.4c31.4 23.9 74.9 23.9 106.4 0zM48 125.4c0-7.4 6-13.4 13.4-13.4h389.2c7.4 0 13.4 6 13.4 13.4 0 4.2-2 8.2-5.3 10.7L280.2 271.5c-14.3 10.8-34.1 10.8-48.4 0L53.3 136.1c-3.3-2.5-5.3-6.5-5.3-10.7"></path></svg> </a> </div> </div> </div> </footer> </div> <div class="md-dialog" data-md-component="dialog"> <div class="md-dialog__inner md-typeset"></div> </div> <div class="md-progress" data-md-component="progress" role="progressbar"></div> <script id="__config" type="application/json">{"base": "../../../..", "features": ["announce.dismiss", "content.tabs.link", "content.tooltips", "content.code.copy", "content.code.select", "content.code.annotate", "content.footnote.tooltips", "header.autohide", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.prune", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "toc.integrate"], "search": "../../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": {".NET": "dotnet", "AutoCAD": "autocad", "C#": "csharp", "C++": "cpp", "CSS": "css", "HTML5": "html", "JavaScript": "js", "Python": "python"}, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script> <script src="../../../../assets/javascripts/bundle.f55a23d4.min.js"></script> <script src="../../../../javascripts/katex.js"></script> <script src="../../../../javascripts/apple-code-style.js"></script> <script src="https://unpkg.com/katex@0/dist/katex.min.js"></script> <script src="https://unpkg.com/katex@0/dist/contrib/auto-render.min.js"></script>  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>